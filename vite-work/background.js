const ri={histories:100,tabs:325,leafs:200,folders:150},Pn={postPage:!1,height:500,windowSize:{width:800,height:500,top:void 0,left:void 0},paneWidth:{pane1:ri.leafs,pane2:ri.tabs,pane3:ri.histories},paneLayouts:[],paneLayoutsWindowMode:[],bodyColor:"#222222",tabs:!0,history:!0,historyMax:{rows:30,days:null},includeUrl:!1,theme:{light:"",dark:"",other:""},palettes:{light:[],dark:[],other:[]}},Dn=["FEFFFE","BFD7EA","0B3954","E0FF4F","FF6663"],In=["histories","tabs","bookmarks"],kn={panes:In,bookmarksPanes:["leafs","folders"],newTabPosition:"rs",showCloseTab:!0,showSwitchTabsWin:!1,showDeleteHistory:!0,findTabsFirst:!0,enableExternalUrl:!1,externalUrl:"",findTabsMatches:"domain",css:"",editorTheme:"vs-dark",colorPalette:Dn,zoomTabs:!1,zoomHistory:!0,zoomRatio:"0.7",fontSize:"0.9em",collapseTabs:!0,exclusiveOpenBmFolderTree:!0,bmAutoFindTabs:!0,bmAutoFindTabsDelay:"500",restoreSearching:!0,favColorPalettes:[],showMinimizeAll:!0,windowMode:!1},rt={initialize:"cl-initialize",moveWindow:"cl-move-window",moveWindowNew:"cl-move-window-new",moveTabs:"cl-move-tabs",moveTabsNewWindow:"cl-move-tabs-new-window",openUrls:"cl-open-urls",setThemeColor:"cl-set-theme-color",getWindowModeInfo:"cl-get-window-mode-info",restoreSession:"cl-restore-session",updateWindow:"cl-update-window",getSvgBrowserFavicon:"cl-get-svg-favicon"},Pr={applyOptions:"bkg-apply-options",applyStyle:"bkg-apply-style",tryChangePalette:"bkg-try-change-palette",terminateWindowMode:"bkg-terminate-window-mode"};function Ee(r,t){const[e,i,n]=ke(r.color),[s,a,o]=ke(t.color);return Math.abs(s-e)+Math.abs(a-i)+Math.abs(o-n)}function ct([r,t,e,i,n]){return[r,t,e,n,i]}function bt([r,t,e,i,n]){return[r,t,i,e,n]}function Rn([r,t,e,i,n]){const s=e.chroma*(1-e.whiteness),a=i.chroma*(1-i.whiteness),o=n.chroma*(1-n.whiteness);return s<a&&o<a?[r,t,e,n,i]:a<s&&o<s?[r,t,i,n,e]:[r,t,e,i,n]}function Vn([r,t,e,i,n]){const s=e.chroma*(1-e.whiteness),a=i.chroma*(1-i.whiteness);return s<a?[r,t,i,e,n]:[r,t,e,i,n]}function _n([r,t,e,i,n]){const s=e.chroma*(3-e.whiteness),a=i.chroma*(3-i.whiteness),o=n.chroma*(3-n.whiteness);return s<a&&o<a?[r,t,e,n,i]:a<s&&o<s?[r,t,i,n,e]:[r,t,e,i,n]}function Ln([r,t,e,i,n]){const s=e.chroma*e.whiteness,a=i.chroma*i.whiteness;return s<a?[r,t,i,e,n]:[r,t,e,i,n]}function ni(r){return r.map(t=>`<div>${t.map(i=>{const n=i.whiteness>K;return`<div data-color="${i.color}" style="background-color: #${i.color}; color: ${n?"black":"white"}"></div>`}).join("")}</div>`).join("")}function Xi(r){return r.map(t=>({color:t,whiteness:Re(t),chroma:fi(t)})).map(t=>({...t,vivid:t.chroma*(t.whiteness*.1)}))}function Dr(r,t){return r.filter(([e,i,n])=>Ee(e,n)>t&&Ee(i,n)>t).filter(([e,i,,,n])=>Ee(e,n)>t&&Ee(i,n)>t).filter(([e,i],n,s)=>!s.slice(0,n).find(([a,o])=>ui({p:e,f:i},{p:a,f:o},!0)))}function Yi(r,t){const e=r.map(Rn).map(Vn).concat(r.map(bt).map(ct)).concat(r).concat(r.map(ct)).concat(r.map(ct).map(bt).map(ct)).concat(r.map(ct).map(bt)).concat(r.map(bt)).flatMap(([i,n],s,a)=>a.filter(([o,l])=>i.color===o.color&&n.color===l.color));return Dr(e,t)}function Un(r,t){const e=r.map(_n).map(Ln).concat(r.map(bt).map(ct)).concat(r).concat(r.map(ct)).concat(r.map(bt)).concat(r.map(ct).map(bt)).concat(r.map(ct).map(bt).map(ct)).flatMap(([i,n],s,a)=>a.filter(([o,l])=>i.color===o.color&&n.color===l.color));return Dr(e,t)}function zn(r){return t=>t.map(r)}const ji=Object.prototype.toString.call.bind(Object.prototype.toString),$i=Object.prototype.hasOwnProperty.call.bind(Object.prototype.hasOwnProperty);function ui(r,t,e=!1){if(Object.is(r,t))return!0;const i=ji(r);if(i!==ji(t))return!1;if(i==="[object Array]"){if(r.length!==t.length)return!1;if(e){for(let n=0;n<r.length;n+=1)if(!ui(r[n],t[n],!0))return!1}else for(let n=0;n<r.length;n+=1)if(Object.is(r[n],t[n]))return!1;return!0}if(i==="[object Object]"){const n=Object.keys(r),s=Object.keys(t);if(n.length!==s.length)return!1;if(e){for(let a=0;a<n.length;a+=1)if(!$i(t,n[a])||!ui(r[n[a]],t[n[a]],!0))return!1}else for(let a=0;a<n.length;a+=1)if(!$i(t,n[a])||!Object.is(r[n[a]],t[n[a]]))return!1;return!0}return!1}function Ir(r,...t){return(...e)=>t.reduce((i,n)=>n(i),r(...e))}async function Fn(r){return chrome.runtime.sendMessage(r).catch(console.error)}function Bn(r){return t=>t[r]}function kr(r,t){return e=>e[r]===t}function Hn(r,t){return e=>e[r]!==t}function Xn(r){return encodeURIComponent(r).replace(/[()']/g,t=>`\\${t}`)}const Yn=chrome.runtime.getURL("_favicon/?pageUrl="),jn="PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1MTIgNTEyIj48IS0tISBGb250IEF3ZXNvbWUgUHJvIDYuMi4wIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlIChDb21tZXJjaWFsIExpY2Vuc2UpIENvcHlyaWdodCAyMDIyIEZvbnRpY29ucywgSW5jLiAtLT48cGF0aCBmaWxsPSIjNDA0NDQ3IiBkPSJNMCAyNTZDMCAyMDkuNCAxMi40NyAxNjUuNiAzNC4yNyAxMjcuMUwxNDQuMSAzMTguM0MxNjYgMzU3LjUgMjA3LjkgMzg0IDI1NiAzODRDMjcwLjMgMzg0IDI4My4xIDM4MS43IDI5Ni44IDM3Ny40TDIyMC41IDUwOS42Qzk1LjkgNDkyLjMgMCAzODUuMyAwIDI1NnpNMzY1LjEgMzIxLjZDMzc3LjQgMzAyLjQgMzg0IDI3OS4xIDM4NCAyNTZDMzg0IDIxNy44IDM2Ny4yIDE4My41IDM0MC43IDE2MEg0OTMuNEM1MDUuNCAxODkuNiA1MTIgMjIyLjEgNTEyIDI1NkM1MTIgMzk3LjQgMzk3LjQgNTExLjEgMjU2IDUxMkwzNjUuMSAzMjEuNnpNNDc3LjggMTI4SDI1NkMxOTMuMSAxMjggMTQyLjMgMTcyLjEgMTMwLjUgMjMwLjdMNTQuMTkgOTguNDdDMTAxIDM4LjUzIDE3NCAwIDI1NiAwQzM1MC44IDAgNDMzLjUgNTEuNDggNDc3LjggMTI4VjEyOHpNMTY4IDI1NkMxNjggMjA3LjQgMjA3LjQgMTY4IDI1NiAxNjhDMzA0LjYgMTY4IDM0NCAyMDcuNCAzNDQgMjU2QzM0NCAzMDQuNiAzMDQuNiAzNDQgMjU2IDM0NEMyMDcuNCAzNDQgMTY4IDMwNC42IDE2OCAyNTZ6Ii8+PC9zdmc+";function hi(r){if(r==="chrome://newtab/")return`background-image: url(data:image/svg+xml;base64,${jn}); background-size: 15px;`;const t=!r||r.startsWith("data")?"none":Xn(r);return`background-image: url(${Yn}${t});`}function ie(r){return t=>t.forEach(e=>e.addListener(r))}async function xt(r){return new Promise(t=>{chrome.storage.local.set(r,()=>{chrome.runtime.lastError&&console.log(chrome.runtime.lastError.message),t(r)})})}async function $n(r,...t){return new Promise(e=>{r.get(t,i=>e(i))})}function Dt(...r){return $n(chrome.storage.local,...r)}function ke(r){return[r.substring(0,2),r.substring(2,4),r.substring(4,6)].map(t=>parseInt(t,16))}function fi(r){const[t,e,i]=ke(r),n=Math.max(t,e,i),s=Math.min(t,e,i);return(n-s)/255}const K=.6;function Re(r){const[t,e,i]=ke(r);return Math.max((t||1)*(e||1)*(i||1)/(255*255*255),e*i/(255*255),t*i/(255*255),t*e/(255*255))}const le=new Map;le.set("&","&amp;");le.set('"',"&quot;");le.set("<","&lt;");le.set(">","&gt;");function Yt(r){return r.replace(/[&"<>]/g,t=>le.get(t))}function Wn(r){return r==null?new Date().toLocaleDateString():r<1e3?"Undated":new Date(r).toLocaleDateString()}function Qn(r,t=!1){function e(i,n,s){const a=r[i==null?void 0:i.type];if(typeof a=="function"){const o=a(i),l=o instanceof Promise;return l&&o.then(c=>s(c)),t&&chrome.runtime.onMessage.removeListener(e),l}return!0}chrome.runtime.onMessage.addListener(e)}function Gn(r){return r.split("").map(t=>[t,t.toLowerCase()]).map(([t,e])=>t===e?t:`-${e}`).join("")}function qn(r){const t="#efefef",e="#222222";return r.map(i=>[`#${i}`,Re(i)]).map(([i,n])=>[i,n>K]).map(([i,n])=>[i,n?e:t,n])}function Rr(r){const[[t,e],[i,n],[s,a],[o,l],[c,u]]=qn(r);return Object.entries({paneBg:t,paneColor:e,frameBg:i,frameColor:n,itemHoverBg:s,itemHoverColor:a,searchingBg:o,searchingColor:l,keyBg:c,keyColor:u}).map(([g,f])=>`    --${Gn(g)}: ${f};`).join(`
`)}async function Vr(){const r=chrome.runtime.getURL("popup.html*"),[t]=await chrome.tabs.query({url:r});return t}function Zn(r,t,e){const i=Rr(t),n=`body { height: ${r.height}px; }`;return`:root {
${i}
}

${n}

${e}`}function _r({css:r,colorPalette:t,windowMode:e}){if(e){chrome.action.setPopup({popup:""});return}Dt("settings").then(({settings:i})=>{const n=encodeURIComponent(Zn(i,t,r));chrome.action.setPopup({popup:`popup.html?css=${n}`}),Vr().then(s=>{s&&Fn({type:Pr.terminateWindowMode})})})}async function Kn(){const t=(await fetch("./color-palette1.json").then(f=>f.json())).map(Xi).map(f=>[...f].sort((h,d)=>h.vivid-d.vivid)).map(([f,h,d,p,m])=>[f,h,d,p].sort((y,w)=>y.chroma-w.chroma).concat(m)).map(([f,h,d,p,m])=>h.whiteness<=K?d.whiteness>K?[f,d,h,p,m]:[f,p,h,d,m]:[f,h,d,p,m]),e=t.filter(([f,h])=>f.whiteness<=K&&h.whiteness>K||f.whiteness>K&&h.whiteness<=K),i=Yi(e,100),n=ni(i),s=t.filter(([f,h])=>f.whiteness<=K&&h.whiteness<=K),a=t.concat([...s,...e].map(f=>f.concat().sort((h,d)=>d.whiteness-h.whiteness))).filter(([f])=>f.whiteness>K).filter(([,f])=>f.whiteness>K),o=[...e,...a].map(f=>f.concat().sort((h,d)=>h.whiteness-d.whiteness)).filter(([f,h])=>f.whiteness<=K&&h.whiteness<=K).concat(s),l=Un(o,100),c=ni(l),u=[Xi(["FFFFFF","E8E8E9","CCE5FF","F6F6F6","1DA1F2"]),...Yi(a,80)];return{html:{light:ni(u),dark:c,other:n},palettes:{light:u,dark:l,other:i}}}function Jn(r=99999){const t=Date.now()-31536e6,e=chrome.history.search({text:"",startTime:t,maxResults:r}),i=chrome.sessions.getRecentlyClosed();return[e,i]}const ts=new Intl.DateTimeFormat([],{timeStyle:"short"});function es(r){return ts.format(r)}function is(r){try{return decodeURIComponent((r||"").substring(0,1024))}catch{return(r||"").substring(0,1024)}}function rs(){Dt("lastSearchWord","queries").then(({lastSearchWord:r,...t})=>{if(!r)return;const e=[r,...(t.queries||[]).filter(i=>i.localeCompare(r,void 0,{sensitivity:"accent"})!==0).slice(0,200)];xt({queries:e})})}function ns(r){return`<history-item class="current-date history header-date" style="transform: translateY(-10000px)"></history-item>${r}`}function ss({title:r,url:t,id:e},i=!1){const n=hi(t),s=is(t);return`
    <bm-leaf class="leaf${i?" search-path":""}" id="${e}" draggable="true" style="${n}">
      <div class="anchor" title="${Yt(r)}
${Yt(s)}">${Yt(r)}</div><button class="leaf-menu-button"><i class="icon-fa-ellipsis-v"></i></button>
      <div class="drop-top"></div><div class="drop-bottom"></div>
    </bm-leaf>
  `}function os({id:r,title:t,children:e,length:i}){return`
    <div is="bm-folder" class="folder" id="${r}" data-children="${i}">
      <div class="marker" draggable="true" title="${Yt(t)}">
        <div class="drop-folder"></div><i class="icon-fa-angle-right"></i><div class="title" tabindex="2"><div>${Yt(t)}</div></div><div class="button-wrapper"><button class="folder-menu-button"><i class="icon-fa-ellipsis-v"></i></button></div><div class="drop-top"></div><div class="drop-bottom"></div>
      </div>
      ${e}
    </div>
  `}function as({url:r,title:t,lastVisitTime:e,headerDate:i,id:n,isSession:s,sessionWindow:a,headerStyle:o=""}){if(i){const d=Wn(e);return`<history-item class="history header-date" draggable="true" style="${o}">${d}</history-item>`}const{elementId:l,addClassName:c,style:u}=s?{elementId:`session-${n}`,addClassName:a?" session-window":" session-tab",style:a?"":hi(r)}:{elementId:`hst-${n}`,addClassName:"",style:hi(r)},g=t||r,f=new Date(e),h=es(f);return`
    <history-item class="history${c}" draggable="true" id="${l}" style="${u}">
      <i class="icon-fa-angle-right"></i>
      <div class="history-title">${Yt(g)}</div><div class="time">${h}</div><i class="icon-x"></i>
    </history-item>
  `}var Lr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Pt={},ls={get exports(){return Pt},set exports(r){Pt=r}},gi={},Se={get exports(){return gi},set exports(r){gi=r}};(function(){var r,t,e,i,n,s;typeof performance<"u"&&performance!==null&&performance.now?Se.exports=function(){return performance.now()}:typeof process<"u"&&process!==null&&process.hrtime?(Se.exports=function(){return(r()-n)/1e6},t=process.hrtime,r=function(){var a;return a=t(),a[0]*1e9+a[1]},i=r(),s=process.uptime()*1e9,n=i-s):Date.now?(Se.exports=function(){return Date.now()-e},e=Date.now()):(Se.exports=function(){return new Date().getTime()-e},e=new Date().getTime())}).call(Lr);var cs=gi,ft=typeof window>"u"?Lr:window,Ae=["moz","webkit"],jt="AnimationFrame",Wt=ft["request"+jt],re=ft["cancel"+jt]||ft["cancelRequest"+jt];for(var Kt=0;!Wt&&Kt<Ae.length;Kt++)Wt=ft[Ae[Kt]+"Request"+jt],re=ft[Ae[Kt]+"Cancel"+jt]||ft[Ae[Kt]+"CancelRequest"+jt];if(!Wt||!re){var si=0,Wi=0,Mt=[],us=1e3/60;Wt=function(r){if(Mt.length===0){var t=cs(),e=Math.max(0,us-(t-si));si=e+t,setTimeout(function(){var i=Mt.slice(0);Mt.length=0;for(var n=0;n<i.length;n++)if(!i[n].cancelled)try{i[n].callback(si)}catch(s){setTimeout(function(){throw s},0)}},Math.round(e))}return Mt.push({handle:++Wi,callback:r,cancelled:!1}),Wi},re=function(r){for(var t=0;t<Mt.length;t++)Mt[t].handle===r&&(Mt[t].cancelled=!0)}}ls.exports=function(r){return Wt.call(ft,r)};Pt.cancel=function(){re.apply(ft,arguments)};Pt.polyfill=function(r){r||(r=ft),r.requestAnimationFrame=Wt,r.cancelAnimationFrame=re};var di=function(r){this.ok=!1,this.alpha=1,r.charAt(0)=="#"&&(r=r.substr(1,6)),r=r.replace(/ /g,""),r=r.toLowerCase();var t={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"};r=t[r]||r;for(var e=[{re:/^rgba\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3}),\s*((?:\d?\.)?\d)\)$/,example:["rgba(123, 234, 45, 0.8)","rgba(255,234,245,1.0)"],process:function(l){return[parseInt(l[1]),parseInt(l[2]),parseInt(l[3]),parseFloat(l[4])]}},{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(l){return[parseInt(l[1]),parseInt(l[2]),parseInt(l[3])]}},{re:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,example:["#00ff00","336699"],process:function(l){return[parseInt(l[1],16),parseInt(l[2],16),parseInt(l[3],16)]}},{re:/^([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,example:["#fb0","f0f"],process:function(l){return[parseInt(l[1]+l[1],16),parseInt(l[2]+l[2],16),parseInt(l[3]+l[3],16)]}}],i=0;i<e.length;i++){var n=e[i].re,s=e[i].process,a=n.exec(r);if(a){var o=s(a);this.r=o[0],this.g=o[1],this.b=o[2],o.length>3&&(this.alpha=o[3]),this.ok=!0}}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.alpha=this.alpha<0?0:this.alpha>1||isNaN(this.alpha)?1:this.alpha,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toRGBA=function(){return"rgba("+this.r+", "+this.g+", "+this.b+", "+this.alpha+")"},this.toHex=function(){var l=this.r.toString(16),c=this.g.toString(16),u=this.b.toString(16);return l.length==1&&(l="0"+l),c.length==1&&(c="0"+c),u.length==1&&(u="0"+u),"#"+l+c+u},this.getHelpXML=function(){for(var l=new Array,c=0;c<e.length;c++)for(var u=e[c].example,g=0;g<u.length;g++)l[l.length]=u[g];for(var f in t)l[l.length]=f;var h=document.createElement("ul");h.setAttribute("id","rgbcolor-examples");for(var c=0;c<l.length;c++)try{var d=document.createElement("li"),p=new RGBColor(l[c]),m=document.createElement("div");m.style.cssText="margin: 3px; border: 1px solid black; background:"+p.toHex()+"; color:"+p.toHex(),m.appendChild(document.createTextNode("test"));var y=document.createTextNode(" "+l[c]+" -> "+p.toRGB()+" -> "+p.toHex());d.appendChild(m),d.appendChild(y),h.appendChild(d)}catch{}return h}};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Ur=function(r,t){return(Ur=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,i){e.__proto__=i}||function(e,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])})(r,t)};function zr(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=r}Ur(r,t),r.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}function hs(r){var t="";Array.isArray(r)||(r=[r]);for(var e=0;e<r.length;e++){var i=r[e];if(i.type===v.CLOSE_PATH)t+="z";else if(i.type===v.HORIZ_LINE_TO)t+=(i.relative?"h":"H")+i.x;else if(i.type===v.VERT_LINE_TO)t+=(i.relative?"v":"V")+i.y;else if(i.type===v.MOVE_TO)t+=(i.relative?"m":"M")+i.x+" "+i.y;else if(i.type===v.LINE_TO)t+=(i.relative?"l":"L")+i.x+" "+i.y;else if(i.type===v.CURVE_TO)t+=(i.relative?"c":"C")+i.x1+" "+i.y1+" "+i.x2+" "+i.y2+" "+i.x+" "+i.y;else if(i.type===v.SMOOTH_CURVE_TO)t+=(i.relative?"s":"S")+i.x2+" "+i.y2+" "+i.x+" "+i.y;else if(i.type===v.QUAD_TO)t+=(i.relative?"q":"Q")+i.x1+" "+i.y1+" "+i.x+" "+i.y;else if(i.type===v.SMOOTH_QUAD_TO)t+=(i.relative?"t":"T")+i.x+" "+i.y;else{if(i.type!==v.ARC)throw new Error('Unexpected command type "'+i.type+'" at index '+e+".");t+=(i.relative?"a":"A")+i.rX+" "+i.rY+" "+i.xRot+" "+ +i.lArcFlag+" "+ +i.sweepFlag+" "+i.x+" "+i.y}}return t}function pi(r,t){var e=r[0],i=r[1];return[e*Math.cos(t)-i*Math.sin(t),e*Math.sin(t)+i*Math.cos(t)]}function st(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];for(var e=0;e<r.length;e++)if(typeof r[e]!="number")throw new Error("assertNumbers arguments["+e+"] is not a number. "+typeof r[e]+" == typeof "+r[e]);return!0}var vt=Math.PI;function oi(r,t,e){r.lArcFlag=r.lArcFlag===0?0:1,r.sweepFlag=r.sweepFlag===0?0:1;var i=r.rX,n=r.rY,s=r.x,a=r.y;i=Math.abs(r.rX),n=Math.abs(r.rY);var o=pi([(t-s)/2,(e-a)/2],-r.xRot/180*vt),l=o[0],c=o[1],u=Math.pow(l,2)/Math.pow(i,2)+Math.pow(c,2)/Math.pow(n,2);1<u&&(i*=Math.sqrt(u),n*=Math.sqrt(u)),r.rX=i,r.rY=n;var g=Math.pow(i,2)*Math.pow(c,2)+Math.pow(n,2)*Math.pow(l,2),f=(r.lArcFlag!==r.sweepFlag?1:-1)*Math.sqrt(Math.max(0,(Math.pow(i,2)*Math.pow(n,2)-g)/g)),h=i*c/n*f,d=-n*l/i*f,p=pi([h,d],r.xRot/180*vt);r.cX=p[0]+(t+s)/2,r.cY=p[1]+(e+a)/2,r.phi1=Math.atan2((c-d)/n,(l-h)/i),r.phi2=Math.atan2((-c-d)/n,(-l-h)/i),r.sweepFlag===0&&r.phi2>r.phi1&&(r.phi2-=2*vt),r.sweepFlag===1&&r.phi2<r.phi1&&(r.phi2+=2*vt),r.phi1*=180/vt,r.phi2*=180/vt}function Qi(r,t,e){st(r,t,e);var i=r*r+t*t-e*e;if(0>i)return[];if(i===0)return[[r*e/(r*r+t*t),t*e/(r*r+t*t)]];var n=Math.sqrt(i);return[[(r*e+t*n)/(r*r+t*t),(t*e-r*n)/(r*r+t*t)],[(r*e-t*n)/(r*r+t*t),(t*e+r*n)/(r*r+t*t)]]}var H,ut=Math.PI/180;function Gi(r,t,e){return(1-e)*r+e*t}function qi(r,t,e,i){return r+Math.cos(i/180*vt)*t+Math.sin(i/180*vt)*e}function Zi(r,t,e,i){var n=1e-6,s=t-r,a=e-t,o=3*s+3*(i-e)-6*a,l=6*(a-s),c=3*s;return Math.abs(o)<n?[-c/l]:function(u,g,f){f===void 0&&(f=1e-6);var h=u*u/4-g;if(h<-f)return[];if(h<=f)return[-u/2];var d=Math.sqrt(h);return[-u/2-d,-u/2+d]}(l/o,c/o,n)}function Ki(r,t,e,i,n){var s=1-n;return r*(s*s*s)+t*(3*s*s*n)+e*(3*s*n*n)+i*(n*n*n)}(function(r){function t(){return n(function(o,l,c){return o.relative&&(o.x1!==void 0&&(o.x1+=l),o.y1!==void 0&&(o.y1+=c),o.x2!==void 0&&(o.x2+=l),o.y2!==void 0&&(o.y2+=c),o.x!==void 0&&(o.x+=l),o.y!==void 0&&(o.y+=c),o.relative=!1),o})}function e(){var o=NaN,l=NaN,c=NaN,u=NaN;return n(function(g,f,h){return g.type&v.SMOOTH_CURVE_TO&&(g.type=v.CURVE_TO,o=isNaN(o)?f:o,l=isNaN(l)?h:l,g.x1=g.relative?f-o:2*f-o,g.y1=g.relative?h-l:2*h-l),g.type&v.CURVE_TO?(o=g.relative?f+g.x2:g.x2,l=g.relative?h+g.y2:g.y2):(o=NaN,l=NaN),g.type&v.SMOOTH_QUAD_TO&&(g.type=v.QUAD_TO,c=isNaN(c)?f:c,u=isNaN(u)?h:u,g.x1=g.relative?f-c:2*f-c,g.y1=g.relative?h-u:2*h-u),g.type&v.QUAD_TO?(c=g.relative?f+g.x1:g.x1,u=g.relative?h+g.y1:g.y1):(c=NaN,u=NaN),g})}function i(){var o=NaN,l=NaN;return n(function(c,u,g){if(c.type&v.SMOOTH_QUAD_TO&&(c.type=v.QUAD_TO,o=isNaN(o)?u:o,l=isNaN(l)?g:l,c.x1=c.relative?u-o:2*u-o,c.y1=c.relative?g-l:2*g-l),c.type&v.QUAD_TO){o=c.relative?u+c.x1:c.x1,l=c.relative?g+c.y1:c.y1;var f=c.x1,h=c.y1;c.type=v.CURVE_TO,c.x1=((c.relative?0:u)+2*f)/3,c.y1=((c.relative?0:g)+2*h)/3,c.x2=(c.x+2*f)/3,c.y2=(c.y+2*h)/3}else o=NaN,l=NaN;return c})}function n(o){var l=0,c=0,u=NaN,g=NaN;return function(f){if(isNaN(u)&&!(f.type&v.MOVE_TO))throw new Error("path must start with moveto");var h=o(f,l,c,u,g);return f.type&v.CLOSE_PATH&&(l=u,c=g),f.x!==void 0&&(l=f.relative?l+f.x:f.x),f.y!==void 0&&(c=f.relative?c+f.y:f.y),f.type&v.MOVE_TO&&(u=l,g=c),h}}function s(o,l,c,u,g,f){return st(o,l,c,u,g,f),n(function(h,d,p,m){var y=h.x1,w=h.x2,b=h.relative&&!isNaN(m),x=h.x!==void 0?h.x:b?0:d,M=h.y!==void 0?h.y:b?0:p;function A(it){return it*it}h.type&v.HORIZ_LINE_TO&&l!==0&&(h.type=v.LINE_TO,h.y=h.relative?0:p),h.type&v.VERT_LINE_TO&&c!==0&&(h.type=v.LINE_TO,h.x=h.relative?0:d),h.x!==void 0&&(h.x=h.x*o+M*c+(b?0:g)),h.y!==void 0&&(h.y=x*l+h.y*u+(b?0:f)),h.x1!==void 0&&(h.x1=h.x1*o+h.y1*c+(b?0:g)),h.y1!==void 0&&(h.y1=y*l+h.y1*u+(b?0:f)),h.x2!==void 0&&(h.x2=h.x2*o+h.y2*c+(b?0:g)),h.y2!==void 0&&(h.y2=w*l+h.y2*u+(b?0:f));var E=o*u-l*c;if(h.xRot!==void 0&&(o!==1||l!==0||c!==0||u!==1))if(E===0)delete h.rX,delete h.rY,delete h.xRot,delete h.lArcFlag,delete h.sweepFlag,h.type=v.LINE_TO;else{var I=h.xRot*Math.PI/180,C=Math.sin(I),z=Math.cos(I),O=1/A(h.rX),F=1/A(h.rY),X=A(z)*O+A(C)*F,_=2*C*z*(O-F),k=A(C)*O+A(z)*F,N=X*u*u-_*l*u+k*l*l,P=_*(o*u+l*c)-2*(X*c*u+k*o*l),W=X*c*c-_*o*c+k*o*o,L=(Math.atan2(P,N-W)+Math.PI)%Math.PI/2,R=Math.sin(L),Q=Math.cos(L);h.rX=Math.abs(E)/Math.sqrt(N*A(Q)+P*R*Q+W*A(R)),h.rY=Math.abs(E)/Math.sqrt(N*A(R)-P*R*Q+W*A(Q)),h.xRot=180*L/Math.PI}return h.sweepFlag!==void 0&&0>E&&(h.sweepFlag=+!h.sweepFlag),h})}function a(){return function(o){var l={};for(var c in o)l[c]=o[c];return l}}r.ROUND=function(o){function l(c){return Math.round(c*o)/o}return o===void 0&&(o=1e13),st(o),function(c){return c.x1!==void 0&&(c.x1=l(c.x1)),c.y1!==void 0&&(c.y1=l(c.y1)),c.x2!==void 0&&(c.x2=l(c.x2)),c.y2!==void 0&&(c.y2=l(c.y2)),c.x!==void 0&&(c.x=l(c.x)),c.y!==void 0&&(c.y=l(c.y)),c.rX!==void 0&&(c.rX=l(c.rX)),c.rY!==void 0&&(c.rY=l(c.rY)),c}},r.TO_ABS=t,r.TO_REL=function(){return n(function(o,l,c){return o.relative||(o.x1!==void 0&&(o.x1-=l),o.y1!==void 0&&(o.y1-=c),o.x2!==void 0&&(o.x2-=l),o.y2!==void 0&&(o.y2-=c),o.x!==void 0&&(o.x-=l),o.y!==void 0&&(o.y-=c),o.relative=!0),o})},r.NORMALIZE_HVZ=function(o,l,c){return o===void 0&&(o=!0),l===void 0&&(l=!0),c===void 0&&(c=!0),n(function(u,g,f,h,d){if(isNaN(h)&&!(u.type&v.MOVE_TO))throw new Error("path must start with moveto");return l&&u.type&v.HORIZ_LINE_TO&&(u.type=v.LINE_TO,u.y=u.relative?0:f),c&&u.type&v.VERT_LINE_TO&&(u.type=v.LINE_TO,u.x=u.relative?0:g),o&&u.type&v.CLOSE_PATH&&(u.type=v.LINE_TO,u.x=u.relative?h-g:h,u.y=u.relative?d-f:d),u.type&v.ARC&&(u.rX===0||u.rY===0)&&(u.type=v.LINE_TO,delete u.rX,delete u.rY,delete u.xRot,delete u.lArcFlag,delete u.sweepFlag),u})},r.NORMALIZE_ST=e,r.QT_TO_C=i,r.INFO=n,r.SANITIZE=function(o){o===void 0&&(o=0),st(o);var l=NaN,c=NaN,u=NaN,g=NaN;return n(function(f,h,d,p,m){var y=Math.abs,w=!1,b=0,x=0;if(f.type&v.SMOOTH_CURVE_TO&&(b=isNaN(l)?0:h-l,x=isNaN(c)?0:d-c),f.type&(v.CURVE_TO|v.SMOOTH_CURVE_TO)?(l=f.relative?h+f.x2:f.x2,c=f.relative?d+f.y2:f.y2):(l=NaN,c=NaN),f.type&v.SMOOTH_QUAD_TO?(u=isNaN(u)?h:2*h-u,g=isNaN(g)?d:2*d-g):f.type&v.QUAD_TO?(u=f.relative?h+f.x1:f.x1,g=f.relative?d+f.y1:f.y2):(u=NaN,g=NaN),f.type&v.LINE_COMMANDS||f.type&v.ARC&&(f.rX===0||f.rY===0||!f.lArcFlag)||f.type&v.CURVE_TO||f.type&v.SMOOTH_CURVE_TO||f.type&v.QUAD_TO||f.type&v.SMOOTH_QUAD_TO){var M=f.x===void 0?0:f.relative?f.x:f.x-h,A=f.y===void 0?0:f.relative?f.y:f.y-d;b=isNaN(u)?f.x1===void 0?b:f.relative?f.x:f.x1-h:u-h,x=isNaN(g)?f.y1===void 0?x:f.relative?f.y:f.y1-d:g-d;var E=f.x2===void 0?0:f.relative?f.x:f.x2-h,I=f.y2===void 0?0:f.relative?f.y:f.y2-d;y(M)<=o&&y(A)<=o&&y(b)<=o&&y(x)<=o&&y(E)<=o&&y(I)<=o&&(w=!0)}return f.type&v.CLOSE_PATH&&y(h-p)<=o&&y(d-m)<=o&&(w=!0),w?[]:f})},r.MATRIX=s,r.ROTATE=function(o,l,c){l===void 0&&(l=0),c===void 0&&(c=0),st(o,l,c);var u=Math.sin(o),g=Math.cos(o);return s(g,u,-u,g,l-l*g+c*u,c-l*u-c*g)},r.TRANSLATE=function(o,l){return l===void 0&&(l=0),st(o,l),s(1,0,0,1,o,l)},r.SCALE=function(o,l){return l===void 0&&(l=o),st(o,l),s(o,0,0,l,0,0)},r.SKEW_X=function(o){return st(o),s(1,0,Math.atan(o),1,0,0)},r.SKEW_Y=function(o){return st(o),s(1,Math.atan(o),0,1,0,0)},r.X_AXIS_SYMMETRY=function(o){return o===void 0&&(o=0),st(o),s(-1,0,0,1,o,0)},r.Y_AXIS_SYMMETRY=function(o){return o===void 0&&(o=0),st(o),s(1,0,0,-1,0,o)},r.A_TO_C=function(){return n(function(o,l,c){return v.ARC===o.type?function(u,g,f){var h,d,p,m;u.cX||oi(u,g,f);for(var y=Math.min(u.phi1,u.phi2),w=Math.max(u.phi1,u.phi2)-y,b=Math.ceil(w/90),x=new Array(b),M=g,A=f,E=0;E<b;E++){var I=Gi(u.phi1,u.phi2,E/b),C=Gi(u.phi1,u.phi2,(E+1)/b),z=C-I,O=4/3*Math.tan(z*ut/4),F=[Math.cos(I*ut)-O*Math.sin(I*ut),Math.sin(I*ut)+O*Math.cos(I*ut)],X=F[0],_=F[1],k=[Math.cos(C*ut),Math.sin(C*ut)],N=k[0],P=k[1],W=[N+O*Math.sin(C*ut),P-O*Math.cos(C*ut)],L=W[0],R=W[1];x[E]={relative:u.relative,type:v.CURVE_TO};var Q=function(it,lt){var mt=pi([it*u.rX,lt*u.rY],u.xRot),_t=mt[0],de=mt[1];return[u.cX+_t,u.cY+de]};h=Q(X,_),x[E].x1=h[0],x[E].y1=h[1],d=Q(L,R),x[E].x2=d[0],x[E].y2=d[1],p=Q(N,P),x[E].x=p[0],x[E].y=p[1],u.relative&&(x[E].x1-=M,x[E].y1-=A,x[E].x2-=M,x[E].y2-=A,x[E].x-=M,x[E].y-=A),M=(m=[x[E].x,x[E].y])[0],A=m[1]}return x}(o,o.relative?0:l,o.relative?0:c):o})},r.ANNOTATE_ARCS=function(){return n(function(o,l,c){return o.relative&&(l=0,c=0),v.ARC===o.type&&oi(o,l,c),o})},r.CLONE=a,r.CALCULATE_BOUNDS=function(){var o=function(f){var h={};for(var d in f)h[d]=f[d];return h},l=t(),c=i(),u=e(),g=n(function(f,h,d){var p=u(c(l(o(f))));function m(R){R>g.maxX&&(g.maxX=R),R<g.minX&&(g.minX=R)}function y(R){R>g.maxY&&(g.maxY=R),R<g.minY&&(g.minY=R)}if(p.type&v.DRAWING_COMMANDS&&(m(h),y(d)),p.type&v.HORIZ_LINE_TO&&m(p.x),p.type&v.VERT_LINE_TO&&y(p.y),p.type&v.LINE_TO&&(m(p.x),y(p.y)),p.type&v.CURVE_TO){m(p.x),y(p.y);for(var w=0,b=Zi(h,p.x1,p.x2,p.x);w<b.length;w++)0<(L=b[w])&&1>L&&m(Ki(h,p.x1,p.x2,p.x,L));for(var x=0,M=Zi(d,p.y1,p.y2,p.y);x<M.length;x++)0<(L=M[x])&&1>L&&y(Ki(d,p.y1,p.y2,p.y,L))}if(p.type&v.ARC){m(p.x),y(p.y),oi(p,h,d);for(var A=p.xRot/180*Math.PI,E=Math.cos(A)*p.rX,I=Math.sin(A)*p.rX,C=-Math.sin(A)*p.rY,z=Math.cos(A)*p.rY,O=p.phi1<p.phi2?[p.phi1,p.phi2]:-180>p.phi2?[p.phi2+360,p.phi1+360]:[p.phi2,p.phi1],F=O[0],X=O[1],_=function(R){var Q=R[0],it=R[1],lt=180*Math.atan2(it,Q)/Math.PI;return lt<F?lt+360:lt},k=0,N=Qi(C,-E,0).map(_);k<N.length;k++)(L=N[k])>F&&L<X&&m(qi(p.cX,E,C,L));for(var P=0,W=Qi(z,-I,0).map(_);P<W.length;P++){var L;(L=W[P])>F&&L<X&&y(qi(p.cY,I,z,L))}}return f});return g.minX=1/0,g.maxX=-1/0,g.minY=1/0,g.maxY=-1/0,g}})(H||(H={}));var nt,Fr=function(){function r(){}return r.prototype.round=function(t){return this.transform(H.ROUND(t))},r.prototype.toAbs=function(){return this.transform(H.TO_ABS())},r.prototype.toRel=function(){return this.transform(H.TO_REL())},r.prototype.normalizeHVZ=function(t,e,i){return this.transform(H.NORMALIZE_HVZ(t,e,i))},r.prototype.normalizeST=function(){return this.transform(H.NORMALIZE_ST())},r.prototype.qtToC=function(){return this.transform(H.QT_TO_C())},r.prototype.aToC=function(){return this.transform(H.A_TO_C())},r.prototype.sanitize=function(t){return this.transform(H.SANITIZE(t))},r.prototype.translate=function(t,e){return this.transform(H.TRANSLATE(t,e))},r.prototype.scale=function(t,e){return this.transform(H.SCALE(t,e))},r.prototype.rotate=function(t,e,i){return this.transform(H.ROTATE(t,e,i))},r.prototype.matrix=function(t,e,i,n,s,a){return this.transform(H.MATRIX(t,e,i,n,s,a))},r.prototype.skewX=function(t){return this.transform(H.SKEW_X(t))},r.prototype.skewY=function(t){return this.transform(H.SKEW_Y(t))},r.prototype.xSymmetry=function(t){return this.transform(H.X_AXIS_SYMMETRY(t))},r.prototype.ySymmetry=function(t){return this.transform(H.Y_AXIS_SYMMETRY(t))},r.prototype.annotateArcs=function(){return this.transform(H.ANNOTATE_ARCS())},r}(),fs=function(r){return r===" "||r==="	"||r==="\r"||r===`
`},Ji=function(r){return"0".charCodeAt(0)<=r.charCodeAt(0)&&r.charCodeAt(0)<="9".charCodeAt(0)},gs=function(r){function t(){var e=r.call(this)||this;return e.curNumber="",e.curCommandType=-1,e.curCommandRelative=!1,e.canParseCommandOrComma=!0,e.curNumberHasExp=!1,e.curNumberHasExpDigits=!1,e.curNumberHasDecimal=!1,e.curArgs=[],e}return zr(t,r),t.prototype.finish=function(e){if(e===void 0&&(e=[]),this.parse(" ",e),this.curArgs.length!==0||!this.canParseCommandOrComma)throw new SyntaxError("Unterminated command at the path end.");return e},t.prototype.parse=function(e,i){var n=this;i===void 0&&(i=[]);for(var s=function(g){i.push(g),n.curArgs.length=0,n.canParseCommandOrComma=!0},a=0;a<e.length;a++){var o=e[a],l=!(this.curCommandType!==v.ARC||this.curArgs.length!==3&&this.curArgs.length!==4||this.curNumber.length!==1||this.curNumber!=="0"&&this.curNumber!=="1"),c=Ji(o)&&(this.curNumber==="0"&&o==="0"||l);if(!Ji(o)||c)if(o!=="e"&&o!=="E")if(o!=="-"&&o!=="+"||!this.curNumberHasExp||this.curNumberHasExpDigits)if(o!=="."||this.curNumberHasExp||this.curNumberHasDecimal||l){if(this.curNumber&&this.curCommandType!==-1){var u=Number(this.curNumber);if(isNaN(u))throw new SyntaxError("Invalid number ending at "+a);if(this.curCommandType===v.ARC){if(this.curArgs.length===0||this.curArgs.length===1){if(0>u)throw new SyntaxError('Expected positive number, got "'+u+'" at index "'+a+'"')}else if((this.curArgs.length===3||this.curArgs.length===4)&&this.curNumber!=="0"&&this.curNumber!=="1")throw new SyntaxError('Expected a flag, got "'+this.curNumber+'" at index "'+a+'"')}this.curArgs.push(u),this.curArgs.length===ds[this.curCommandType]&&(v.HORIZ_LINE_TO===this.curCommandType?s({type:v.HORIZ_LINE_TO,relative:this.curCommandRelative,x:u}):v.VERT_LINE_TO===this.curCommandType?s({type:v.VERT_LINE_TO,relative:this.curCommandRelative,y:u}):this.curCommandType===v.MOVE_TO||this.curCommandType===v.LINE_TO||this.curCommandType===v.SMOOTH_QUAD_TO?(s({type:this.curCommandType,relative:this.curCommandRelative,x:this.curArgs[0],y:this.curArgs[1]}),v.MOVE_TO===this.curCommandType&&(this.curCommandType=v.LINE_TO)):this.curCommandType===v.CURVE_TO?s({type:v.CURVE_TO,relative:this.curCommandRelative,x1:this.curArgs[0],y1:this.curArgs[1],x2:this.curArgs[2],y2:this.curArgs[3],x:this.curArgs[4],y:this.curArgs[5]}):this.curCommandType===v.SMOOTH_CURVE_TO?s({type:v.SMOOTH_CURVE_TO,relative:this.curCommandRelative,x2:this.curArgs[0],y2:this.curArgs[1],x:this.curArgs[2],y:this.curArgs[3]}):this.curCommandType===v.QUAD_TO?s({type:v.QUAD_TO,relative:this.curCommandRelative,x1:this.curArgs[0],y1:this.curArgs[1],x:this.curArgs[2],y:this.curArgs[3]}):this.curCommandType===v.ARC&&s({type:v.ARC,relative:this.curCommandRelative,rX:this.curArgs[0],rY:this.curArgs[1],xRot:this.curArgs[2],lArcFlag:this.curArgs[3],sweepFlag:this.curArgs[4],x:this.curArgs[5],y:this.curArgs[6]})),this.curNumber="",this.curNumberHasExpDigits=!1,this.curNumberHasExp=!1,this.curNumberHasDecimal=!1,this.canParseCommandOrComma=!0}if(!fs(o))if(o===","&&this.canParseCommandOrComma)this.canParseCommandOrComma=!1;else if(o!=="+"&&o!=="-"&&o!==".")if(c)this.curNumber=o,this.curNumberHasDecimal=!1;else{if(this.curArgs.length!==0)throw new SyntaxError("Unterminated command at index "+a+".");if(!this.canParseCommandOrComma)throw new SyntaxError('Unexpected character "'+o+'" at index '+a+". Command cannot follow comma");if(this.canParseCommandOrComma=!1,o!=="z"&&o!=="Z")if(o==="h"||o==="H")this.curCommandType=v.HORIZ_LINE_TO,this.curCommandRelative=o==="h";else if(o==="v"||o==="V")this.curCommandType=v.VERT_LINE_TO,this.curCommandRelative=o==="v";else if(o==="m"||o==="M")this.curCommandType=v.MOVE_TO,this.curCommandRelative=o==="m";else if(o==="l"||o==="L")this.curCommandType=v.LINE_TO,this.curCommandRelative=o==="l";else if(o==="c"||o==="C")this.curCommandType=v.CURVE_TO,this.curCommandRelative=o==="c";else if(o==="s"||o==="S")this.curCommandType=v.SMOOTH_CURVE_TO,this.curCommandRelative=o==="s";else if(o==="q"||o==="Q")this.curCommandType=v.QUAD_TO,this.curCommandRelative=o==="q";else if(o==="t"||o==="T")this.curCommandType=v.SMOOTH_QUAD_TO,this.curCommandRelative=o==="t";else{if(o!=="a"&&o!=="A")throw new SyntaxError('Unexpected character "'+o+'" at index '+a+".");this.curCommandType=v.ARC,this.curCommandRelative=o==="a"}else i.push({type:v.CLOSE_PATH}),this.canParseCommandOrComma=!0,this.curCommandType=-1}else this.curNumber=o,this.curNumberHasDecimal=o==="."}else this.curNumber+=o,this.curNumberHasDecimal=!0;else this.curNumber+=o;else this.curNumber+=o,this.curNumberHasExp=!0;else this.curNumber+=o,this.curNumberHasExpDigits=this.curNumberHasExp}return i},t.prototype.transform=function(e){return Object.create(this,{parse:{value:function(i,n){n===void 0&&(n=[]);for(var s=0,a=Object.getPrototypeOf(this).parse.call(this,i);s<a.length;s++){var o=a[s],l=e(o);Array.isArray(l)?n.push.apply(n,l):n.push(l)}return n}}})},t}(Fr),v=function(r){function t(e){var i=r.call(this)||this;return i.commands=typeof e=="string"?t.parse(e):e,i}return zr(t,r),t.prototype.encode=function(){return t.encode(this.commands)},t.prototype.getBounds=function(){var e=H.CALCULATE_BOUNDS();return this.transform(e),e},t.prototype.transform=function(e){for(var i=[],n=0,s=this.commands;n<s.length;n++){var a=e(s[n]);Array.isArray(a)?i.push.apply(i,a):i.push(a)}return this.commands=i,this},t.encode=function(e){return hs(e)},t.parse=function(e){var i=new gs,n=[];return i.parse(e,n),i.finish(n),n},t.CLOSE_PATH=1,t.MOVE_TO=2,t.HORIZ_LINE_TO=4,t.VERT_LINE_TO=8,t.LINE_TO=16,t.CURVE_TO=32,t.SMOOTH_CURVE_TO=64,t.QUAD_TO=128,t.SMOOTH_QUAD_TO=256,t.ARC=512,t.LINE_COMMANDS=t.LINE_TO|t.HORIZ_LINE_TO|t.VERT_LINE_TO,t.DRAWING_COMMANDS=t.HORIZ_LINE_TO|t.VERT_LINE_TO|t.LINE_TO|t.CURVE_TO|t.SMOOTH_CURVE_TO|t.QUAD_TO|t.SMOOTH_QUAD_TO|t.ARC,t}(Fr),ds=((nt={})[v.MOVE_TO]=2,nt[v.LINE_TO]=2,nt[v.HORIZ_LINE_TO]=1,nt[v.VERT_LINE_TO]=1,nt[v.CLOSE_PATH]=0,nt[v.QUAD_TO]=4,nt[v.SMOOTH_QUAD_TO]=2,nt[v.CURVE_TO]=6,nt[v.SMOOTH_CURVE_TO]=4,nt[v.ARC]=7,nt);function Pe(r){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Pe=function(t){return typeof t}:Pe=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pe(r)}function ps(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}var ms=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],ys=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function vs(r,t,e,i,n){if(typeof r=="string"&&(r=document.getElementById(r)),!r||Pe(r)!=="object"||!("getContext"in r))throw new TypeError("Expecting canvas with `getContext` method in processCanvasRGB(A) calls!");var s=r.getContext("2d");try{return s.getImageData(t,e,i,n)}catch(a){throw new Error("unable to access image data: "+a)}}function bs(r,t,e,i,n,s){if(!(isNaN(s)||s<1)){s|=0;var a=vs(r,t,e,i,n);a=xs(a,t,e,i,n,s),r.getContext("2d").putImageData(a,t,e)}}function xs(r,t,e,i,n,s){for(var a=r.data,o=2*s+1,l=i-1,c=n-1,u=s+1,g=u*(u+1)/2,f=new tr,h=f,d,p=1;p<o;p++)h=h.next=new tr,p===u&&(d=h);h.next=f;for(var m=null,y=null,w=0,b=0,x=ms[s],M=ys[s],A=0;A<n;A++){h=f;for(var E=a[b],I=a[b+1],C=a[b+2],z=a[b+3],O=0;O<u;O++)h.r=E,h.g=I,h.b=C,h.a=z,h=h.next;for(var F=0,X=0,_=0,k=0,N=u*E,P=u*I,W=u*C,L=u*z,R=g*E,Q=g*I,it=g*C,lt=g*z,mt=1;mt<u;mt++){var _t=b+((l<mt?l:mt)<<2),de=a[_t],Ri=a[_t+1],Vi=a[_t+2],_i=a[_t+3],pe=u-mt;R+=(h.r=de)*pe,Q+=(h.g=Ri)*pe,it+=(h.b=Vi)*pe,lt+=(h.a=_i)*pe,F+=de,X+=Ri,_+=Vi,k+=_i,h=h.next}m=f,y=d;for(var je=0;je<i;je++){var $e=lt*x>>M;if(a[b+3]=$e,$e!==0){var We=255/$e;a[b]=(R*x>>M)*We,a[b+1]=(Q*x>>M)*We,a[b+2]=(it*x>>M)*We}else a[b]=a[b+1]=a[b+2]=0;R-=N,Q-=P,it-=W,lt-=L,N-=m.r,P-=m.g,W-=m.b,L-=m.a;var St=je+s+1;St=w+(St<l?St:l)<<2,F+=m.r=a[St],X+=m.g=a[St+1],_+=m.b=a[St+2],k+=m.a=a[St+3],R+=F,Q+=X,it+=_,lt+=k,m=m.next;var me=y,Li=me.r,Ui=me.g,zi=me.b,Fi=me.a;N+=Li,P+=Ui,W+=zi,L+=Fi,F-=Li,X-=Ui,_-=zi,k-=Fi,y=y.next,b+=4}w+=i}for(var Lt=0;Lt<i;Lt++){b=Lt<<2;var At=a[b],Nt=a[b+1],Ct=a[b+2],q=a[b+3],Qe=u*At,Ge=u*Nt,qe=u*Ct,Ze=u*q,ye=g*At,ve=g*Nt,be=g*Ct,xe=g*q;h=f;for(var Bi=0;Bi<u;Bi++)h.r=At,h.g=Nt,h.b=Ct,h.a=q,h=h.next;for(var Hi=i,Ke=0,Je=0,ti=0,ei=0,we=1;we<=s;we++){b=Hi+Lt<<2;var Te=u-we;ye+=(h.r=At=a[b])*Te,ve+=(h.g=Nt=a[b+1])*Te,be+=(h.b=Ct=a[b+2])*Te,xe+=(h.a=q=a[b+3])*Te,ei+=At,Ke+=Nt,Je+=Ct,ti+=q,h=h.next,we<c&&(Hi+=i)}b=Lt,m=f,y=d;for(var ii=0;ii<n;ii++){var Z=b<<2;a[Z+3]=q=xe*x>>M,q>0?(q=255/q,a[Z]=(ye*x>>M)*q,a[Z+1]=(ve*x>>M)*q,a[Z+2]=(be*x>>M)*q):a[Z]=a[Z+1]=a[Z+2]=0,ye-=Qe,ve-=Ge,be-=qe,xe-=Ze,Qe-=m.r,Ge-=m.g,qe-=m.b,Ze-=m.a,Z=Lt+((Z=ii+u)<c?Z:c)*i<<2,ye+=ei+=m.r=a[Z],ve+=Ke+=m.g=a[Z+1],be+=Je+=m.b=a[Z+2],xe+=ti+=m.a=a[Z+3],m=m.next,Qe+=At=y.r,Ge+=Nt=y.g,qe+=Ct=y.b,Ze+=q=y.a,ei-=At,Ke-=Nt,Je-=Ct,ti-=q,y=y.next,b+=i}}return r}var tr=function r(){ps(this,r),this.r=0,this.g=0,this.b=0,this.a=0,this.next=null};function Zt(r){return r.replace(/(?!\u3000)\s+/gm," ")}function ws(r){return r.replace(/^[\n \t]+/,"")}function Ts(r){return r.replace(/[\n \t]+$/,"")}function et(r){const t=r.match(/-?(\d+(?:\.\d*(?:[eE][+-]?\d+)?)?|\.\d+)(?=\D|$)/gm);return t?t.map(parseFloat):[]}function Es(r){const t=et(r);return[t[0]||0,t[1]||0,t[2]||0,t[3]||0,t[4]||0,t[5]||0]}const Ss=/^[A-Z-]+$/;function As(r){return Ss.test(r)?r.toLowerCase():r}function Br(r){const t=/url\(('([^']+)'|"([^"]+)"|([^'")]+))\)/.exec(r);return t&&(t[2]||t[3]||t[4])||""}function Ns(r){if(!r.startsWith("rgb"))return r;let t=3;return r.replace(/\d+(\.\d+)?/g,(i,n)=>t--&&n?String(Math.round(parseFloat(i))):i)}const Cs=/(\[[^\]]+\])/g,Ms=/(#[^\s+>~.[:]+)/g,Os=/(\.[^\s+>~.[:]+)/g,Ps=/(::[^\s+>~.[:]+|:first-line|:first-letter|:before|:after)/gi,Ds=/(:[\w-]+\([^)]*\))/gi,Is=/(:[^\s+>~.[:]+)/g,ks=/([^\s+>~.[:]+)/g;function Ot(r,t){const e=t.exec(r);return e?[r.replace(t," "),e.length]:[r,0]}function Rs(r){const t=[0,0,0];let e=r.replace(/:not\(([^)]*)\)/g,"     $1 ").replace(/{[\s\S]*/gm," "),i=0;return[e,i]=Ot(e,Cs),t[1]+=i,[e,i]=Ot(e,Ms),t[0]+=i,[e,i]=Ot(e,Os),t[1]+=i,[e,i]=Ot(e,Ps),t[2]+=i,[e,i]=Ot(e,Ds),t[1]+=i,[e,i]=Ot(e,Is),t[1]+=i,e=e.replace(/[*\s+>~]/g," ").replace(/[#.]/g," "),[e,i]=Ot(e,ks),t[2]+=i,t.join("")}const $t=1e-8;function er(r){return Math.sqrt(Math.pow(r[0],2)+Math.pow(r[1],2))}function mi(r,t){return(r[0]*t[0]+r[1]*t[1])/(er(r)*er(t))}function ir(r,t){return(r[0]*t[1]<r[1]*t[0]?-1:1)*Math.acos(mi(r,t))}function rr(r){return r*r*r}function nr(r){return 3*r*r*(1-r)}function sr(r){return 3*r*(1-r)*(1-r)}function or(r){return(1-r)*(1-r)*(1-r)}function ar(r){return r*r}function lr(r){return 2*r*(1-r)}function cr(r){return(1-r)*(1-r)}class T{static empty(t){return new T(t,"EMPTY","")}split(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:" ";const{document:e,name:i}=this;return Zt(this.getString()).trim().split(t).map(n=>new T(e,i,n))}hasValue(t){const e=this.value;return e!==null&&e!==""&&(t||e!==0)&&typeof e<"u"}isString(t){const{value:e}=this,i=typeof e=="string";return!i||!t?i:t.test(e)}isUrlDefinition(){return this.isString(/^url\(/)}isPixels(){if(!this.hasValue())return!1;const t=this.getString();switch(!0){case t.endsWith("px"):case/^[0-9]+$/.test(t):return!0;default:return!1}}setValue(t){return this.value=t,this}getValue(t){return typeof t>"u"||this.hasValue()?this.value:t}getNumber(t){if(!this.hasValue())return typeof t>"u"?0:parseFloat(t);const{value:e}=this;let i=parseFloat(e);return this.isString(/%$/)&&(i/=100),i}getString(t){return typeof t>"u"||this.hasValue()?typeof this.value>"u"?"":String(this.value):String(t)}getColor(t){let e=this.getString(t);return this.isNormalizedColor||(this.isNormalizedColor=!0,e=Ns(e),this.value=e),e}getDpi(){return 96}getRem(){return this.document.rootEmSize}getEm(){return this.document.emSize}getUnits(){return this.getString().replace(/[0-9.-]/g,"")}getPixels(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!this.hasValue())return 0;const[i,n]=typeof t=="boolean"?[void 0,t]:[t],{viewPort:s}=this.document.screen;switch(!0){case this.isString(/vmin$/):return this.getNumber()/100*Math.min(s.computeSize("x"),s.computeSize("y"));case this.isString(/vmax$/):return this.getNumber()/100*Math.max(s.computeSize("x"),s.computeSize("y"));case this.isString(/vw$/):return this.getNumber()/100*s.computeSize("x");case this.isString(/vh$/):return this.getNumber()/100*s.computeSize("y");case this.isString(/rem$/):return this.getNumber()*this.getRem();case this.isString(/em$/):return this.getNumber()*this.getEm();case this.isString(/ex$/):return this.getNumber()*this.getEm()/2;case this.isString(/px$/):return this.getNumber();case this.isString(/pt$/):return this.getNumber()*this.getDpi()*(1/72);case this.isString(/pc$/):return this.getNumber()*15;case this.isString(/cm$/):return this.getNumber()*this.getDpi()/2.54;case this.isString(/mm$/):return this.getNumber()*this.getDpi()/25.4;case this.isString(/in$/):return this.getNumber()*this.getDpi();case(this.isString(/%$/)&&n):return this.getNumber()*this.getEm();case this.isString(/%$/):return this.getNumber()*s.computeSize(i);default:{const a=this.getNumber();return e&&a<1?a*s.computeSize(i):a}}}getMilliseconds(){return this.hasValue()?this.isString(/ms$/)?this.getNumber():this.getNumber()*1e3:0}getRadians(){if(!this.hasValue())return 0;switch(!0){case this.isString(/deg$/):return this.getNumber()*(Math.PI/180);case this.isString(/grad$/):return this.getNumber()*(Math.PI/200);case this.isString(/rad$/):return this.getNumber();default:return this.getNumber()*(Math.PI/180)}}getDefinition(){const t=this.getString(),e=/#([^)'"]+)/.exec(t),i=(e==null?void 0:e[1])||t;return this.document.definitions[i]}getFillStyleDefinition(t,e){let i=this.getDefinition();if(!i)return null;if(typeof i.createGradient=="function"&&"getBoundingBox"in t)return i.createGradient(this.document.ctx,t,e);if(typeof i.createPattern=="function"){if(i.getHrefAttribute().hasValue()){const n=i.getAttribute("patternTransform");i=i.getHrefAttribute().getDefinition(),i&&n.hasValue()&&i.getAttribute("patternTransform",!0).setValue(n.value)}if(i)return i.createPattern(this.document.ctx,t,e)}return null}getTextBaseline(){if(!this.hasValue())return null;const t=this.getString();return T.textBaselineMapping[t]||null}addOpacity(t){let e=this.getColor();const i=e.length;let n=0;for(let s=0;s<i&&(e[s]===","&&n++,n!==3);s++);if(t.hasValue()&&this.isString()&&n!==3){const s=new di(e);s.ok&&(s.alpha=t.getNumber(),e=s.toRGBA())}return new T(this.document,this.name,e)}constructor(t,e,i){this.document=t,this.name=e,this.value=i,this.isNormalizedColor=!1}}T.textBaselineMapping={baseline:"alphabetic","before-edge":"top","text-before-edge":"top",middle:"middle",central:"middle","after-edge":"bottom","text-after-edge":"bottom",ideographic:"ideographic",alphabetic:"alphabetic",hanging:"hanging",mathematical:"alphabetic"};class ne{clear(){this.viewPorts=[]}setCurrent(t,e){this.viewPorts.push({width:t,height:e})}removeCurrent(){this.viewPorts.pop()}getRoot(){const[t]=this.viewPorts;return t||ur()}getCurrent(){const{viewPorts:t}=this,e=t[t.length-1];return e||ur()}get width(){return this.getCurrent().width}get height(){return this.getCurrent().height}computeSize(t){return typeof t=="number"?t:t==="x"?this.width:t==="y"?this.height:Math.sqrt(Math.pow(this.width,2)+Math.pow(this.height,2))/Math.sqrt(2)}constructor(){this.viewPorts=[]}}ne.DEFAULT_VIEWPORT_WIDTH=800;ne.DEFAULT_VIEWPORT_HEIGHT=600;function ur(){return{width:ne.DEFAULT_VIEWPORT_WIDTH,height:ne.DEFAULT_VIEWPORT_HEIGHT}}class V{static parse(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const[i=e,n=e]=et(t);return new V(i,n)}static parseScale(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;const[i=e,n=i]=et(t);return new V(i,n)}static parsePath(t){const e=et(t),i=e.length,n=[];for(let s=0;s<i;s+=2)n.push(new V(e[s],e[s+1]));return n}angleTo(t){return Math.atan2(t.y-this.y,t.x-this.x)}applyTransform(t){const{x:e,y:i}=this,n=e*t[0]+i*t[2]+t[4],s=e*t[1]+i*t[3]+t[5];this.x=n,this.y=s}constructor(t,e){this.x=t,this.y=e}}class Vs{isWorking(){return this.working}start(){if(this.working)return;const{screen:t,onClick:e,onMouseMove:i}=this,n=t.ctx.canvas;n.onclick=e,n.onmousemove=i,this.working=!0}stop(){if(!this.working)return;const t=this.screen.ctx.canvas;this.working=!1,t.onclick=null,t.onmousemove=null}hasEvents(){return this.working&&this.events.length>0}runEvents(){if(!this.working)return;const{screen:t,events:e,eventElements:i}=this,{style:n}=t.ctx.canvas;let s;n&&(n.cursor=""),e.forEach((a,o)=>{let{run:l}=a;for(s=i[o];s;)l(s),s=s.parent}),this.events=[],this.eventElements=[]}checkPath(t,e){if(!this.working||!e)return;const{events:i,eventElements:n}=this;i.forEach((s,a)=>{let{x:o,y:l}=s;!n[a]&&e.isPointInPath&&e.isPointInPath(o,l)&&(n[a]=t)})}checkBoundingBox(t,e){if(!this.working||!e)return;const{events:i,eventElements:n}=this;i.forEach((s,a)=>{let{x:o,y:l}=s;!n[a]&&e.isPointInBox(o,l)&&(n[a]=t)})}mapXY(t,e){const{window:i,ctx:n}=this.screen,s=new V(t,e);let a=n.canvas;for(;a;)s.x-=a.offsetLeft,s.y-=a.offsetTop,a=a.offsetParent;return i!=null&&i.scrollX&&(s.x+=i.scrollX),i!=null&&i.scrollY&&(s.y+=i.scrollY),s}onClick(t){const{x:e,y:i}=this.mapXY(t.clientX,t.clientY);this.events.push({type:"onclick",x:e,y:i,run(n){n.onClick&&n.onClick()}})}onMouseMove(t){const{x:e,y:i}=this.mapXY(t.clientX,t.clientY);this.events.push({type:"onmousemove",x:e,y:i,run(n){n.onMouseMove&&n.onMouseMove()}})}constructor(t){this.screen=t,this.working=!1,this.events=[],this.eventElements=[],this.onClick=this.onClick.bind(this),this.onMouseMove=this.onMouseMove.bind(this)}}const Hr=typeof window<"u"?window:null,Xr=typeof fetch<"u"?fetch.bind(void 0):void 0;class pt{wait(t){this.waits.push(t)}ready(){return this.readyPromise?this.readyPromise:Promise.resolve()}isReady(){if(this.isReadyLock)return!0;const t=this.waits.every(e=>e());return t&&(this.waits=[],this.resolveReady&&this.resolveReady()),this.isReadyLock=t,t}setDefaults(t){t.strokeStyle="rgba(0,0,0,0)",t.lineCap="butt",t.lineJoin="miter",t.miterLimit=4}setViewBox(t){let{document:e,ctx:i,aspectRatio:n,width:s,desiredWidth:a,height:o,desiredHeight:l,minX:c=0,minY:u=0,refX:g,refY:f,clip:h=!1,clipX:d=0,clipY:p=0}=t;const m=Zt(n).replace(/^defer\s/,""),[y,w]=m.split(" "),b=y||"xMidYMid",x=w||"meet",M=s/a,A=o/l,E=Math.min(M,A),I=Math.max(M,A);let C=a,z=l;x==="meet"&&(C*=E,z*=E),x==="slice"&&(C*=I,z*=I);const O=new T(e,"refX",g),F=new T(e,"refY",f),X=O.hasValue()&&F.hasValue();if(X&&i.translate(-E*O.getPixels("x"),-E*F.getPixels("y")),h){const _=E*d,k=E*p;i.beginPath(),i.moveTo(_,k),i.lineTo(s,k),i.lineTo(s,o),i.lineTo(_,o),i.closePath(),i.clip()}if(!X){const _=x==="meet"&&E===A,k=x==="slice"&&I===A,N=x==="meet"&&E===M,P=x==="slice"&&I===M;b.startsWith("xMid")&&(_||k)&&i.translate(s/2-C/2,0),b.endsWith("YMid")&&(N||P)&&i.translate(0,o/2-z/2),b.startsWith("xMax")&&(_||k)&&i.translate(s-C,0),b.endsWith("YMax")&&(N||P)&&i.translate(0,o-z)}switch(!0){case b==="none":i.scale(M,A);break;case x==="meet":i.scale(E,E);break;case x==="slice":i.scale(I,I);break}i.translate(-c,-u)}start(t){let{enableRedraw:e=!1,ignoreMouse:i=!1,ignoreAnimation:n=!1,ignoreDimensions:s=!1,ignoreClear:a=!1,forceRedraw:o,scaleWidth:l,scaleHeight:c,offsetX:u,offsetY:g}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{mouse:f}=this,h=1e3/pt.FRAMERATE;if(this.isReadyLock=!1,this.frameDuration=h,this.readyPromise=new Promise(w=>{this.resolveReady=w}),this.isReady()&&this.render(t,s,a,l,c,u,g),!e)return;let d=Date.now(),p=d,m=0;const y=()=>{d=Date.now(),m=d-p,m>=h&&(p=d-m%h,this.shouldUpdate(n,o)&&(this.render(t,s,a,l,c,u,g),f.runEvents())),this.intervalId=Pt(y)};i||f.start(),this.intervalId=Pt(y)}stop(){this.intervalId&&(Pt.cancel(this.intervalId),this.intervalId=null),this.mouse.stop()}shouldUpdate(t,e){if(!t){const{frameDuration:i}=this;if(this.animations.reduce((s,a)=>a.update(i)||s,!1))return!0}return!!(typeof e=="function"&&e()||!this.isReadyLock&&this.isReady()||this.mouse.hasEvents())}render(t,e,i,n,s,a,o){const{viewPort:l,ctx:c,isFirstRender:u}=this,g=c.canvas;l.clear(),g.width&&g.height&&l.setCurrent(g.width,g.height);const f=t.getStyle("width"),h=t.getStyle("height");!e&&(u||typeof n!="number"&&typeof s!="number")&&(f.hasValue()&&(g.width=f.getPixels("x"),g.style&&(g.style.width="".concat(g.width,"px"))),h.hasValue()&&(g.height=h.getPixels("y"),g.style&&(g.style.height="".concat(g.height,"px"))));let d=g.clientWidth||g.width,p=g.clientHeight||g.height;if(e&&f.hasValue()&&h.hasValue()&&(d=f.getPixels("x"),p=h.getPixels("y")),l.setCurrent(d,p),typeof a=="number"&&t.getAttribute("x",!0).setValue(a),typeof o=="number"&&t.getAttribute("y",!0).setValue(o),typeof n=="number"||typeof s=="number"){const m=et(t.getAttribute("viewBox").getString());let y=0,w=0;if(typeof n=="number"){const x=t.getStyle("width");x.hasValue()?y=x.getPixels("x")/n:m[2]&&!isNaN(m[2])&&(y=m[2]/n)}if(typeof s=="number"){const x=t.getStyle("height");x.hasValue()?w=x.getPixels("y")/s:m[3]&&!isNaN(m[3])&&(w=m[3]/s)}y||(y=w),w||(w=y),t.getAttribute("width",!0).setValue(n),t.getAttribute("height",!0).setValue(s);const b=t.getStyle("transform",!0,!0);b.setValue("".concat(b.getString()," scale(").concat(1/y,", ").concat(1/w,")"))}i||c.clearRect(0,0,d,p),t.render(c),u&&(this.isFirstRender=!1)}constructor(t,{fetch:e=Xr,window:i=Hr}={}){if(this.ctx=t,this.viewPort=new ne,this.mouse=new Vs(this),this.animations=[],this.waits=[],this.frameDuration=0,this.isReadyLock=!1,this.isFirstRender=!0,this.intervalId=null,this.window=i,!e)throw new Error("Can't find 'fetch' in 'globalThis', please provide it via options");this.fetch=e}}pt.defaultWindow=Hr;pt.defaultFetch=Xr;pt.FRAMERATE=30;pt.MAX_VIRTUAL_PIXELS=3e4;const{defaultFetch:_s}=pt,Ls=typeof DOMParser<"u"?DOMParser:void 0;class ai{async parse(t){return t.startsWith("<")?this.parseFromString(t):this.load(t)}parseFromString(t){const e=new this.DOMParser;try{return this.checkDocument(e.parseFromString(t,"image/svg+xml"))}catch{return this.checkDocument(e.parseFromString(t,"text/xml"))}}checkDocument(t){const e=t.getElementsByTagName("parsererror")[0];if(e)throw new Error(e.textContent||"Unknown parse error");return t}async load(t){const i=await(await this.fetch(t)).text();return this.parseFromString(i)}constructor({fetch:t=_s,DOMParser:e=Ls}={}){if(!t)throw new Error("Can't find 'fetch' in 'globalThis', please provide it via options");if(!e)throw new Error("Can't find 'DOMParser' in 'globalThis', please provide it via options");this.fetch=t,this.DOMParser=e}}class Us{apply(t){const{x:e,y:i}=this.point;t.translate(e||0,i||0)}unapply(t){const{x:e,y:i}=this.point;t.translate(-1*e||0,-1*i||0)}applyToPoint(t){const{x:e,y:i}=this.point;t.applyTransform([1,0,0,1,e||0,i||0])}constructor(t,e){this.type="translate",this.point=V.parse(e)}}class zs{apply(t){const{cx:e,cy:i,originX:n,originY:s,angle:a}=this,o=e+n.getPixels("x"),l=i+s.getPixels("y");t.translate(o,l),t.rotate(a.getRadians()),t.translate(-o,-l)}unapply(t){const{cx:e,cy:i,originX:n,originY:s,angle:a}=this,o=e+n.getPixels("x"),l=i+s.getPixels("y");t.translate(o,l),t.rotate(-1*a.getRadians()),t.translate(-o,-l)}applyToPoint(t){const{cx:e,cy:i,angle:n}=this,s=n.getRadians();t.applyTransform([1,0,0,1,e||0,i||0]),t.applyTransform([Math.cos(s),Math.sin(s),-Math.sin(s),Math.cos(s),0,0]),t.applyTransform([1,0,0,1,-e||0,-i||0])}constructor(t,e,i){this.type="rotate";const n=et(e);this.angle=new T(t,"angle",n[0]),this.originX=i[0],this.originY=i[1],this.cx=n[1]||0,this.cy=n[2]||0}}class Fs{apply(t){const{scale:{x:e,y:i},originX:n,originY:s}=this,a=n.getPixels("x"),o=s.getPixels("y");t.translate(a,o),t.scale(e,i||e),t.translate(-a,-o)}unapply(t){const{scale:{x:e,y:i},originX:n,originY:s}=this,a=n.getPixels("x"),o=s.getPixels("y");t.translate(a,o),t.scale(1/e,1/i||e),t.translate(-a,-o)}applyToPoint(t){const{x:e,y:i}=this.scale;t.applyTransform([e||0,0,0,i||0,0,0])}constructor(t,e,i){this.type="scale";const n=V.parseScale(e);(n.x===0||n.y===0)&&(n.x=$t,n.y=$t),this.scale=n,this.originX=i[0],this.originY=i[1]}}class Yr{apply(t){const{originX:e,originY:i,matrix:n}=this,s=e.getPixels("x"),a=i.getPixels("y");t.translate(s,a),t.transform(n[0],n[1],n[2],n[3],n[4],n[5]),t.translate(-s,-a)}unapply(t){const{originX:e,originY:i,matrix:n}=this,s=n[0],a=n[2],o=n[4],l=n[1],c=n[3],u=n[5],g=0,f=0,h=1,d=1/(s*(c*h-u*f)-a*(l*h-u*g)+o*(l*f-c*g)),p=e.getPixels("x"),m=i.getPixels("y");t.translate(p,m),t.transform(d*(c*h-u*f),d*(u*g-l*h),d*(o*f-a*h),d*(s*h-o*g),d*(a*u-o*c),d*(o*l-s*u)),t.translate(-p,-m)}applyToPoint(t){t.applyTransform(this.matrix)}constructor(t,e,i){this.type="matrix",this.matrix=Es(e),this.originX=i[0],this.originY=i[1]}}class jr extends Yr{constructor(t,e,i){super(t,e,i),this.type="skew",this.angle=new T(t,"angle",e)}}class Bs extends jr{constructor(t,e,i){super(t,e,i),this.type="skewX",this.matrix=[1,0,Math.tan(this.angle.getRadians()),1,0,0]}}class Hs extends jr{constructor(t,e,i){super(t,e,i),this.type="skewY",this.matrix=[1,Math.tan(this.angle.getRadians()),0,1,0,0]}}function Xs(r){return Zt(r).trim().replace(/\)([a-zA-Z])/g,") $1").replace(/\)(\s?,\s?)/g,") ").split(/\s(?=[a-z])/)}function Ys(r){const[t="",e=""]=r.split("(");return[t.trim(),e.trim().replace(")","")]}class It{static fromElement(t,e){const i=e.getStyle("transform",!1,!0);if(i.hasValue()){const[n,s=n]=e.getStyle("transform-origin",!1,!0).split();if(n&&s){const a=[n,s];return new It(t,i.getString(),a)}}return null}apply(t){this.transforms.forEach(e=>e.apply(t))}unapply(t){this.transforms.forEach(e=>e.unapply(t))}applyToPoint(t){this.transforms.forEach(e=>e.applyToPoint(t))}constructor(t,e,i){this.document=t,this.transforms=[],Xs(e).forEach(s=>{if(s==="none")return;const[a,o]=Ys(s),l=It.transformTypes[a];l&&this.transforms.push(new l(this.document,o,i))})}}It.transformTypes={translate:Us,rotate:zs,scale:Fs,matrix:Yr,skewX:Bs,skewY:Hs};let U=class yi{getAttribute(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const i=this.attributes[t];if(!i&&e){const n=new T(this.document,t,"");return this.attributes[t]=n,n}return i||T.empty(this.document)}getHrefAttribute(){let t;for(const e in this.attributes)if(e==="href"||e.endsWith(":href")){t=this.attributes[e];break}return t||T.empty(this.document)}getStyle(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const n=this.styles[t];if(n)return n;const s=this.getAttribute(t);if(s.hasValue())return this.styles[t]=s,s;if(!i){const{parent:a}=this;if(a){const o=a.getStyle(t);if(o.hasValue())return o}}if(e){const a=new T(this.document,t,"");return this.styles[t]=a,a}return T.empty(this.document)}render(t){if(!(this.getStyle("display").getString()==="none"||this.getStyle("visibility").getString()==="hidden")){if(t.save(),this.getStyle("mask").hasValue()){const e=this.getStyle("mask").getDefinition();e&&(this.applyEffects(t),e.apply(t,this))}else if(this.getStyle("filter").getValue("none")!=="none"){const e=this.getStyle("filter").getDefinition();e&&(this.applyEffects(t),e.apply(t,this))}else this.setContext(t),this.renderChildren(t),this.clearContext(t);t.restore()}}setContext(t){}applyEffects(t){const e=It.fromElement(this.document,this);e&&e.apply(t);const i=this.getStyle("clip-path",!1,!0);if(i.hasValue()){const n=i.getDefinition();n&&n.apply(t)}}clearContext(t){}renderChildren(t){this.children.forEach(e=>{e.render(t)})}addChild(t){const e=t instanceof yi?t:this.document.createElement(t);e.parent=this,yi.ignoreChildTypes.includes(e.type)||this.children.push(e)}matchesSelector(t){var e;const{node:i}=this;if(typeof i.matches=="function")return i.matches(t);const n=(e=i.getAttribute)===null||e===void 0?void 0:e.call(i,"class");return!n||n===""?!1:n.split(" ").some(s=>".".concat(s)===t)}addStylesFromStyleDefinition(){const{styles:t,stylesSpecificity:e}=this.document;let i;for(const n in t)if(!n.startsWith("@")&&this.matchesSelector(n)){const s=t[n],a=e[n];if(s)for(const o in s){let l=this.stylesSpecificity[o];typeof l>"u"&&(l="000"),a&&a>=l&&(i=s[o],i&&(this.styles[o]=i),this.stylesSpecificity[o]=a)}}}removeStyles(t,e){return e.reduce((n,s)=>{const a=t.getStyle(s);if(!a.hasValue())return n;const o=a.getString();return a.setValue(""),[...n,[s,o]]},[])}restoreStyles(t,e){e.forEach(i=>{let[n,s]=i;t.getStyle(n,!0).setValue(s)})}isFirstChild(){var t;return((t=this.parent)===null||t===void 0?void 0:t.children.indexOf(this))===0}constructor(t,e,i=!1){if(this.document=t,this.node=e,this.captureTextNodes=i,this.type="",this.attributes={},this.styles={},this.stylesSpecificity={},this.animationFrozen=!1,this.animationFrozenValue="",this.parent=null,this.children=[],!e||e.nodeType!==1)return;Array.from(e.attributes).forEach(a=>{const o=As(a.nodeName);this.attributes[o]=new T(t,o,a.value)}),this.addStylesFromStyleDefinition(),this.getAttribute("style").hasValue()&&this.getAttribute("style").getString().split(";").map(o=>o.trim()).forEach(o=>{if(!o)return;const[l,c]=o.split(":").map(u=>u.trim());l&&(this.styles[l]=new T(t,l,c))});const{definitions:n}=t,s=this.getAttribute("id");s.hasValue()&&(n[s.getString()]||(n[s.getString()]=this)),Array.from(e.childNodes).forEach(a=>{if(a.nodeType===1)this.addChild(a);else if(i&&(a.nodeType===3||a.nodeType===4)){const o=t.createTextNode(a);o.getText().length>0&&this.addChild(o)}})}};U.ignoreChildTypes=["title"];class js extends U{constructor(t,e,i){super(t,e,i)}}function $s(r){const t=r.trim();return/^('|")/.test(t)?t:'"'.concat(t,'"')}function Ws(r){return typeof process>"u"?r:r.trim().split(",").map($s).join(",")}function Qs(r){if(!r)return"";const t=r.trim().toLowerCase();switch(t){case"normal":case"italic":case"oblique":case"inherit":case"initial":case"unset":return t;default:return/^oblique\s+(-|)\d+deg$/.test(t)?t:""}}function Gs(r){if(!r)return"";const t=r.trim().toLowerCase();switch(t){case"normal":case"bold":case"lighter":case"bolder":case"inherit":case"initial":case"unset":return t;default:return/^[\d.]+$/.test(t)?t:""}}class G{static parse(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",e=arguments.length>1?arguments[1]:void 0,i="",n="",s="",a="",o="";const l=Zt(t).trim().split(" "),c={fontSize:!1,fontStyle:!1,fontWeight:!1,fontVariant:!1};return l.forEach(u=>{switch(!0){case(!c.fontStyle&&G.styles.includes(u)):u!=="inherit"&&(i=u),c.fontStyle=!0;break;case(!c.fontVariant&&G.variants.includes(u)):u!=="inherit"&&(n=u),c.fontStyle=!0,c.fontVariant=!0;break;case(!c.fontWeight&&G.weights.includes(u)):u!=="inherit"&&(s=u),c.fontStyle=!0,c.fontVariant=!0,c.fontWeight=!0;break;case!c.fontSize:u!=="inherit"&&(a=u.split("/")[0]||""),c.fontStyle=!0,c.fontVariant=!0,c.fontWeight=!0,c.fontSize=!0;break;default:u!=="inherit"&&(o+=u)}}),new G(i,n,s,a,o,e)}toString(){return[Qs(this.fontStyle),this.fontVariant,Gs(this.fontWeight),this.fontSize,Ws(this.fontFamily)].join(" ").trim()}constructor(t,e,i,n,s,a){const o=a?typeof a=="string"?G.parse(a):a:{};this.fontFamily=s||o.fontFamily,this.fontSize=n||o.fontSize,this.fontStyle=t||o.fontStyle,this.fontWeight=i||o.fontWeight,this.fontVariant=e||o.fontVariant}}G.styles="normal|italic|oblique|inherit";G.variants="normal|small-caps|inherit";G.weights="normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900|inherit";class at{get x(){return this.x1}get y(){return this.y1}get width(){return this.x2-this.x1}get height(){return this.y2-this.y1}addPoint(t,e){typeof t<"u"&&((isNaN(this.x1)||isNaN(this.x2))&&(this.x1=t,this.x2=t),t<this.x1&&(this.x1=t),t>this.x2&&(this.x2=t)),typeof e<"u"&&((isNaN(this.y1)||isNaN(this.y2))&&(this.y1=e,this.y2=e),e<this.y1&&(this.y1=e),e>this.y2&&(this.y2=e))}addX(t){this.addPoint(t,0)}addY(t){this.addPoint(0,t)}addBoundingBox(t){if(!t)return;const{x1:e,y1:i,x2:n,y2:s}=t;this.addPoint(e,i),this.addPoint(n,s)}sumCubic(t,e,i,n,s){return Math.pow(1-t,3)*e+3*Math.pow(1-t,2)*t*i+3*(1-t)*Math.pow(t,2)*n+Math.pow(t,3)*s}bezierCurveAdd(t,e,i,n,s){const a=6*e-12*i+6*n,o=-3*e+9*i-9*n+3*s,l=3*i-3*e;if(o===0){if(a===0)return;const f=-l/a;0<f&&f<1&&(t?this.addX(this.sumCubic(f,e,i,n,s)):this.addY(this.sumCubic(f,e,i,n,s)));return}const c=Math.pow(a,2)-4*l*o;if(c<0)return;const u=(-a+Math.sqrt(c))/(2*o);0<u&&u<1&&(t?this.addX(this.sumCubic(u,e,i,n,s)):this.addY(this.sumCubic(u,e,i,n,s)));const g=(-a-Math.sqrt(c))/(2*o);0<g&&g<1&&(t?this.addX(this.sumCubic(g,e,i,n,s)):this.addY(this.sumCubic(g,e,i,n,s)))}addBezierCurve(t,e,i,n,s,a,o,l){this.addPoint(t,e),this.addPoint(o,l),this.bezierCurveAdd(!0,t,i,s,o),this.bezierCurveAdd(!1,e,n,a,l)}addQuadraticCurve(t,e,i,n,s,a){const o=t+.6666666666666666*(i-t),l=e+2/3*(n-e),c=o+1/3*(s-t),u=l+1/3*(a-e);this.addBezierCurve(t,e,o,c,l,u,s,a)}isPointInBox(t,e){const{x1:i,y1:n,x2:s,y2:a}=this;return i<=t&&t<=s&&n<=e&&e<=a}constructor(t=Number.NaN,e=Number.NaN,i=Number.NaN,n=Number.NaN){this.x1=t,this.y1=e,this.x2=i,this.y2=n,this.addPoint(t,e),this.addPoint(i,n)}}class Vt extends U{calculateOpacity(){let t=1,e=this;for(;e;){const i=e.getStyle("opacity",!1,!0);i.hasValue(!0)&&(t*=i.getNumber()),e=e.parent}return t}setContext(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!e){const i=this.getStyle("fill"),n=this.getStyle("fill-opacity"),s=this.getStyle("stroke"),a=this.getStyle("stroke-opacity");if(i.isUrlDefinition()){const h=i.getFillStyleDefinition(this,n);h&&(t.fillStyle=h)}else if(i.hasValue()){i.getString()==="currentColor"&&i.setValue(this.getStyle("color").getColor());const h=i.getColor();h!=="inherit"&&(t.fillStyle=h==="none"?"rgba(0,0,0,0)":h)}if(n.hasValue()){const h=new T(this.document,"fill",t.fillStyle).addOpacity(n).getColor();t.fillStyle=h}if(s.isUrlDefinition()){const h=s.getFillStyleDefinition(this,a);h&&(t.strokeStyle=h)}else if(s.hasValue()){s.getString()==="currentColor"&&s.setValue(this.getStyle("color").getColor());const h=s.getString();h!=="inherit"&&(t.strokeStyle=h==="none"?"rgba(0,0,0,0)":h)}if(a.hasValue()){const h=new T(this.document,"stroke",t.strokeStyle).addOpacity(a).getString();t.strokeStyle=h}const o=this.getStyle("stroke-width");if(o.hasValue()){const h=o.getPixels();t.lineWidth=h||$t}const l=this.getStyle("stroke-linecap"),c=this.getStyle("stroke-linejoin"),u=this.getStyle("stroke-miterlimit"),g=this.getStyle("stroke-dasharray"),f=this.getStyle("stroke-dashoffset");if(l.hasValue()&&(t.lineCap=l.getString()),c.hasValue()&&(t.lineJoin=c.getString()),u.hasValue()&&(t.miterLimit=u.getNumber()),g.hasValue()&&g.getString()!=="none"){const h=et(g.getString());typeof t.setLineDash<"u"?t.setLineDash(h):typeof t.webkitLineDash<"u"?t.webkitLineDash=h:typeof t.mozDash<"u"&&!(h.length===1&&h[0]===0)&&(t.mozDash=h);const d=f.getPixels();typeof t.lineDashOffset<"u"?t.lineDashOffset=d:typeof t.webkitLineDashOffset<"u"?t.webkitLineDashOffset=d:typeof t.mozDashOffset<"u"&&(t.mozDashOffset=d)}}if(this.modifiedEmSizeStack=!1,typeof t.font<"u"){const i=this.getStyle("font"),n=this.getStyle("font-style"),s=this.getStyle("font-variant"),a=this.getStyle("font-weight"),o=this.getStyle("font-size"),l=this.getStyle("font-family"),c=new G(n.getString(),s.getString(),a.getString(),o.hasValue()?"".concat(o.getPixels(!0),"px"):"",l.getString(),G.parse(i.getString(),t.font));n.setValue(c.fontStyle),s.setValue(c.fontVariant),a.setValue(c.fontWeight),o.setValue(c.fontSize),l.setValue(c.fontFamily),t.font=c.toString(),o.isPixels()&&(this.document.emSize=o.getPixels(),this.modifiedEmSizeStack=!0)}e||(this.applyEffects(t),t.globalAlpha=this.calculateOpacity())}clearContext(t){super.clearContext(t),this.modifiedEmSizeStack&&this.document.popEmSize()}constructor(...t){super(...t),this.modifiedEmSizeStack=!1}}class wt extends Vt{setContext(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;super.setContext(t,e);const i=this.getStyle("dominant-baseline").getTextBaseline()||this.getStyle("alignment-baseline").getTextBaseline();i&&(t.textBaseline=i)}initializeCoordinates(){this.x=0,this.y=0,this.leafTexts=[],this.textChunkStart=0,this.minX=Number.POSITIVE_INFINITY,this.maxX=Number.NEGATIVE_INFINITY}getBoundingBox(t){if(this.type!=="text")return this.getTElementBoundingBox(t);this.initializeCoordinates(),this.adjustChildCoordinatesRecursive(t);let e=null;return this.children.forEach((i,n)=>{const s=this.getChildBoundingBox(t,this,this,n);e?e.addBoundingBox(s):e=s}),e}getFontSize(){const{document:t,parent:e}=this,i=G.parse(t.ctx.font).fontSize;return e.getStyle("font-size").getNumber(i)}getTElementBoundingBox(t){const e=this.getFontSize();return new at(this.x,this.y-e,this.x+this.measureText(t),this.y)}getGlyph(t,e,i){const n=e[i];let s;if(t.isArabic){var a;const o=e.length,l=e[i-1],c=e[i+1];let u="isolated";(i===0||l===" ")&&i<o-1&&c!==" "&&(u="terminal"),i>0&&l!==" "&&i<o-1&&c!==" "&&(u="medial"),i>0&&l!==" "&&(i===o-1||c===" ")&&(u="initial"),s=((a=t.arabicGlyphs[n])===null||a===void 0?void 0:a[u])||t.glyphs[n]}else s=t.glyphs[n];return s||(s=t.missingGlyph),s}getText(){return""}getTextFromNode(t){const e=t||this.node,i=Array.from(e.parentNode.childNodes),n=i.indexOf(e),s=i.length-1;let a=Zt(e.textContent||"");return n===0&&(a=ws(a)),n===s&&(a=Ts(a)),a}renderChildren(t){if(this.type!=="text"){this.renderTElementChildren(t);return}this.initializeCoordinates(),this.adjustChildCoordinatesRecursive(t),this.children.forEach((i,n)=>{this.renderChild(t,this,this,n)});const{mouse:e}=this.document.screen;e.isWorking()&&e.checkBoundingBox(this,this.getBoundingBox(t))}renderTElementChildren(t){const{document:e,parent:i}=this,n=this.getText(),s=i.getStyle("font-family").getDefinition();if(s){const{unitsPerEm:l}=s.fontFace,c=G.parse(e.ctx.font),u=i.getStyle("font-size").getNumber(c.fontSize),g=i.getStyle("font-style").getString(c.fontStyle),f=u/l,h=s.isRTL?n.split("").reverse().join(""):n,d=et(i.getAttribute("dx").getString()),p=h.length;for(let m=0;m<p;m++){const y=this.getGlyph(s,h,m);t.translate(this.x,this.y),t.scale(f,-f);const w=t.lineWidth;t.lineWidth=t.lineWidth*l/u,g==="italic"&&t.transform(1,0,.4,1,0,0),y.render(t),g==="italic"&&t.transform(1,0,-.4,1,0,0),t.lineWidth=w,t.scale(1/f,-1/f),t.translate(-this.x,-this.y),this.x+=u*(y.horizAdvX||s.horizAdvX)/l,typeof d[m]<"u"&&!isNaN(d[m])&&(this.x+=d[m])}return}const{x:a,y:o}=this;t.fillStyle&&t.fillText(n,a,o),t.strokeStyle&&t.strokeText(n,a,o)}applyAnchoring(){if(this.textChunkStart>=this.leafTexts.length)return;const t=this.leafTexts[this.textChunkStart],e=t.getStyle("text-anchor").getString("start"),i=!1;let n=0;e==="start"&&!i||e==="end"&&i?n=t.x-this.minX:e==="end"&&!i||e==="start"&&i?n=t.x-this.maxX:n=t.x-(this.minX+this.maxX)/2;for(let s=this.textChunkStart;s<this.leafTexts.length;s++)this.leafTexts[s].x+=n;this.minX=Number.POSITIVE_INFINITY,this.maxX=Number.NEGATIVE_INFINITY,this.textChunkStart=this.leafTexts.length}adjustChildCoordinatesRecursive(t){this.children.forEach((e,i)=>{this.adjustChildCoordinatesRecursiveCore(t,this,this,i)}),this.applyAnchoring()}adjustChildCoordinatesRecursiveCore(t,e,i,n){const s=i.children[n];s.children.length>0?s.children.forEach((a,o)=>{e.adjustChildCoordinatesRecursiveCore(t,e,s,o)}):this.adjustChildCoordinates(t,e,i,n)}adjustChildCoordinates(t,e,i,n){const s=i.children[n];if(typeof s.measureText!="function")return s;t.save(),s.setContext(t,!0);const a=s.getAttribute("x"),o=s.getAttribute("y"),l=s.getAttribute("dx"),c=s.getAttribute("dy"),u=s.getStyle("font-family").getDefinition(),g=!!(u!=null&&u.isRTL);n===0&&(a.hasValue()||a.setValue(s.getInheritedAttribute("x")),o.hasValue()||o.setValue(s.getInheritedAttribute("y")),l.hasValue()||l.setValue(s.getInheritedAttribute("dx")),c.hasValue()||c.setValue(s.getInheritedAttribute("dy")));const f=s.measureText(t);return g&&(e.x-=f),a.hasValue()?(e.applyAnchoring(),s.x=a.getPixels("x"),l.hasValue()&&(s.x+=l.getPixels("x"))):(l.hasValue()&&(e.x+=l.getPixels("x")),s.x=e.x),e.x=s.x,g||(e.x+=f),o.hasValue()?(s.y=o.getPixels("y"),c.hasValue()&&(s.y+=c.getPixels("y"))):(c.hasValue()&&(e.y+=c.getPixels("y")),s.y=e.y),e.y=s.y,e.leafTexts.push(s),e.minX=Math.min(e.minX,s.x,s.x+f),e.maxX=Math.max(e.maxX,s.x,s.x+f),s.clearContext(t),t.restore(),s}getChildBoundingBox(t,e,i,n){const s=i.children[n];if(typeof s.getBoundingBox!="function")return null;const a=s.getBoundingBox(t);return a&&s.children.forEach((o,l)=>{const c=e.getChildBoundingBox(t,e,s,l);a.addBoundingBox(c)}),a}renderChild(t,e,i,n){const s=i.children[n];s.render(t),s.children.forEach((a,o)=>{e.renderChild(t,e,s,o)})}measureText(t){const{measureCache:e}=this;if(~e)return e;const i=this.getText(),n=this.measureTargetText(t,i);return this.measureCache=n,n}measureTargetText(t,e){if(!e.length)return 0;const{parent:i}=this,n=i.getStyle("font-family").getDefinition();if(n){const a=this.getFontSize(),o=n.isRTL?e.split("").reverse().join(""):e,l=et(i.getAttribute("dx").getString()),c=o.length;let u=0;for(let g=0;g<c;g++){const f=this.getGlyph(n,o,g);u+=(f.horizAdvX||n.horizAdvX)*a/n.fontFace.unitsPerEm,typeof l[g]<"u"&&!isNaN(l[g])&&(u+=l[g])}return u}if(!t.measureText)return e.length*10;t.save(),this.setContext(t,!0);const{width:s}=t.measureText(e);return this.clearContext(t),t.restore(),s}getInheritedAttribute(t){let e=this;for(;e instanceof wt&&e.isFirstChild()&&e.parent;){const i=e.parent.getAttribute(t);if(i.hasValue(!0))return i.getString("0");e=e.parent}return null}constructor(t,e,i){super(t,e,new.target===wt?!0:i),this.type="text",this.x=0,this.y=0,this.leafTexts=[],this.textChunkStart=0,this.minX=Number.POSITIVE_INFINITY,this.maxX=Number.NEGATIVE_INFINITY,this.measureCache=-1}}class Ue extends wt{getText(){return this.text}constructor(t,e,i){super(t,e,new.target===Ue?!0:i),this.type="tspan",this.text=this.children.length>0?"":this.getTextFromNode()}}class qs extends Ue{constructor(...t){super(...t),this.type="textNode"}}class S extends v{reset(){this.i=-1,this.command=null,this.previousCommand=null,this.start=new V(0,0),this.control=new V(0,0),this.current=new V(0,0),this.points=[],this.angles=[]}isEnd(){const{i:t,commands:e}=this;return t>=e.length-1}next(){const t=this.commands[++this.i];return this.previousCommand=this.command,this.command=t,t}getPoint(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"x",e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"y";const i=new V(this.command[t],this.command[e]);return this.makeAbsolute(i)}getAsControlPoint(t,e){const i=this.getPoint(t,e);return this.control=i,i}getAsCurrentPoint(t,e){const i=this.getPoint(t,e);return this.current=i,i}getReflectedControlPoint(){const t=this.previousCommand.type;if(t!==v.CURVE_TO&&t!==v.SMOOTH_CURVE_TO&&t!==v.QUAD_TO&&t!==v.SMOOTH_QUAD_TO)return this.current;const{current:{x:e,y:i},control:{x:n,y:s}}=this;return new V(2*e-n,2*i-s)}makeAbsolute(t){if(this.command.relative){const{x:e,y:i}=this.current;t.x+=e,t.y+=i}return t}addMarker(t,e,i){const{points:n,angles:s}=this;i&&s.length>0&&!s[s.length-1]&&(s[s.length-1]=n[n.length-1].angleTo(i)),this.addMarkerAngle(t,e?e.angleTo(t):null)}addMarkerAngle(t,e){this.points.push(t),this.angles.push(e)}getMarkerPoints(){return this.points}getMarkerAngles(){const{angles:t}=this,e=t.length;for(let i=0;i<e;i++)if(!t[i]){for(let n=i+1;n<e;n++)if(t[n]){t[i]=t[n];break}}return t}constructor(t){super(t.replace(/([+\-.])\s+/gm,"$1").replace(/[^MmZzLlHhVvCcSsQqTtAae\d\s.,+-].*/g,"")),this.control=new V(0,0),this.start=new V(0,0),this.current=new V(0,0),this.command=null,this.commands=this.commands,this.i=-1,this.previousCommand=null,this.points=[],this.angles=[]}}class D extends Vt{path(t){const{pathParser:e}=this,i=new at;for(e.reset(),t&&t.beginPath();!e.isEnd();)switch(e.next().type){case S.MOVE_TO:this.pathM(t,i);break;case S.LINE_TO:this.pathL(t,i);break;case S.HORIZ_LINE_TO:this.pathH(t,i);break;case S.VERT_LINE_TO:this.pathV(t,i);break;case S.CURVE_TO:this.pathC(t,i);break;case S.SMOOTH_CURVE_TO:this.pathS(t,i);break;case S.QUAD_TO:this.pathQ(t,i);break;case S.SMOOTH_QUAD_TO:this.pathT(t,i);break;case S.ARC:this.pathA(t,i);break;case S.CLOSE_PATH:this.pathZ(t,i);break}return i}getBoundingBox(t){return this.path()}getMarkers(){const{pathParser:t}=this,e=t.getMarkerPoints(),i=t.getMarkerAngles();return e.map((s,a)=>[s,i[a]])}renderChildren(t){this.path(t),this.document.screen.mouse.checkPath(this,t);const e=this.getStyle("fill-rule");t.fillStyle!==""&&(e.getString("inherit")!=="inherit"?t.fill(e.getString()):t.fill()),t.strokeStyle!==""&&(this.getAttribute("vector-effect").getString()==="non-scaling-stroke"?(t.save(),t.setTransform(1,0,0,1,0,0),t.stroke(),t.restore()):t.stroke());const i=this.getMarkers();if(i){const n=i.length-1,s=this.getStyle("marker-start"),a=this.getStyle("marker-mid"),o=this.getStyle("marker-end");if(s.isUrlDefinition()){const l=s.getDefinition(),[c,u]=i[0];l.render(t,c,u)}if(a.isUrlDefinition()){const l=a.getDefinition();for(let c=1;c<n;c++){const[u,g]=i[c];l.render(t,u,g)}}if(o.isUrlDefinition()){const l=o.getDefinition(),[c,u]=i[n];l.render(t,c,u)}}}static pathM(t){const e=t.getAsCurrentPoint();return t.start=t.current,{point:e}}pathM(t,e){const{pathParser:i}=this,{point:n}=D.pathM(i),{x:s,y:a}=n;i.addMarker(n),e.addPoint(s,a),t&&t.moveTo(s,a)}static pathL(t){const{current:e}=t,i=t.getAsCurrentPoint();return{current:e,point:i}}pathL(t,e){const{pathParser:i}=this,{current:n,point:s}=D.pathL(i),{x:a,y:o}=s;i.addMarker(s,n),e.addPoint(a,o),t&&t.lineTo(a,o)}static pathH(t){const{current:e,command:i}=t,n=new V((i.relative?e.x:0)+i.x,e.y);return t.current=n,{current:e,point:n}}pathH(t,e){const{pathParser:i}=this,{current:n,point:s}=D.pathH(i),{x:a,y:o}=s;i.addMarker(s,n),e.addPoint(a,o),t&&t.lineTo(a,o)}static pathV(t){const{current:e,command:i}=t,n=new V(e.x,(i.relative?e.y:0)+i.y);return t.current=n,{current:e,point:n}}pathV(t,e){const{pathParser:i}=this,{current:n,point:s}=D.pathV(i),{x:a,y:o}=s;i.addMarker(s,n),e.addPoint(a,o),t&&t.lineTo(a,o)}static pathC(t){const{current:e}=t,i=t.getPoint("x1","y1"),n=t.getAsControlPoint("x2","y2"),s=t.getAsCurrentPoint();return{current:e,point:i,controlPoint:n,currentPoint:s}}pathC(t,e){const{pathParser:i}=this,{current:n,point:s,controlPoint:a,currentPoint:o}=D.pathC(i);i.addMarker(o,a,s),e.addBezierCurve(n.x,n.y,s.x,s.y,a.x,a.y,o.x,o.y),t&&t.bezierCurveTo(s.x,s.y,a.x,a.y,o.x,o.y)}static pathS(t){const{current:e}=t,i=t.getReflectedControlPoint(),n=t.getAsControlPoint("x2","y2"),s=t.getAsCurrentPoint();return{current:e,point:i,controlPoint:n,currentPoint:s}}pathS(t,e){const{pathParser:i}=this,{current:n,point:s,controlPoint:a,currentPoint:o}=D.pathS(i);i.addMarker(o,a,s),e.addBezierCurve(n.x,n.y,s.x,s.y,a.x,a.y,o.x,o.y),t&&t.bezierCurveTo(s.x,s.y,a.x,a.y,o.x,o.y)}static pathQ(t){const{current:e}=t,i=t.getAsControlPoint("x1","y1"),n=t.getAsCurrentPoint();return{current:e,controlPoint:i,currentPoint:n}}pathQ(t,e){const{pathParser:i}=this,{current:n,controlPoint:s,currentPoint:a}=D.pathQ(i);i.addMarker(a,s,s),e.addQuadraticCurve(n.x,n.y,s.x,s.y,a.x,a.y),t&&t.quadraticCurveTo(s.x,s.y,a.x,a.y)}static pathT(t){const{current:e}=t,i=t.getReflectedControlPoint();t.control=i;const n=t.getAsCurrentPoint();return{current:e,controlPoint:i,currentPoint:n}}pathT(t,e){const{pathParser:i}=this,{current:n,controlPoint:s,currentPoint:a}=D.pathT(i);i.addMarker(a,s,s),e.addQuadraticCurve(n.x,n.y,s.x,s.y,a.x,a.y),t&&t.quadraticCurveTo(s.x,s.y,a.x,a.y)}static pathA(t){const{current:e,command:i}=t;let{rX:n,rY:s,xRot:a,lArcFlag:o,sweepFlag:l}=i;const c=a*(Math.PI/180),u=t.getAsCurrentPoint(),g=new V(Math.cos(c)*(e.x-u.x)/2+Math.sin(c)*(e.y-u.y)/2,-Math.sin(c)*(e.x-u.x)/2+Math.cos(c)*(e.y-u.y)/2),f=Math.pow(g.x,2)/Math.pow(n,2)+Math.pow(g.y,2)/Math.pow(s,2);f>1&&(n*=Math.sqrt(f),s*=Math.sqrt(f));let h=(o===l?-1:1)*Math.sqrt((Math.pow(n,2)*Math.pow(s,2)-Math.pow(n,2)*Math.pow(g.y,2)-Math.pow(s,2)*Math.pow(g.x,2))/(Math.pow(n,2)*Math.pow(g.y,2)+Math.pow(s,2)*Math.pow(g.x,2)));isNaN(h)&&(h=0);const d=new V(h*n*g.y/s,h*-s*g.x/n),p=new V((e.x+u.x)/2+Math.cos(c)*d.x-Math.sin(c)*d.y,(e.y+u.y)/2+Math.sin(c)*d.x+Math.cos(c)*d.y),m=ir([1,0],[(g.x-d.x)/n,(g.y-d.y)/s]),y=[(g.x-d.x)/n,(g.y-d.y)/s],w=[(-g.x-d.x)/n,(-g.y-d.y)/s];let b=ir(y,w);return mi(y,w)<=-1&&(b=Math.PI),mi(y,w)>=1&&(b=0),{currentPoint:u,rX:n,rY:s,sweepFlag:l,xAxisRotation:c,centp:p,a1:m,ad:b}}pathA(t,e){const{pathParser:i}=this,{currentPoint:n,rX:s,rY:a,sweepFlag:o,xAxisRotation:l,centp:c,a1:u,ad:g}=D.pathA(i),f=1-o?1:-1,h=u+f*(g/2),d=new V(c.x+s*Math.cos(h),c.y+a*Math.sin(h));if(i.addMarkerAngle(d,h-f*Math.PI/2),i.addMarkerAngle(n,h-f*Math.PI),e.addPoint(n.x,n.y),t&&!isNaN(u)&&!isNaN(g)){const p=s>a?s:a,m=s>a?1:s/a,y=s>a?a/s:1;t.translate(c.x,c.y),t.rotate(l),t.scale(m,y),t.arc(0,0,p,u,u+g,!!(1-o)),t.scale(1/m,1/y),t.rotate(-l),t.translate(-c.x,-c.y)}}static pathZ(t){t.current=t.start}pathZ(t,e){D.pathZ(this.pathParser),t&&e.x1!==e.x2&&e.y1!==e.y2&&t.closePath()}constructor(t,e,i){super(t,e,i),this.type="path",this.pathParser=new S(this.getAttribute("d").getString())}}class ce extends Vt{setContext(t){var e;const{document:i}=this,{screen:n,window:s}=i,a=t.canvas;if(n.setDefaults(t),"style"in a&&typeof t.font<"u"&&s&&typeof s.getComputedStyle<"u"){t.font=s.getComputedStyle(a).getPropertyValue("font");const w=new T(i,"fontSize",G.parse(t.font).fontSize);w.hasValue()&&(i.rootEmSize=w.getPixels("y"),i.emSize=i.rootEmSize)}this.getAttribute("x").hasValue()||this.getAttribute("x",!0).setValue(0),this.getAttribute("y").hasValue()||this.getAttribute("y",!0).setValue(0);let{width:o,height:l}=n.viewPort;this.getStyle("width").hasValue()||this.getStyle("width",!0).setValue("100%"),this.getStyle("height").hasValue()||this.getStyle("height",!0).setValue("100%"),this.getStyle("color").hasValue()||this.getStyle("color",!0).setValue("black");const c=this.getAttribute("refX"),u=this.getAttribute("refY"),g=this.getAttribute("viewBox"),f=g.hasValue()?et(g.getString()):null,h=!this.root&&this.getStyle("overflow").getValue("hidden")!=="visible";let d=0,p=0,m=0,y=0;f&&(d=f[0],p=f[1]),this.root||(o=this.getStyle("width").getPixels("x"),l=this.getStyle("height").getPixels("y"),this.type==="marker"&&(m=d,y=p,d=0,p=0)),n.viewPort.setCurrent(o,l),this.node&&(!this.parent||((e=this.node.parentNode)===null||e===void 0?void 0:e.nodeName)==="foreignObject")&&this.getStyle("transform",!1,!0).hasValue()&&!this.getStyle("transform-origin",!1,!0).hasValue()&&this.getStyle("transform-origin",!0,!0).setValue("50% 50%"),super.setContext(t),t.translate(this.getAttribute("x").getPixels("x"),this.getAttribute("y").getPixels("y")),f&&(o=f[2],l=f[3]),i.setViewBox({ctx:t,aspectRatio:this.getAttribute("preserveAspectRatio").getString(),width:n.viewPort.width,desiredWidth:o,height:n.viewPort.height,desiredHeight:l,minX:d,minY:p,refX:c.getValue(),refY:u.getValue(),clip:h,clipX:m,clipY:y}),f&&(n.viewPort.removeCurrent(),n.viewPort.setCurrent(o,l))}clearContext(t){super.clearContext(t),this.document.screen.viewPort.removeCurrent()}resize(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const n=this.getAttribute("width",!0),s=this.getAttribute("height",!0),a=this.getAttribute("viewBox"),o=this.getAttribute("style"),l=n.getNumber(0),c=s.getNumber(0);if(i)if(typeof i=="string")this.getAttribute("preserveAspectRatio",!0).setValue(i);else{const u=this.getAttribute("preserveAspectRatio");u.hasValue()&&u.setValue(u.getString().replace(/^\s*(\S.*\S)\s*$/,"$1"))}if(n.setValue(t),s.setValue(e),a.hasValue()||a.setValue("0 0 ".concat(l||t," ").concat(c||e)),o.hasValue()){const u=this.getStyle("width"),g=this.getStyle("height");u.hasValue()&&u.setValue("".concat(t,"px")),g.hasValue()&&g.setValue("".concat(e,"px"))}}constructor(...t){super(...t),this.type="svg",this.root=!1}}class $r extends D{path(t){const e=this.getAttribute("x").getPixels("x"),i=this.getAttribute("y").getPixels("y"),n=this.getStyle("width",!1,!0).getPixels("x"),s=this.getStyle("height",!1,!0).getPixels("y"),a=this.getAttribute("rx"),o=this.getAttribute("ry");let l=a.getPixels("x"),c=o.getPixels("y");if(a.hasValue()&&!o.hasValue()&&(c=l),o.hasValue()&&!a.hasValue()&&(l=c),l=Math.min(l,n/2),c=Math.min(c,s/2),t){const u=4*((Math.sqrt(2)-1)/3);t.beginPath(),s>0&&n>0&&(t.moveTo(e+l,i),t.lineTo(e+n-l,i),t.bezierCurveTo(e+n-l+u*l,i,e+n,i+c-u*c,e+n,i+c),t.lineTo(e+n,i+s-c),t.bezierCurveTo(e+n,i+s-c+u*c,e+n-l+u*l,i+s,e+n-l,i+s),t.lineTo(e+l,i+s),t.bezierCurveTo(e+l-u*l,i+s,e,i+s-c+u*c,e,i+s-c),t.lineTo(e,i+c),t.bezierCurveTo(e,i+c-u*c,e+l-u*l,i,e+l,i),t.closePath())}return new at(e,i,e+n,i+s)}getMarkers(){return null}constructor(...t){super(...t),this.type="rect"}}class Zs extends D{path(t){const e=this.getAttribute("cx").getPixels("x"),i=this.getAttribute("cy").getPixels("y"),n=this.getAttribute("r").getPixels();return t&&n>0&&(t.beginPath(),t.arc(e,i,n,0,Math.PI*2,!1),t.closePath()),new at(e-n,i-n,e+n,i+n)}getMarkers(){return null}constructor(...t){super(...t),this.type="circle"}}class Ks extends D{path(t){const e=4*((Math.sqrt(2)-1)/3),i=this.getAttribute("rx").getPixels("x"),n=this.getAttribute("ry").getPixels("y"),s=this.getAttribute("cx").getPixels("x"),a=this.getAttribute("cy").getPixels("y");return t&&i>0&&n>0&&(t.beginPath(),t.moveTo(s+i,a),t.bezierCurveTo(s+i,a+e*n,s+e*i,a+n,s,a+n),t.bezierCurveTo(s-e*i,a+n,s-i,a+e*n,s-i,a),t.bezierCurveTo(s-i,a-e*n,s-e*i,a-n,s,a-n),t.bezierCurveTo(s+e*i,a-n,s+i,a-e*n,s+i,a),t.closePath()),new at(s-i,a-n,s+i,a+n)}getMarkers(){return null}constructor(...t){super(...t),this.type="ellipse"}}class Js extends D{getPoints(){return[new V(this.getAttribute("x1").getPixels("x"),this.getAttribute("y1").getPixels("y")),new V(this.getAttribute("x2").getPixels("x"),this.getAttribute("y2").getPixels("y"))]}path(t){const[{x:e,y:i},{x:n,y:s}]=this.getPoints();return t&&(t.beginPath(),t.moveTo(e,i),t.lineTo(n,s)),new at(e,i,n,s)}getMarkers(){const[t,e]=this.getPoints(),i=t.angleTo(e);return[[t,i],[e,i]]}constructor(...t){super(...t),this.type="line"}}class Wr extends D{path(t){const{points:e}=this,[{x:i,y:n}]=e,s=new at(i,n);return t&&(t.beginPath(),t.moveTo(i,n)),e.forEach(a=>{let{x:o,y:l}=a;s.addPoint(o,l),t&&t.lineTo(o,l)}),s}getMarkers(){const{points:t}=this,e=t.length-1,i=[];return t.forEach((n,s)=>{s!==e&&i.push([n,n.angleTo(t[s+1])])}),i.length>0&&i.push([t[t.length-1],i[i.length-1][1]]),i}constructor(t,e,i){super(t,e,i),this.type="polyline",this.points=[],this.points=V.parsePath(this.getAttribute("points").getString())}}class to extends Wr{path(t){const e=super.path(t),[{x:i,y:n}]=this.points;return t&&(t.lineTo(i,n),t.closePath()),e}constructor(...t){super(...t),this.type="polygon"}}class eo extends U{createPattern(t,e,i){const n=this.getStyle("width").getPixels("x",!0),s=this.getStyle("height").getPixels("y",!0),a=new ce(this.document,null);a.attributes.viewBox=new T(this.document,"viewBox",this.getAttribute("viewBox").getValue()),a.attributes.width=new T(this.document,"width","".concat(n,"px")),a.attributes.height=new T(this.document,"height","".concat(s,"px")),a.attributes.transform=new T(this.document,"transform",this.getAttribute("patternTransform").getValue()),a.children=this.children;const o=this.document.createCanvas(n,s),l=o.getContext("2d"),c=this.getAttribute("x"),u=this.getAttribute("y");c.hasValue()&&u.hasValue()&&l.translate(c.getPixels("x",!0),u.getPixels("y",!0)),i.hasValue()?this.styles["fill-opacity"]=i:Reflect.deleteProperty(this.styles,"fill-opacity");for(let f=-1;f<=1;f++)for(let h=-1;h<=1;h++)l.save(),a.attributes.x=new T(this.document,"x",f*o.width),a.attributes.y=new T(this.document,"y",h*o.height),a.render(l),l.restore();return t.createPattern(o,"repeat")}constructor(...t){super(...t),this.type="pattern"}}class io extends U{render(t,e,i){if(!e)return;const{x:n,y:s}=e,a=this.getAttribute("orient").getString("auto"),o=this.getAttribute("markerUnits").getString("strokeWidth");t.translate(n,s),a==="auto"&&t.rotate(i),o==="strokeWidth"&&t.scale(t.lineWidth,t.lineWidth),t.save();const l=new ce(this.document);l.type=this.type,l.attributes.viewBox=new T(this.document,"viewBox",this.getAttribute("viewBox").getValue()),l.attributes.refX=new T(this.document,"refX",this.getAttribute("refX").getValue()),l.attributes.refY=new T(this.document,"refY",this.getAttribute("refY").getValue()),l.attributes.width=new T(this.document,"width",this.getAttribute("markerWidth").getValue()),l.attributes.height=new T(this.document,"height",this.getAttribute("markerHeight").getValue()),l.attributes.overflow=new T(this.document,"overflow",this.getAttribute("overflow").getValue()),l.attributes.fill=new T(this.document,"fill",this.getAttribute("fill").getColor("black")),l.attributes.stroke=new T(this.document,"stroke",this.getAttribute("stroke").getValue("none")),l.children=this.children,l.render(t),t.restore(),o==="strokeWidth"&&t.scale(1/t.lineWidth,1/t.lineWidth),a==="auto"&&t.rotate(-i),t.translate(-n,-s)}constructor(...t){super(...t),this.type="marker"}}class ro extends U{render(){}constructor(...t){super(...t),this.type="defs"}}class wi extends Vt{getBoundingBox(t){const e=new at;return this.children.forEach(i=>{e.addBoundingBox(i.getBoundingBox(t))}),e}constructor(...t){super(...t),this.type="g"}}class Qr extends U{getGradientUnits(){return this.getAttribute("gradientUnits").getString("objectBoundingBox")}createGradient(t,e,i){let n=this;this.getHrefAttribute().hasValue()&&(n=this.getHrefAttribute().getDefinition(),this.inheritStopContainer(n));const{stops:s}=n,a=this.getGradient(t,e);if(!a)return this.addParentOpacity(i,s[s.length-1].color);if(s.forEach(o=>{a.addColorStop(o.offset,this.addParentOpacity(i,o.color))}),this.getAttribute("gradientTransform").hasValue()){const{document:o}=this,{MAX_VIRTUAL_PIXELS:l}=pt,{viewPort:c}=o.screen,u=c.getRoot(),g=new $r(o);g.attributes.x=new T(o,"x",-l/3),g.attributes.y=new T(o,"y",-l/3),g.attributes.width=new T(o,"width",l),g.attributes.height=new T(o,"height",l);const f=new wi(o);f.attributes.transform=new T(o,"transform",this.getAttribute("gradientTransform").getValue()),f.children=[g];const h=new ce(o);h.attributes.x=new T(o,"x",0),h.attributes.y=new T(o,"y",0),h.attributes.width=new T(o,"width",u.width),h.attributes.height=new T(o,"height",u.height),h.children=[f];const d=o.createCanvas(u.width,u.height),p=d.getContext("2d");return p.fillStyle=a,h.render(p),p.createPattern(d,"no-repeat")}return a}inheritStopContainer(t){this.attributesToInherit.forEach(e=>{!this.getAttribute(e).hasValue()&&t.getAttribute(e).hasValue()&&this.getAttribute(e,!0).setValue(t.getAttribute(e).getValue())})}addParentOpacity(t,e){return t.hasValue()?new T(this.document,"color",e).addOpacity(t).getColor():e}constructor(t,e,i){super(t,e,i),this.attributesToInherit=["gradientUnits"],this.stops=[];const{stops:n,children:s}=this;s.forEach(a=>{a.type==="stop"&&n.push(a)})}}class no extends Qr{getGradient(t,e){const i=this.getGradientUnits()==="objectBoundingBox",n=i?e.getBoundingBox(t):null;if(i&&!n)return null;!this.getAttribute("x1").hasValue()&&!this.getAttribute("y1").hasValue()&&!this.getAttribute("x2").hasValue()&&!this.getAttribute("y2").hasValue()&&(this.getAttribute("x1",!0).setValue(0),this.getAttribute("y1",!0).setValue(0),this.getAttribute("x2",!0).setValue(1),this.getAttribute("y2",!0).setValue(0));const s=i?n.x+n.width*this.getAttribute("x1").getNumber():this.getAttribute("x1").getPixels("x"),a=i?n.y+n.height*this.getAttribute("y1").getNumber():this.getAttribute("y1").getPixels("y"),o=i?n.x+n.width*this.getAttribute("x2").getNumber():this.getAttribute("x2").getPixels("x"),l=i?n.y+n.height*this.getAttribute("y2").getNumber():this.getAttribute("y2").getPixels("y");return s===o&&a===l?null:t.createLinearGradient(s,a,o,l)}constructor(t,e,i){super(t,e,i),this.type="linearGradient",this.attributesToInherit.push("x1","y1","x2","y2")}}class so extends Qr{getGradient(t,e){const i=this.getGradientUnits()==="objectBoundingBox",n=e.getBoundingBox(t);if(i&&!n)return null;this.getAttribute("cx").hasValue()||this.getAttribute("cx",!0).setValue("50%"),this.getAttribute("cy").hasValue()||this.getAttribute("cy",!0).setValue("50%"),this.getAttribute("r").hasValue()||this.getAttribute("r",!0).setValue("50%");const s=i?n.x+n.width*this.getAttribute("cx").getNumber():this.getAttribute("cx").getPixels("x"),a=i?n.y+n.height*this.getAttribute("cy").getNumber():this.getAttribute("cy").getPixels("y");let o=s,l=a;this.getAttribute("fx").hasValue()&&(o=i?n.x+n.width*this.getAttribute("fx").getNumber():this.getAttribute("fx").getPixels("x")),this.getAttribute("fy").hasValue()&&(l=i?n.y+n.height*this.getAttribute("fy").getNumber():this.getAttribute("fy").getPixels("y"));const c=i?(n.width+n.height)/2*this.getAttribute("r").getNumber():this.getAttribute("r").getPixels(),u=this.getAttribute("fr").getPixels();return t.createRadialGradient(o,l,u,s,a,c)}constructor(t,e,i){super(t,e,i),this.type="radialGradient",this.attributesToInherit.push("cx","cy","r","fx","fy","fr")}}class oo extends U{constructor(t,e,i){super(t,e,i),this.type="stop";const n=Math.max(0,Math.min(1,this.getAttribute("offset").getNumber())),s=this.getStyle("stop-opacity");let a=this.getStyle("stop-color",!0);a.getString()===""&&a.setValue("#000"),s.hasValue()&&(a=a.addOpacity(s)),this.offset=n,this.color=a.getColor()}}class Ti extends U{getProperty(){const t=this.getAttribute("attributeType").getString(),e=this.getAttribute("attributeName").getString();return t==="CSS"?this.parent.getStyle(e,!0):this.parent.getAttribute(e,!0)}calcValue(){const{initialUnits:t}=this,{progress:e,from:i,to:n}=this.getProgress();let s=i.getNumber()+(n.getNumber()-i.getNumber())*e;return t==="%"&&(s*=100),"".concat(s).concat(t)}update(t){const{parent:e}=this,i=this.getProperty();if(this.initialValue||(this.initialValue=i.getString(),this.initialUnits=i.getUnits()),this.duration>this.maxDuration){const s=this.getAttribute("fill").getString("remove");if(this.getAttribute("repeatCount").getString()==="indefinite"||this.getAttribute("repeatDur").getString()==="indefinite")this.duration=0;else if(s==="freeze"&&!this.frozen)this.frozen=!0,e&&i&&(e.animationFrozen=!0,e.animationFrozenValue=i.getString());else if(s==="remove"&&!this.removed)return this.removed=!0,e&&i&&i.setValue(e.animationFrozen?e.animationFrozenValue:this.initialValue),!0;return!1}this.duration+=t;let n=!1;if(this.begin<this.duration){let s=this.calcValue();const a=this.getAttribute("type");if(a.hasValue()){const o=a.getString();s="".concat(o,"(").concat(s,")")}i.setValue(s),n=!0}return n}getProgress(){const{document:t,values:e}=this;let i=(this.duration-this.begin)/(this.maxDuration-this.begin),n,s;if(e.hasValue()){const a=i*(e.getValue().length-1),o=Math.floor(a),l=Math.ceil(a);let c;c=e.getValue()[o],n=new T(t,"from",c?parseFloat(c):0),c=e.getValue()[l],s=new T(t,"to",c?parseFloat(c):0),i=(a-o)/(l-o)}else n=this.from,s=this.to;return{progress:i,from:n,to:s}}constructor(t,e,i){super(t,e,i),this.type="animate",this.duration=0,this.initialUnits="",this.removed=!1,this.frozen=!1,t.screen.animations.push(this),this.begin=this.getAttribute("begin").getMilliseconds(),this.maxDuration=this.begin+this.getAttribute("dur").getMilliseconds(),this.from=this.getAttribute("from"),this.to=this.getAttribute("to"),this.values=new T(t,"values",null);const n=this.getAttribute("values");n.hasValue()&&this.values.setValue(n.getString().split(";"))}}class ao extends Ti{calcValue(){const{progress:t,from:e,to:i}=this.getProgress(),n=new di(e.getColor()),s=new di(i.getColor());if(n.ok&&s.ok){const a=n.r+(s.r-n.r)*t,o=n.g+(s.g-n.g)*t,l=n.b+(s.b-n.b)*t;return"rgb(".concat(Math.floor(a),", ").concat(Math.floor(o),", ").concat(Math.floor(l),")")}return this.getAttribute("from").getColor()}constructor(...t){super(...t),this.type="animateColor"}}class lo extends Ti{calcValue(){const{progress:t,from:e,to:i}=this.getProgress(),n=et(e.getString()),s=et(i.getString());return n.map((o,l)=>{const c=s[l];return o+(c-o)*t}).join(" ")}constructor(...t){super(...t),this.type="animateTransform"}}class Gr extends U{constructor(t,e,i){super(t,e,i),this.type="font-face",this.ascent=this.getAttribute("ascent").getNumber(),this.descent=this.getAttribute("descent").getNumber(),this.unitsPerEm=this.getAttribute("units-per-em").getNumber()}}class Ei extends D{constructor(t,e,i){super(t,e,i),this.type="glyph",this.horizAdvX=this.getAttribute("horiz-adv-x").getNumber(),this.unicode=this.getAttribute("unicode").getString(),this.arabicForm=this.getAttribute("arabic-form").getString()}}class qr extends Ei{constructor(...t){super(...t),this.type="missing-glyph",this.horizAdvX=0}}class co extends U{render(){}constructor(t,e,i){super(t,e,i),this.type="font",this.isArabic=!1,this.glyphs={},this.arabicGlyphs={},this.isRTL=!1,this.horizAdvX=this.getAttribute("horiz-adv-x").getNumber();const{definitions:n}=t,{children:s}=this;for(const a of s)if(a instanceof Gr){this.fontFace=a;const o=a.getStyle("font-family");o.hasValue()&&(n[o.getString()]=this)}else if(a instanceof qr)this.missingGlyph=a;else if(a instanceof Ei)if(a.arabicForm){this.isRTL=!0,this.isArabic=!0;const o=this.arabicGlyphs[a.unicode];typeof o>"u"?this.arabicGlyphs[a.unicode]={[a.arabicForm]:a}:o[a.arabicForm]=a}else this.glyphs[a.unicode]=a}}class uo extends wt{getText(){const t=this.getHrefAttribute().getDefinition();if(t){const e=t.children[0];if(e)return e.getText()}return""}constructor(...t){super(...t),this.type="tref"}}class ho extends wt{getText(){return this.text}renderChildren(t){if(this.hasText){super.renderChildren(t);const{document:e,x:i,y:n}=this,{mouse:s}=e.screen,a=new T(e,"fontSize",G.parse(e.ctx.font).fontSize);s.isWorking()&&s.checkBoundingBox(this,new at(i,n-a.getPixels("y"),i+this.measureText(t),n))}else if(this.children.length>0){const e=new wi(this.document);e.children=this.children,e.parent=this,e.render(t)}}onClick(){const{window:t}=this.document;t&&t.open(this.getHrefAttribute().getString())}onMouseMove(){const t=this.document.ctx;t.canvas.style.cursor="pointer"}constructor(t,e,i){super(t,e,i),this.type="a";const{childNodes:n}=e,s=n[0],a=n.length>0&&Array.from(n).every(o=>o.nodeType===3);this.hasText=a,this.text=a?this.getTextFromNode(s):""}}class fo extends wt{getText(){return this.text}path(t){const{dataArray:e}=this;t&&t.beginPath(),e.forEach(i=>{let{type:n,points:s}=i;switch(n){case S.LINE_TO:t&&t.lineTo(s[0],s[1]);break;case S.MOVE_TO:t&&t.moveTo(s[0],s[1]);break;case S.CURVE_TO:t&&t.bezierCurveTo(s[0],s[1],s[2],s[3],s[4],s[5]);break;case S.QUAD_TO:t&&t.quadraticCurveTo(s[0],s[1],s[2],s[3]);break;case S.ARC:{const[a,o,l,c,u,g,f,h]=s,d=l>c?l:c,p=l>c?1:l/c,m=l>c?c/l:1;t&&(t.translate(a,o),t.rotate(f),t.scale(p,m),t.arc(0,0,d,u,u+g,!!(1-h)),t.scale(1/p,1/m),t.rotate(-f),t.translate(-a,-o));break}case S.CLOSE_PATH:t&&t.closePath();break}})}renderChildren(t){this.setTextData(t),t.save();const e=this.parent.getStyle("text-decoration").getString(),i=this.getFontSize(),{glyphInfo:n}=this,s=t.fillStyle;e==="underline"&&t.beginPath(),n.forEach((a,o)=>{const{p0:l,p1:c,rotation:u,text:g}=a;t.save(),t.translate(l.x,l.y),t.rotate(u),t.fillStyle&&t.fillText(g,0,0),t.strokeStyle&&t.strokeText(g,0,0),t.restore(),e==="underline"&&(o===0&&t.moveTo(l.x,l.y+i/8),t.lineTo(c.x,c.y+i/5))}),e==="underline"&&(t.lineWidth=i/20,t.strokeStyle=s,t.stroke(),t.closePath()),t.restore()}getLetterSpacingAt(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.letterSpacingCache[t]||0}findSegmentToFitChar(t,e,i,n,s,a,o,l,c){let u=a,g=this.measureText(t,l);l===" "&&e==="justify"&&i<n&&(g+=(n-i)/s),c>-1&&(u+=this.getLetterSpacingAt(c));const f=this.textHeight/20,h=this.getEquidistantPointOnPath(u,f,0),d=this.getEquidistantPointOnPath(u+g,f,0),p={p0:h,p1:d},m=h&&d?Math.atan2(d.y-h.y,d.x-h.x):0;if(o){const y=Math.cos(Math.PI/2+m)*o,w=Math.cos(-m)*o;p.p0={...h,x:h.x+y,y:h.y+w},p.p1={...d,x:d.x+y,y:d.y+w}}return u+=g,{offset:u,segment:p,rotation:m}}measureText(t,e){const{measuresCache:i}=this,n=e||this.getText();if(i.has(n))return i.get(n);const s=this.measureTargetText(t,n);return i.set(n,s),s}setTextData(t){if(this.glyphInfo)return;const e=this.getText(),i=e.split(""),n=e.split(" ").length-1,s=this.parent.getAttribute("dx").split().map(b=>b.getPixels("x")),a=this.parent.getAttribute("dy").getPixels("y"),o=this.parent.getStyle("text-anchor").getString("start"),l=this.getStyle("letter-spacing"),c=this.parent.getStyle("letter-spacing");let u=0;!l.hasValue()||l.getValue()==="inherit"?u=c.getPixels():l.hasValue()&&l.getValue()!=="initial"&&l.getValue()!=="unset"&&(u=l.getPixels());const g=[],f=e.length;this.letterSpacingCache=g;for(let b=0;b<f;b++)g.push(typeof s[b]<"u"?s[b]:u);const h=g.reduce((b,x,M)=>M===0?0:b+x||0,0),d=this.measureText(t),p=Math.max(d+h,0);this.textWidth=d,this.textHeight=this.getFontSize(),this.glyphInfo=[];const m=this.getPathLength(),y=this.getStyle("startOffset").getNumber(0)*m;let w=0;(o==="middle"||o==="center")&&(w=-p/2),(o==="end"||o==="right")&&(w=-p),w+=y,i.forEach((b,x)=>{const{offset:M,segment:A,rotation:E}=this.findSegmentToFitChar(t,o,p,m,n,w,a,b,x);w=M,!(!A.p0||!A.p1)&&this.glyphInfo.push({text:i[x],p0:A.p0,p1:A.p1,rotation:E})})}parsePathData(t){if(this.pathLength=-1,!t)return[];const e=[],{pathParser:i}=t;for(i.reset();!i.isEnd();){const{current:n}=i,s=n?n.x:0,a=n?n.y:0,o=i.next();let l=o.type,c=[];switch(o.type){case S.MOVE_TO:this.pathM(i,c);break;case S.LINE_TO:l=this.pathL(i,c);break;case S.HORIZ_LINE_TO:l=this.pathH(i,c);break;case S.VERT_LINE_TO:l=this.pathV(i,c);break;case S.CURVE_TO:this.pathC(i,c);break;case S.SMOOTH_CURVE_TO:l=this.pathS(i,c);break;case S.QUAD_TO:this.pathQ(i,c);break;case S.SMOOTH_QUAD_TO:l=this.pathT(i,c);break;case S.ARC:c=this.pathA(i);break;case S.CLOSE_PATH:D.pathZ(i);break}o.type!==S.CLOSE_PATH?e.push({type:l,points:c,start:{x:s,y:a},pathLength:this.calcLength(s,a,l,c)}):e.push({type:S.CLOSE_PATH,points:[],pathLength:0})}return e}pathM(t,e){const{x:i,y:n}=D.pathM(t).point;e.push(i,n)}pathL(t,e){const{x:i,y:n}=D.pathL(t).point;return e.push(i,n),S.LINE_TO}pathH(t,e){const{x:i,y:n}=D.pathH(t).point;return e.push(i,n),S.LINE_TO}pathV(t,e){const{x:i,y:n}=D.pathV(t).point;return e.push(i,n),S.LINE_TO}pathC(t,e){const{point:i,controlPoint:n,currentPoint:s}=D.pathC(t);e.push(i.x,i.y,n.x,n.y,s.x,s.y)}pathS(t,e){const{point:i,controlPoint:n,currentPoint:s}=D.pathS(t);return e.push(i.x,i.y,n.x,n.y,s.x,s.y),S.CURVE_TO}pathQ(t,e){const{controlPoint:i,currentPoint:n}=D.pathQ(t);e.push(i.x,i.y,n.x,n.y)}pathT(t,e){const{controlPoint:i,currentPoint:n}=D.pathT(t);return e.push(i.x,i.y,n.x,n.y),S.QUAD_TO}pathA(t){let{rX:e,rY:i,sweepFlag:n,xAxisRotation:s,centp:a,a1:o,ad:l}=D.pathA(t);return n===0&&l>0&&(l-=2*Math.PI),n===1&&l<0&&(l+=2*Math.PI),[a.x,a.y,e,i,o,l,s,n]}calcLength(t,e,i,n){let s=0,a=null,o=null,l=0;switch(i){case S.LINE_TO:return this.getLineLength(t,e,n[0],n[1]);case S.CURVE_TO:for(s=0,a=this.getPointOnCubicBezier(0,t,e,n[0],n[1],n[2],n[3],n[4],n[5]),l=.01;l<=1;l+=.01)o=this.getPointOnCubicBezier(l,t,e,n[0],n[1],n[2],n[3],n[4],n[5]),s+=this.getLineLength(a.x,a.y,o.x,o.y),a=o;return s;case S.QUAD_TO:for(s=0,a=this.getPointOnQuadraticBezier(0,t,e,n[0],n[1],n[2],n[3]),l=.01;l<=1;l+=.01)o=this.getPointOnQuadraticBezier(l,t,e,n[0],n[1],n[2],n[3]),s+=this.getLineLength(a.x,a.y,o.x,o.y),a=o;return s;case S.ARC:{s=0;const c=n[4],u=n[5],g=n[4]+u;let f=Math.PI/180;if(Math.abs(c-g)<f&&(f=Math.abs(c-g)),a=this.getPointOnEllipticalArc(n[0],n[1],n[2],n[3],c,0),u<0)for(l=c-f;l>g;l-=f)o=this.getPointOnEllipticalArc(n[0],n[1],n[2],n[3],l,0),s+=this.getLineLength(a.x,a.y,o.x,o.y),a=o;else for(l=c+f;l<g;l+=f)o=this.getPointOnEllipticalArc(n[0],n[1],n[2],n[3],l,0),s+=this.getLineLength(a.x,a.y,o.x,o.y),a=o;return o=this.getPointOnEllipticalArc(n[0],n[1],n[2],n[3],g,0),s+=this.getLineLength(a.x,a.y,o.x,o.y),s}}return 0}getPointOnLine(t,e,i,n,s){let a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:e,o=arguments.length>6&&arguments[6]!==void 0?arguments[6]:i;const l=(s-i)/(n-e+$t);let c=Math.sqrt(t*t/(1+l*l));n<e&&(c*=-1);let u=l*c,g=null;if(n===e)g={x:a,y:o+u};else if((o-i)/(a-e+$t)===l)g={x:a+c,y:o+u};else{let f=0,h=0;const d=this.getLineLength(e,i,n,s);if(d<$t)return null;let p=(a-e)*(n-e)+(o-i)*(s-i);p/=d*d,f=e+p*(n-e),h=i+p*(s-i);const m=this.getLineLength(a,o,f,h),y=Math.sqrt(t*t-m*m);c=Math.sqrt(y*y/(1+l*l)),n<e&&(c*=-1),u=l*c,g={x:f+c,y:h+u}}return g}getPointOnPath(t){const e=this.getPathLength();let i=0,n=null;if(t<-5e-5||t-5e-5>e)return null;const{dataArray:s}=this;for(const a of s){if(a&&(a.pathLength<5e-5||i+a.pathLength+5e-5<t)){i+=a.pathLength;continue}const o=t-i;let l=0;switch(a.type){case S.LINE_TO:n=this.getPointOnLine(o,a.start.x,a.start.y,a.points[0],a.points[1],a.start.x,a.start.y);break;case S.ARC:{const c=a.points[4],u=a.points[5],g=a.points[4]+u;if(l=c+o/a.pathLength*u,u<0&&l<g||u>=0&&l>g)break;n=this.getPointOnEllipticalArc(a.points[0],a.points[1],a.points[2],a.points[3],l,a.points[6]);break}case S.CURVE_TO:l=o/a.pathLength,l>1&&(l=1),n=this.getPointOnCubicBezier(l,a.start.x,a.start.y,a.points[0],a.points[1],a.points[2],a.points[3],a.points[4],a.points[5]);break;case S.QUAD_TO:l=o/a.pathLength,l>1&&(l=1),n=this.getPointOnQuadraticBezier(l,a.start.x,a.start.y,a.points[0],a.points[1],a.points[2],a.points[3]);break}if(n)return n;break}return null}getLineLength(t,e,i,n){return Math.sqrt((i-t)*(i-t)+(n-e)*(n-e))}getPathLength(){return this.pathLength===-1&&(this.pathLength=this.dataArray.reduce((t,e)=>e.pathLength>0?t+e.pathLength:t,0)),this.pathLength}getPointOnCubicBezier(t,e,i,n,s,a,o,l,c){const u=l*rr(t)+a*nr(t)+n*sr(t)+e*or(t),g=c*rr(t)+o*nr(t)+s*sr(t)+i*or(t);return{x:u,y:g}}getPointOnQuadraticBezier(t,e,i,n,s,a,o){const l=a*ar(t)+n*lr(t)+e*cr(t),c=o*ar(t)+s*lr(t)+i*cr(t);return{x:l,y:c}}getPointOnEllipticalArc(t,e,i,n,s,a){const o=Math.cos(a),l=Math.sin(a),c={x:i*Math.cos(s),y:n*Math.sin(s)};return{x:t+(c.x*o-c.y*l),y:e+(c.x*l+c.y*o)}}buildEquidistantCache(t,e){const i=this.getPathLength(),n=e||.25,s=t||i/100;if(!this.equidistantCache||this.equidistantCache.step!==s||this.equidistantCache.precision!==n){this.equidistantCache={step:s,precision:n,points:[]};let a=0;for(let o=0;o<=i;o+=n){const l=this.getPointOnPath(o),c=this.getPointOnPath(o+n);!l||!c||(a+=this.getLineLength(l.x,l.y,c.x,c.y),a>=s&&(this.equidistantCache.points.push({x:l.x,y:l.y,distance:o}),a-=s))}}}getEquidistantPointOnPath(t,e,i){if(this.buildEquidistantCache(e,i),t<0||t-this.getPathLength()>5e-5)return null;const n=Math.round(t/this.getPathLength()*(this.equidistantCache.points.length-1));return this.equidistantCache.points[n]||null}constructor(t,e,i){super(t,e,i),this.type="textPath",this.textWidth=0,this.textHeight=0,this.pathLength=-1,this.glyphInfo=null,this.letterSpacingCache=[],this.measuresCache=new Map([["",0]]);const n=this.getHrefAttribute().getDefinition();this.text=this.getTextFromNode(),this.dataArray=this.parsePathData(n)}}const go=/^\s*data:(([^/,;]+\/[^/,;]+)(?:;([^,;=]+=[^,;=]+))?)?(?:;(base64))?,(.*)$/i;class po extends Vt{async loadImage(t){try{const e=await this.document.createImage(t);this.image=e}catch(e){console.error('Error while loading image "'.concat(t,'":'),e)}this.loaded=!0}async loadSvg(t){const e=go.exec(t);if(e){const i=e[5];i&&(e[4]==="base64"?this.image=atob(i):this.image=decodeURIComponent(i))}else try{const n=await(await this.document.fetch(t)).text();this.image=n}catch(i){console.error('Error while loading image "'.concat(t,'":'),i)}this.loaded=!0}renderChildren(t){const{document:e,image:i,loaded:n}=this,s=this.getAttribute("x").getPixels("x"),a=this.getAttribute("y").getPixels("y"),o=this.getStyle("width").getPixels("x"),l=this.getStyle("height").getPixels("y");if(!(!n||!i||!o||!l)){if(t.save(),t.translate(s,a),typeof i=="string"){const c=e.canvg.forkString(t,i,{ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0,ignoreClear:!0,offsetX:0,offsetY:0,scaleWidth:o,scaleHeight:l}),{documentElement:u}=c.document;u&&(u.parent=this),c.render()}else e.setViewBox({ctx:t,aspectRatio:this.getAttribute("preserveAspectRatio").getString(),width:o,desiredWidth:i.width,height:l,desiredHeight:i.height}),this.loaded&&(!("complete"in i)||i.complete)&&t.drawImage(i,0,0);t.restore()}}getBoundingBox(){const t=this.getAttribute("x").getPixels("x"),e=this.getAttribute("y").getPixels("y"),i=this.getStyle("width").getPixels("x"),n=this.getStyle("height").getPixels("y");return new at(t,e,t+i,e+n)}constructor(t,e,i){super(t,e,i),this.type="image",this.loaded=!1;const n=this.getHrefAttribute().getString();if(!n)return;const s=n.endsWith(".svg")||/^\s*data:image\/svg\+xml/i.test(n);t.images.push(this),s?this.loadSvg(n):this.loadImage(n)}}class mo extends Vt{render(t){}constructor(...t){super(...t),this.type="symbol"}}class yo{async load(t,e){try{const{document:i}=this,s=(await i.canvg.parser.load(e)).getElementsByTagName("font");Array.from(s).forEach(a=>{const o=i.createElement(a);i.definitions[t]=o})}catch(i){console.error('Error while loading font "'.concat(e,'":'),i)}this.loaded=!0}constructor(t){this.document=t,this.loaded=!1,t.fonts.push(this)}}class Zr extends U{constructor(t,e,i){super(t,e,i),this.type="style",Zt(Array.from(e.childNodes).map(a=>a.textContent).join("").replace(/(\/\*([^*]|[\r\n]|(\*+([^*/]|[\r\n])))*\*+\/)|(^[\s]*\/\/.*)/gm,"").replace(/@import.*;/g,"")).split("}").forEach(a=>{const o=a.trim();if(!o)return;const l=o.split("{"),c=l[0].split(","),u=l[1].split(";");c.forEach(g=>{const f=g.trim();if(!f)return;const h=t.styles[f]||{};if(u.forEach(d=>{const p=d.indexOf(":"),m=d.substr(0,p).trim(),y=d.substr(p+1,d.length-p).trim();m&&y&&(h[m]=new T(t,m,y))}),t.styles[f]=h,t.stylesSpecificity[f]=Rs(f),f==="@font-face"){const d=h["font-family"].getString().replace(/"|'/g,"");h.src.getString().split(",").forEach(m=>{if(m.indexOf('format("svg")')>0){const y=Br(m);y&&new yo(t).load(d,y)}})}})})}}Zr.parseExternalUrl=Br;class vo extends Vt{setContext(t){super.setContext(t);const e=this.getAttribute("x"),i=this.getAttribute("y");e.hasValue()&&t.translate(e.getPixels("x"),0),i.hasValue()&&t.translate(0,i.getPixels("y"))}path(t){const{element:e}=this;e&&e.path(t)}renderChildren(t){const{document:e,element:i}=this;if(i){let n=i;if(i.type==="symbol"&&(n=new ce(e),n.attributes.viewBox=new T(e,"viewBox",i.getAttribute("viewBox").getString()),n.attributes.preserveAspectRatio=new T(e,"preserveAspectRatio",i.getAttribute("preserveAspectRatio").getString()),n.attributes.overflow=new T(e,"overflow",i.getAttribute("overflow").getString()),n.children=i.children,i.styles.opacity=new T(e,"opacity",this.calculateOpacity())),n.type==="svg"){const a=this.getStyle("width",!1,!0),o=this.getStyle("height",!1,!0);a.hasValue()&&(n.attributes.width=new T(e,"width",a.getString())),o.hasValue()&&(n.attributes.height=new T(e,"height",o.getString()))}const s=n.parent;n.parent=this,n.render(t),n.parent=s}}getBoundingBox(t){const{element:e}=this;return e?e.getBoundingBox(t):null}elementTransform(){const{document:t,element:e}=this;return e?It.fromElement(t,e):null}get element(){return this.cachedElement||(this.cachedElement=this.getHrefAttribute().getDefinition()),this.cachedElement}constructor(...t){super(...t),this.type="use"}}function Ne(r,t,e,i,n,s){return r[e*i*4+t*4+s]}function Ce(r,t,e,i,n,s,a){r[e*i*4+t*4+s]=a}function B(r,t,e){return r[t]*e}function ht(r,t,e,i){return t+Math.cos(r)*e+Math.sin(r)*i}class Kr extends U{apply(t,e,i,n,s){const{includeOpacity:a,matrix:o}=this,l=t.getImageData(0,0,n,s);for(let c=0;c<s;c++)for(let u=0;u<n;u++){const g=Ne(l.data,u,c,n,s,0),f=Ne(l.data,u,c,n,s,1),h=Ne(l.data,u,c,n,s,2),d=Ne(l.data,u,c,n,s,3);let p=B(o,0,g)+B(o,1,f)+B(o,2,h)+B(o,3,d)+B(o,4,1),m=B(o,5,g)+B(o,6,f)+B(o,7,h)+B(o,8,d)+B(o,9,1),y=B(o,10,g)+B(o,11,f)+B(o,12,h)+B(o,13,d)+B(o,14,1),w=B(o,15,g)+B(o,16,f)+B(o,17,h)+B(o,18,d)+B(o,19,1);a&&(p=0,m=0,y=0,w*=d/255),Ce(l.data,u,c,n,s,0,p),Ce(l.data,u,c,n,s,1,m),Ce(l.data,u,c,n,s,2,y),Ce(l.data,u,c,n,s,3,w)}t.clearRect(0,0,n,s),t.putImageData(l,0,0)}constructor(t,e,i){super(t,e,i),this.type="feColorMatrix";let n=et(this.getAttribute("values").getString());switch(this.getAttribute("type").getString("matrix")){case"saturate":{const s=n[0];n=[.213+.787*s,.715-.715*s,.072-.072*s,0,0,.213-.213*s,.715+.285*s,.072-.072*s,0,0,.213-.213*s,.715-.715*s,.072+.928*s,0,0,0,0,0,1,0,0,0,0,0,1];break}case"hueRotate":{const s=n[0]*Math.PI/180;n=[ht(s,.213,.787,-.213),ht(s,.715,-.715,-.715),ht(s,.072,-.072,.928),0,0,ht(s,.213,-.213,.143),ht(s,.715,.285,.14),ht(s,.072,-.072,-.283),0,0,ht(s,.213,-.213,-.787),ht(s,.715,-.715,.715),ht(s,.072,.928,.072),0,0,0,0,0,1,0,0,0,0,0,1];break}case"luminanceToAlpha":n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,.2125,.7154,.0721,0,0,0,0,0,0,1];break}this.matrix=n,this.includeOpacity=this.getAttribute("includeOpacity").hasValue()}}class ze extends U{apply(t,e){const{document:i}=this;let n=this.getAttribute("x").getPixels("x"),s=this.getAttribute("y").getPixels("y"),a=this.getStyle("width").getPixels("x"),o=this.getStyle("height").getPixels("y");if(!a&&!o){const h=new at;this.children.forEach(d=>{h.addBoundingBox(d.getBoundingBox(t))}),n=Math.floor(h.x1),s=Math.floor(h.y1),a=Math.floor(h.width),o=Math.floor(h.height)}const l=this.removeStyles(e,ze.ignoreStyles),c=i.createCanvas(n+a,s+o),u=c.getContext("2d");i.screen.setDefaults(u),this.renderChildren(u),new Kr(i,{nodeType:1,childNodes:[],attributes:[{nodeName:"type",value:"luminanceToAlpha"},{nodeName:"includeOpacity",value:"true"}]}).apply(u,0,0,n+a,s+o);const g=i.createCanvas(n+a,s+o),f=g.getContext("2d");i.screen.setDefaults(f),e.render(f),f.globalCompositeOperation="destination-in",f.fillStyle=u.createPattern(c,"no-repeat"),f.fillRect(0,0,n+a,s+o),t.fillStyle=f.createPattern(g,"no-repeat"),t.fillRect(0,0,n+a,s+o),this.restoreStyles(e,l)}render(t){}constructor(...t){super(...t),this.type="mask"}}ze.ignoreStyles=["mask","transform","clip-path"];const hr=()=>{};class bo extends U{apply(t){const{document:e}=this,i=Reflect.getPrototypeOf(t),{beginPath:n,closePath:s}=t;i&&(i.beginPath=hr,i.closePath=hr),Reflect.apply(n,t,[]),this.children.forEach(a=>{if(!("path"in a))return;let o="elementTransform"in a?a.elementTransform():null;o||(o=It.fromElement(e,a)),o&&o.apply(t),a.path(t),i&&(i.closePath=s),o&&o.unapply(t)}),Reflect.apply(s,t,[]),t.clip(),i&&(i.beginPath=n,i.closePath=s)}render(t){}constructor(...t){super(...t),this.type="clipPath"}}class Fe extends U{apply(t,e){const{document:i,children:n}=this,s="getBoundingBox"in e?e.getBoundingBox(t):null;if(!s)return;let a=0,o=0;n.forEach(y=>{const w=y.extraFilterDistance||0;a=Math.max(a,w),o=Math.max(o,w)});const l=Math.floor(s.width),c=Math.floor(s.height),u=l+2*a,g=c+2*o;if(u<1||g<1)return;const f=Math.floor(s.x),h=Math.floor(s.y),d=this.removeStyles(e,Fe.ignoreStyles),p=i.createCanvas(u,g),m=p.getContext("2d");i.screen.setDefaults(m),m.translate(-f+a,-h+o),e.render(m),n.forEach(y=>{typeof y.apply=="function"&&y.apply(m,0,0,u,g)}),t.drawImage(p,0,0,u,g,f-a,h-o,u,g),this.restoreStyles(e,d)}render(t){}constructor(...t){super(...t),this.type="filter"}}Fe.ignoreStyles=["filter","transform","clip-path"];class xo extends U{apply(t,e,i,n,s){}constructor(t,e,i){super(t,e,i),this.type="feDropShadow",this.addStylesFromStyleDefinition()}}class wo extends U{apply(t,e,i,n,s){}constructor(...t){super(...t),this.type="feMorphology"}}class To extends U{apply(t,e,i,n,s){}constructor(...t){super(...t),this.type="feComposite"}}class Eo extends U{apply(t,e,i,n,s){const{document:a,blurRadius:o}=this,l=a.window?a.window.document.body:null,c=t.canvas;c.id=a.getUniqueId(),l&&(c.style.display="none",l.appendChild(c)),bs(c,e,i,n,s,o),l&&l.removeChild(c)}constructor(t,e,i){super(t,e,i),this.type="feGaussianBlur",this.blurRadius=Math.floor(this.getAttribute("stdDeviation").getNumber()),this.extraFilterDistance=this.blurRadius}}class So extends U{constructor(...t){super(...t),this.type="title"}}class Ao extends U{constructor(...t){super(...t),this.type="desc"}}const No={svg:ce,rect:$r,circle:Zs,ellipse:Ks,line:Js,polyline:Wr,polygon:to,path:D,pattern:eo,marker:io,defs:ro,linearGradient:no,radialGradient:so,stop:oo,animate:Ti,animateColor:ao,animateTransform:lo,font:co,"font-face":Gr,"missing-glyph":qr,glyph:Ei,text:wt,tspan:Ue,tref:uo,a:ho,textPath:fo,image:po,g:wi,symbol:mo,style:Zr,use:vo,mask:ze,clipPath:bo,filter:Fe,feDropShadow:xo,feMorphology:wo,feComposite:To,feColorMatrix:Kr,feGaussianBlur:Eo,title:So,desc:Ao};function Co(r,t){const e=document.createElement("canvas");return e.width=r,e.height=t,e}async function Mo(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const e=document.createElement("img");return t&&(e.crossOrigin="Anonymous"),new Promise((i,n)=>{e.onload=()=>{i(e)},e.onerror=(s,a,o,l,c)=>{n(c)},e.src=r})}const li=12;let Be=class De{bindCreateImage(t,e){return typeof e=="boolean"?(i,n)=>t(i,typeof n=="boolean"?n:e):t}get window(){return this.screen.window}get fetch(){return this.screen.fetch}get ctx(){return this.screen.ctx}get emSize(){const{emSizeStack:t}=this;return t[t.length-1]||li}set emSize(t){const{emSizeStack:e}=this;e.push(t)}popEmSize(){const{emSizeStack:t}=this;t.pop()}getUniqueId(){return"canvg".concat(++this.uniqueId)}isImagesLoaded(){return this.images.every(t=>t.loaded)}isFontsLoaded(){return this.fonts.every(t=>t.loaded)}createDocumentElement(t){const e=this.createElement(t.documentElement);return e.root=!0,e.addStylesFromStyleDefinition(),this.documentElement=e,e}createElement(t){const e=t.nodeName.replace(/^[^:]+:/,""),i=De.elementTypes[e];return i?new i(this,t):new js(this,t)}createTextNode(t){return new qs(this,t)}setViewBox(t){this.screen.setViewBox({document:this,...t})}constructor(t,{rootEmSize:e=li,emSize:i=li,createCanvas:n=De.createCanvas,createImage:s=De.createImage,anonymousCrossOrigin:a}={}){this.canvg=t,this.definitions={},this.styles={},this.stylesSpecificity={},this.images=[],this.fonts=[],this.emSizeStack=[],this.uniqueId=0,this.screen=t.screen,this.rootEmSize=e,this.emSize=i,this.createCanvas=n,this.createImage=this.bindCreateImage(s,a),this.screen.wait(()=>this.isImagesLoaded()),this.screen.wait(()=>this.isFontsLoaded())}};Be.createCanvas=Co;Be.createImage=Mo;Be.elementTypes=No;class Ht{static async from(t,e){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const s=await new ai(i).parse(e);return new Ht(t,s,i)}static fromString(t,e){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const s=new ai(i).parseFromString(e);return new Ht(t,s,i)}fork(t,e){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return Ht.from(t,e,{...this.options,...i})}forkString(t,e){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return Ht.fromString(t,e,{...this.options,...i})}ready(){return this.screen.ready()}isReady(){return this.screen.isReady()}async render(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.start({enableRedraw:!0,ignoreAnimation:!0,ignoreMouse:!0,...t}),await this.ready(),this.stop()}start(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{documentElement:e,screen:i,options:n}=this;i.start(e,{enableRedraw:!0,...n,...t})}stop(){this.screen.stop()}resize(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.documentElement.resize(t,e,i)}constructor(t,e,i={}){this.parser=new ai(i),this.screen=new pt(t,i),this.options=i;const n=new Be(this,i),s=n.createDocumentElement(e);this.document=n,this.documentElement=s}}var Tt={},Et={};function Si(r,t){return t===void 0&&(t=Object),t&&typeof t.freeze=="function"?t.freeze(r):r}function Oo(r,t){if(r===null||typeof r!="object")throw new TypeError("target is not an object");for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&(r[e]=t[e]);return r}var Jr=Si({HTML:"text/html",isHTML:function(r){return r===Jr.HTML},XML_APPLICATION:"application/xml",XML_TEXT:"text/xml",XML_XHTML_APPLICATION:"application/xhtml+xml",XML_SVG_IMAGE:"image/svg+xml"}),tn=Si({HTML:"http://www.w3.org/1999/xhtml",isHTML:function(r){return r===tn.HTML},SVG:"http://www.w3.org/2000/svg",XML:"http://www.w3.org/XML/1998/namespace",XMLNS:"http://www.w3.org/2000/xmlns/"});Et.assign=Oo;Et.freeze=Si;Et.MIME_TYPE=Jr;Et.NAMESPACE=tn;var Po=Et,se=Po.NAMESPACE;function Do(r){return r!==""}function Io(r){return r?r.split(/[\t\n\f\r ]+/).filter(Do):[]}function ko(r,t){return r.hasOwnProperty(t)||(r[t]=!0),r}function fr(r){if(!r)return[];var t=Io(r);return Object.keys(t.reduce(ko,{}))}function Ro(r){return function(t){return r&&r.indexOf(t)!==-1}}function ue(r,t){for(var e in r)Object.prototype.hasOwnProperty.call(r,e)&&(t[e]=r[e])}function J(r,t){var e=r.prototype;if(!(e instanceof t)){let n=function(){};var i=n;n.prototype=t.prototype,n=new n,ue(e,n),r.prototype=e=n}e.constructor!=r&&(typeof r!="function"&&console.error("unknown Class:"+r),e.constructor=r)}var tt={},ot=tt.ELEMENT_NODE=1,Qt=tt.ATTRIBUTE_NODE=2,Ve=tt.TEXT_NODE=3,en=tt.CDATA_SECTION_NODE=4,rn=tt.ENTITY_REFERENCE_NODE=5,Vo=tt.ENTITY_NODE=6,nn=tt.PROCESSING_INSTRUCTION_NODE=7,sn=tt.COMMENT_NODE=8,on=tt.DOCUMENT_NODE=9,an=tt.DOCUMENT_TYPE_NODE=10,dt=tt.DOCUMENT_FRAGMENT_NODE=11,_o=tt.NOTATION_NODE=12,j={},Y={};j.INDEX_SIZE_ERR=(Y[1]="Index size error",1);j.DOMSTRING_SIZE_ERR=(Y[2]="DOMString size error",2);var Lo=j.HIERARCHY_REQUEST_ERR=(Y[3]="Hierarchy request error",3);j.WRONG_DOCUMENT_ERR=(Y[4]="Wrong document",4);j.INVALID_CHARACTER_ERR=(Y[5]="Invalid character",5);j.NO_DATA_ALLOWED_ERR=(Y[6]="No data allowed",6);j.NO_MODIFICATION_ALLOWED_ERR=(Y[7]="No modification allowed",7);var Uo=j.NOT_FOUND_ERR=(Y[8]="Not found",8);j.NOT_SUPPORTED_ERR=(Y[9]="Not supported",9);var gr=j.INUSE_ATTRIBUTE_ERR=(Y[10]="Attribute in use",10);j.INVALID_STATE_ERR=(Y[11]="Invalid state",11);j.SYNTAX_ERR=(Y[12]="Syntax error",12);j.INVALID_MODIFICATION_ERR=(Y[13]="Invalid modification",13);j.NAMESPACE_ERR=(Y[14]="Invalid namespace",14);j.INVALID_ACCESS_ERR=(Y[15]="Invalid access",15);function kt(r,t){if(t instanceof Error)var e=t;else e=this,Error.call(this,Y[r]),this.message=Y[r],Error.captureStackTrace&&Error.captureStackTrace(this,kt);return e.code=r,t&&(this.message=this.message+": "+t),e}kt.prototype=Error.prototype;ue(j,kt);function gt(){}gt.prototype={length:0,item:function(r){return this[r]||null},toString:function(r,t){for(var e=[],i=0;i<this.length;i++)Xt(this[i],e,r,t);return e.join("")}};function Gt(r,t){this._node=r,this._refresh=t,Ai(this)}function Ai(r){var t=r._node._inc||r._node.ownerDocument._inc;if(r._inc!=t){var e=r._refresh(r._node);bn(r,"length",e.length),ue(e,r),r._inc=t}}Gt.prototype.item=function(r){return Ai(this),this[r]};J(Gt,gt);function _e(){}function ln(r,t){for(var e=r.length;e--;)if(r[e]===t)return e}function dr(r,t,e,i){if(i?t[ln(t,i)]=e:t[t.length++]=e,r){e.ownerElement=r;var n=r.ownerDocument;n&&(i&&hn(n,r,i),zo(n,r,e))}}function pr(r,t,e){var i=ln(t,e);if(i>=0){for(var n=t.length-1;i<n;)t[i]=t[++i];if(t.length=n,r){var s=r.ownerDocument;s&&(hn(s,r,e),e.ownerElement=null)}}else throw kt(Uo,new Error(r.tagName+"@"+e))}_e.prototype={length:0,item:gt.prototype.item,getNamedItem:function(r){for(var t=this.length;t--;){var e=this[t];if(e.nodeName==r)return e}},setNamedItem:function(r){var t=r.ownerElement;if(t&&t!=this._ownerElement)throw new kt(gr);var e=this.getNamedItem(r.nodeName);return dr(this._ownerElement,this,r,e),e},setNamedItemNS:function(r){var t=r.ownerElement,e;if(t&&t!=this._ownerElement)throw new kt(gr);return e=this.getNamedItemNS(r.namespaceURI,r.localName),dr(this._ownerElement,this,r,e),e},removeNamedItem:function(r){var t=this.getNamedItem(r);return pr(this._ownerElement,this,t),t},removeNamedItemNS:function(r,t){var e=this.getNamedItemNS(r,t);return pr(this._ownerElement,this,e),e},getNamedItemNS:function(r,t){for(var e=this.length;e--;){var i=this[e];if(i.localName==t&&i.namespaceURI==r)return i}return null}};function cn(){}cn.prototype={hasFeature:function(r,t){return!0},createDocument:function(r,t,e){var i=new he;if(i.implementation=this,i.childNodes=new gt,i.doctype=e||null,e&&i.appendChild(e),t){var n=i.createElementNS(r,t);i.appendChild(n)}return i},createDocumentType:function(r,t,e){var i=new He;return i.name=r,i.nodeName=r,i.publicId=t||"",i.systemId=e||"",i}};function $(){}$.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(r,t){return gn(this,r,t)},replaceChild:function(r,t){this.insertBefore(r,t),t&&this.removeChild(t)},removeChild:function(r){return fn(this,r)},appendChild:function(r){return this.insertBefore(r,null)},hasChildNodes:function(){return this.firstChild!=null},cloneNode:function(r){return vi(this.ownerDocument||this,this,r)},normalize:function(){for(var r=this.firstChild;r;){var t=r.nextSibling;t&&t.nodeType==Ve&&r.nodeType==Ve?(this.removeChild(t),r.appendData(t.data)):(r.normalize(),r=t)}},isSupported:function(r,t){return this.ownerDocument.implementation.hasFeature(r,t)},hasAttributes:function(){return this.attributes.length>0},lookupPrefix:function(r){for(var t=this;t;){var e=t._nsMap;if(e){for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)&&e[i]===r)return i}t=t.nodeType==Qt?t.ownerDocument:t.parentNode}return null},lookupNamespaceURI:function(r){for(var t=this;t;){var e=t._nsMap;if(e&&Object.prototype.hasOwnProperty.call(e,r))return e[r];t=t.nodeType==Qt?t.ownerDocument:t.parentNode}return null},isDefaultNamespace:function(r){var t=this.lookupPrefix(r);return t==null}};function un(r){return r=="<"&&"&lt;"||r==">"&&"&gt;"||r=="&"&&"&amp;"||r=='"'&&"&quot;"||"&#"+r.charCodeAt()+";"}ue(tt,$);ue(tt,$.prototype);function oe(r,t){if(t(r))return!0;if(r=r.firstChild)do if(oe(r,t))return!0;while(r=r.nextSibling)}function he(){}function zo(r,t,e){r&&r._inc++;var i=e.namespaceURI;i===se.XMLNS&&(t._nsMap[e.prefix?e.localName:""]=e.value)}function hn(r,t,e,i){r&&r._inc++;var n=e.namespaceURI;n===se.XMLNS&&delete t._nsMap[e.prefix?e.localName:""]}function Ni(r,t,e){if(r&&r._inc){r._inc++;var i=t.childNodes;if(e)i[i.length++]=e;else{for(var n=t.firstChild,s=0;n;)i[s++]=n,n=n.nextSibling;i.length=s,delete i[i.length]}}}function fn(r,t){var e=t.previousSibling,i=t.nextSibling;return e?e.nextSibling=i:r.firstChild=i,i?i.previousSibling=e:r.lastChild=e,t.parentNode=null,t.previousSibling=null,t.nextSibling=null,Ni(r.ownerDocument,r),t}function gn(r,t,e){var i=t.parentNode;if(i&&i.removeChild(t),t.nodeType===dt){var n=t.firstChild;if(n==null)return t;var s=t.lastChild}else n=s=t;var a=e?e.previousSibling:r.lastChild;n.previousSibling=a,s.nextSibling=e,a?a.nextSibling=n:r.firstChild=n,e==null?r.lastChild=s:e.previousSibling=s;do n.parentNode=r;while(n!==s&&(n=n.nextSibling));return Ni(r.ownerDocument||r,r),t.nodeType==dt&&(t.firstChild=t.lastChild=null),t}function Fo(r,t){return t.parentNode&&t.parentNode.removeChild(t),t.parentNode=r,t.previousSibling=r.lastChild,t.nextSibling=null,t.previousSibling?t.previousSibling.nextSibling=t:r.firstChild=t,r.lastChild=t,Ni(r.ownerDocument,r,t),t}he.prototype={nodeName:"#document",nodeType:on,doctype:null,documentElement:null,_inc:1,insertBefore:function(r,t){if(r.nodeType==dt){for(var e=r.firstChild;e;){var i=e.nextSibling;this.insertBefore(e,t),e=i}return r}return this.documentElement==null&&r.nodeType==ot&&(this.documentElement=r),gn(this,r,t),r.ownerDocument=this,r},removeChild:function(r){return this.documentElement==r&&(this.documentElement=null),fn(this,r)},importNode:function(r,t){return vn(this,r,t)},getElementById:function(r){var t=null;return oe(this.documentElement,function(e){if(e.nodeType==ot&&e.getAttribute("id")==r)return t=e,!0}),t},getElementsByClassName:function(r){var t=fr(r);return new Gt(this,function(e){var i=[];return t.length>0&&oe(e.documentElement,function(n){if(n!==e&&n.nodeType===ot){var s=n.getAttribute("class");if(s){var a=r===s;if(!a){var o=fr(s);a=t.every(Ro(o))}a&&i.push(n)}}}),i})},createElement:function(r){var t=new Rt;t.ownerDocument=this,t.nodeName=r,t.tagName=r,t.localName=r,t.childNodes=new gt;var e=t.attributes=new _e;return e._ownerElement=t,t},createDocumentFragment:function(){var r=new Xe;return r.ownerDocument=this,r.childNodes=new gt,r},createTextNode:function(r){var t=new Ci;return t.ownerDocument=this,t.appendData(r),t},createComment:function(r){var t=new Mi;return t.ownerDocument=this,t.appendData(r),t},createCDATASection:function(r){var t=new Oi;return t.ownerDocument=this,t.appendData(r),t},createProcessingInstruction:function(r,t){var e=new Di;return e.ownerDocument=this,e.tagName=e.target=r,e.nodeValue=e.data=t,e},createAttribute:function(r){var t=new Le;return t.ownerDocument=this,t.name=r,t.nodeName=r,t.localName=r,t.specified=!0,t},createEntityReference:function(r){var t=new Pi;return t.ownerDocument=this,t.nodeName=r,t},createElementNS:function(r,t){var e=new Rt,i=t.split(":"),n=e.attributes=new _e;return e.childNodes=new gt,e.ownerDocument=this,e.nodeName=t,e.tagName=t,e.namespaceURI=r,i.length==2?(e.prefix=i[0],e.localName=i[1]):e.localName=t,n._ownerElement=e,e},createAttributeNS:function(r,t){var e=new Le,i=t.split(":");return e.ownerDocument=this,e.nodeName=t,e.name=t,e.namespaceURI=r,e.specified=!0,i.length==2?(e.prefix=i[0],e.localName=i[1]):e.localName=t,e}};J(he,$);function Rt(){this._nsMap={}}Rt.prototype={nodeType:ot,hasAttribute:function(r){return this.getAttributeNode(r)!=null},getAttribute:function(r){var t=this.getAttributeNode(r);return t&&t.value||""},getAttributeNode:function(r){return this.attributes.getNamedItem(r)},setAttribute:function(r,t){var e=this.ownerDocument.createAttribute(r);e.value=e.nodeValue=""+t,this.setAttributeNode(e)},removeAttribute:function(r){var t=this.getAttributeNode(r);t&&this.removeAttributeNode(t)},appendChild:function(r){return r.nodeType===dt?this.insertBefore(r,null):Fo(this,r)},setAttributeNode:function(r){return this.attributes.setNamedItem(r)},setAttributeNodeNS:function(r){return this.attributes.setNamedItemNS(r)},removeAttributeNode:function(r){return this.attributes.removeNamedItem(r.nodeName)},removeAttributeNS:function(r,t){var e=this.getAttributeNodeNS(r,t);e&&this.removeAttributeNode(e)},hasAttributeNS:function(r,t){return this.getAttributeNodeNS(r,t)!=null},getAttributeNS:function(r,t){var e=this.getAttributeNodeNS(r,t);return e&&e.value||""},setAttributeNS:function(r,t,e){var i=this.ownerDocument.createAttributeNS(r,t);i.value=i.nodeValue=""+e,this.setAttributeNode(i)},getAttributeNodeNS:function(r,t){return this.attributes.getNamedItemNS(r,t)},getElementsByTagName:function(r){return new Gt(this,function(t){var e=[];return oe(t,function(i){i!==t&&i.nodeType==ot&&(r==="*"||i.tagName==r)&&e.push(i)}),e})},getElementsByTagNameNS:function(r,t){return new Gt(this,function(e){var i=[];return oe(e,function(n){n!==e&&n.nodeType===ot&&(r==="*"||n.namespaceURI===r)&&(t==="*"||n.localName==t)&&i.push(n)}),i})}};he.prototype.getElementsByTagName=Rt.prototype.getElementsByTagName;he.prototype.getElementsByTagNameNS=Rt.prototype.getElementsByTagNameNS;J(Rt,$);function Le(){}Le.prototype.nodeType=Qt;J(Le,$);function fe(){}fe.prototype={data:"",substringData:function(r,t){return this.data.substring(r,r+t)},appendData:function(r){r=this.data+r,this.nodeValue=this.data=r,this.length=r.length},insertData:function(r,t){this.replaceData(r,0,t)},appendChild:function(r){throw new Error(Y[Lo])},deleteData:function(r,t){this.replaceData(r,t,"")},replaceData:function(r,t,e){var i=this.data.substring(0,r),n=this.data.substring(r+t);e=i+e+n,this.nodeValue=this.data=e,this.length=e.length}};J(fe,$);function Ci(){}Ci.prototype={nodeName:"#text",nodeType:Ve,splitText:function(r){var t=this.data,e=t.substring(r);t=t.substring(0,r),this.data=this.nodeValue=t,this.length=t.length;var i=this.ownerDocument.createTextNode(e);return this.parentNode&&this.parentNode.insertBefore(i,this.nextSibling),i}};J(Ci,fe);function Mi(){}Mi.prototype={nodeName:"#comment",nodeType:sn};J(Mi,fe);function Oi(){}Oi.prototype={nodeName:"#cdata-section",nodeType:en};J(Oi,fe);function He(){}He.prototype.nodeType=an;J(He,$);function dn(){}dn.prototype.nodeType=_o;J(dn,$);function pn(){}pn.prototype.nodeType=Vo;J(pn,$);function Pi(){}Pi.prototype.nodeType=rn;J(Pi,$);function Xe(){}Xe.prototype.nodeName="#document-fragment";Xe.prototype.nodeType=dt;J(Xe,$);function Di(){}Di.prototype.nodeType=nn;J(Di,$);function mn(){}mn.prototype.serializeToString=function(r,t,e){return yn.call(r,t,e)};$.prototype.toString=yn;function yn(r,t){var e=[],i=this.nodeType==9&&this.documentElement||this,n=i.prefix,s=i.namespaceURI;if(s&&n==null){var n=i.lookupPrefix(s);if(n==null)var a=[{namespace:s,prefix:null}]}return Xt(this,e,r,t,a),e.join("")}function mr(r,t,e){var i=r.prefix||"",n=r.namespaceURI;if(!n||i==="xml"&&n===se.XML||n===se.XMLNS)return!1;for(var s=e.length;s--;){var a=e[s];if(a.prefix===i)return a.namespace!==n}return!0}function ci(r,t,e){r.push(" ",t,'="',e.replace(/[<>&"\t\n\r]/g,un),'"')}function Xt(r,t,e,i,n){if(n||(n=[]),i)if(r=i(r),r){if(typeof r=="string"){t.push(r);return}}else return;switch(r.nodeType){case ot:var s=r.attributes,a=s.length,y=r.firstChild,o=r.tagName;e=se.isHTML(r.namespaceURI)||e;var l=o;if(!e&&!r.prefix&&r.namespaceURI){for(var c,u=0;u<s.length;u++)if(s.item(u).name==="xmlns"){c=s.item(u).value;break}if(!c)for(var g=n.length-1;g>=0;g--){var f=n[g];if(f.prefix===""&&f.namespace===r.namespaceURI){c=f.namespace;break}}if(c!==r.namespaceURI)for(var g=n.length-1;g>=0;g--){var f=n[g];if(f.namespace===r.namespaceURI){f.prefix&&(l=f.prefix+":"+o);break}}}t.push("<",l);for(var h=0;h<a;h++){var d=s.item(h);d.prefix=="xmlns"?n.push({prefix:d.localName,namespace:d.value}):d.nodeName=="xmlns"&&n.push({prefix:"",namespace:d.value})}for(var h=0;h<a;h++){var d=s.item(h);if(mr(d,e,n)){var p=d.prefix||"",m=d.namespaceURI;ci(t,p?"xmlns:"+p:"xmlns",m),n.push({prefix:p,namespace:m})}Xt(d,t,e,i,n)}if(o===l&&mr(r,e,n)){var p=r.prefix||"",m=r.namespaceURI;ci(t,p?"xmlns:"+p:"xmlns",m),n.push({prefix:p,namespace:m})}if(y||e&&!/^(?:meta|link|img|br|hr|input)$/i.test(o)){if(t.push(">"),e&&/^script$/i.test(o))for(;y;)y.data?t.push(y.data):Xt(y,t,e,i,n.slice()),y=y.nextSibling;else for(;y;)Xt(y,t,e,i,n.slice()),y=y.nextSibling;t.push("</",l,">")}else t.push("/>");return;case on:case dt:for(var y=r.firstChild;y;)Xt(y,t,e,i,n.slice()),y=y.nextSibling;return;case Qt:return ci(t,r.name,r.value);case Ve:return t.push(r.data.replace(/[<&>]/g,un));case en:return t.push("<![CDATA[",r.data,"]]>");case sn:return t.push("<!--",r.data,"-->");case an:var w=r.publicId,b=r.systemId;if(t.push("<!DOCTYPE ",r.name),w)t.push(" PUBLIC ",w),b&&b!="."&&t.push(" ",b),t.push(">");else if(b&&b!=".")t.push(" SYSTEM ",b,">");else{var x=r.internalSubset;x&&t.push(" [",x,"]"),t.push(">")}return;case nn:return t.push("<?",r.target," ",r.data,"?>");case rn:return t.push("&",r.nodeName,";");default:t.push("??",r.nodeName)}}function vn(r,t,e){var i;switch(t.nodeType){case ot:i=t.cloneNode(!1),i.ownerDocument=r;case dt:break;case Qt:e=!0;break}if(i||(i=t.cloneNode(!1)),i.ownerDocument=r,i.parentNode=null,e)for(var n=t.firstChild;n;)i.appendChild(vn(r,n,e)),n=n.nextSibling;return i}function vi(r,t,e){var i=new t.constructor;for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){var s=t[n];typeof s!="object"&&s!=i[n]&&(i[n]=s)}switch(t.childNodes&&(i.childNodes=new gt),i.ownerDocument=r,i.nodeType){case ot:var a=t.attributes,o=i.attributes=new _e,l=a.length;o._ownerElement=i;for(var c=0;c<l;c++)i.setAttributeNode(vi(r,a.item(c),!0));break;case Qt:e=!0}if(e)for(var u=t.firstChild;u;)i.appendChild(vi(r,u,e)),u=u.nextSibling;return i}function bn(r,t,e){r[t]=e}try{if(Object.defineProperty){let r=function(t){switch(t.nodeType){case ot:case dt:var e=[];for(t=t.firstChild;t;)t.nodeType!==7&&t.nodeType!==8&&e.push(r(t)),t=t.nextSibling;return e.join("");default:return t.nodeValue}};var getTextContent=r;Object.defineProperty(Gt.prototype,"length",{get:function(){return Ai(this),this.$$length}}),Object.defineProperty($.prototype,"textContent",{get:function(){return r(this)},set:function(t){switch(this.nodeType){case ot:case dt:for(;this.firstChild;)this.removeChild(this.firstChild);(t||String(t))&&this.appendChild(this.ownerDocument.createTextNode(t));break;default:this.data=t,this.value=t,this.nodeValue=t}}}),bn=function(t,e,i){t["$$"+e]=i}}}catch{}Tt.DocumentType=He;Tt.DOMException=kt;Tt.DOMImplementation=cn;Tt.Element=Rt;Tt.Node=$;Tt.NodeList=gt;Tt.XMLSerializer=mn;var Ye={},xn={};(function(r){var t=Et.freeze;r.XML_ENTITIES=t({amp:"&",apos:"'",gt:">",lt:"<",quot:'"'}),r.HTML_ENTITIES=t({lt:"<",gt:">",amp:"&",quot:'"',apos:"'",Agrave:"À",Aacute:"Á",Acirc:"Â",Atilde:"Ã",Auml:"Ä",Aring:"Å",AElig:"Æ",Ccedil:"Ç",Egrave:"È",Eacute:"É",Ecirc:"Ê",Euml:"Ë",Igrave:"Ì",Iacute:"Í",Icirc:"Î",Iuml:"Ï",ETH:"Ð",Ntilde:"Ñ",Ograve:"Ò",Oacute:"Ó",Ocirc:"Ô",Otilde:"Õ",Ouml:"Ö",Oslash:"Ø",Ugrave:"Ù",Uacute:"Ú",Ucirc:"Û",Uuml:"Ü",Yacute:"Ý",THORN:"Þ",szlig:"ß",agrave:"à",aacute:"á",acirc:"â",atilde:"ã",auml:"ä",aring:"å",aelig:"æ",ccedil:"ç",egrave:"è",eacute:"é",ecirc:"ê",euml:"ë",igrave:"ì",iacute:"í",icirc:"î",iuml:"ï",eth:"ð",ntilde:"ñ",ograve:"ò",oacute:"ó",ocirc:"ô",otilde:"õ",ouml:"ö",oslash:"ø",ugrave:"ù",uacute:"ú",ucirc:"û",uuml:"ü",yacute:"ý",thorn:"þ",yuml:"ÿ",nbsp:" ",iexcl:"¡",cent:"¢",pound:"£",curren:"¤",yen:"¥",brvbar:"¦",sect:"§",uml:"¨",copy:"©",ordf:"ª",laquo:"«",not:"¬",shy:"­­",reg:"®",macr:"¯",deg:"°",plusmn:"±",sup2:"²",sup3:"³",acute:"´",micro:"µ",para:"¶",middot:"·",cedil:"¸",sup1:"¹",ordm:"º",raquo:"»",frac14:"¼",frac12:"½",frac34:"¾",iquest:"¿",times:"×",divide:"÷",forall:"∀",part:"∂",exist:"∃",empty:"∅",nabla:"∇",isin:"∈",notin:"∉",ni:"∋",prod:"∏",sum:"∑",minus:"−",lowast:"∗",radic:"√",prop:"∝",infin:"∞",ang:"∠",and:"∧",or:"∨",cap:"∩",cup:"∪",int:"∫",there4:"∴",sim:"∼",cong:"≅",asymp:"≈",ne:"≠",equiv:"≡",le:"≤",ge:"≥",sub:"⊂",sup:"⊃",nsub:"⊄",sube:"⊆",supe:"⊇",oplus:"⊕",otimes:"⊗",perp:"⊥",sdot:"⋅",Alpha:"Α",Beta:"Β",Gamma:"Γ",Delta:"Δ",Epsilon:"Ε",Zeta:"Ζ",Eta:"Η",Theta:"Θ",Iota:"Ι",Kappa:"Κ",Lambda:"Λ",Mu:"Μ",Nu:"Ν",Xi:"Ξ",Omicron:"Ο",Pi:"Π",Rho:"Ρ",Sigma:"Σ",Tau:"Τ",Upsilon:"Υ",Phi:"Φ",Chi:"Χ",Psi:"Ψ",Omega:"Ω",alpha:"α",beta:"β",gamma:"γ",delta:"δ",epsilon:"ε",zeta:"ζ",eta:"η",theta:"θ",iota:"ι",kappa:"κ",lambda:"λ",mu:"μ",nu:"ν",xi:"ξ",omicron:"ο",pi:"π",rho:"ρ",sigmaf:"ς",sigma:"σ",tau:"τ",upsilon:"υ",phi:"φ",chi:"χ",psi:"ψ",omega:"ω",thetasym:"ϑ",upsih:"ϒ",piv:"ϖ",OElig:"Œ",oelig:"œ",Scaron:"Š",scaron:"š",Yuml:"Ÿ",fnof:"ƒ",circ:"ˆ",tilde:"˜",ensp:" ",emsp:" ",thinsp:" ",zwnj:"‌",zwj:"‍",lrm:"‎",rlm:"‏",ndash:"–",mdash:"—",lsquo:"‘",rsquo:"’",sbquo:"‚",ldquo:"“",rdquo:"”",bdquo:"„",dagger:"†",Dagger:"‡",bull:"•",hellip:"…",permil:"‰",prime:"′",Prime:"″",lsaquo:"‹",rsaquo:"›",oline:"‾",euro:"€",trade:"™",larr:"←",uarr:"↑",rarr:"→",darr:"↓",harr:"↔",crarr:"↵",lceil:"⌈",rceil:"⌉",lfloor:"⌊",rfloor:"⌋",loz:"◊",spades:"♠",clubs:"♣",hearts:"♥",diams:"♦"}),r.entityMap=r.HTML_ENTITIES})(xn);var Ii={},ae=Et.NAMESPACE,bi=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,yr=new RegExp("[\\-\\.0-9"+bi.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]"),vr=new RegExp("^"+bi.source+yr.source+"*(?::"+bi.source+yr.source+"*)?$"),Jt=0,yt=1,Ut=2,te=3,zt=4,Ft=5,ee=6,Me=7;function qt(r,t){this.message=r,this.locator=t,Error.captureStackTrace&&Error.captureStackTrace(this,qt)}qt.prototype=new Error;qt.prototype.name=qt.name;function wn(){}wn.prototype={parse:function(r,t,e){var i=this.domBuilder;i.startDocument(),Tn(t,t={}),Bo(r,t,e,i,this.errorHandler),i.endDocument()}};function Bo(r,t,e,i,n){function s(N){if(N>65535){N-=65536;var P=55296+(N>>10),W=56320+(N&1023);return String.fromCharCode(P,W)}else return String.fromCharCode(N)}function a(N){var P=N.slice(1,-1);return Object.hasOwnProperty.call(e,P)?e[P]:P.charAt(0)==="#"?s(parseInt(P.substr(1).replace("x","0x"))):(n.error("entity not found:"+N),N)}function o(N){if(N>p){var P=r.substring(p,N).replace(/&#?\w+;/g,a);f&&l(p),i.characters(P,0,N-p),p=N}}function l(N,P){for(;N>=u&&(P=g.exec(r));)c=P.index,u=c+P[0].length,f.lineNumber++;f.columnNumber=N-c+1}for(var c=0,u=0,g=/.*(?:\r\n?|\n)|.*$/g,f=i.locator,h=[{currentNSMap:t}],d={},p=0;;){try{var m=r.indexOf("<",p);if(m<0){if(!r.substr(p).match(/^\s*$/)){var y=i.doc,w=y.createTextNode(r.substr(p));y.appendChild(w),i.currentElement=w}return}switch(m>p&&o(m),r.charAt(m+1)){case"/":var O=r.indexOf(">",m+3),b=r.substring(m+2,O).replace(/[ \t\n\r]+$/g,""),x=h.pop();O<0?(b=r.substring(m+2).replace(/[\s<].*/,""),n.error("end tag name: "+b+" is not complete:"+x.tagName),O=m+1+b.length):b.match(/\s</)&&(b=b.replace(/[\s<].*/,""),n.error("end tag name: "+b+" maybe not complete"),O=m+1+b.length);var M=x.localNSMap,A=x.tagName==b,E=A||x.tagName&&x.tagName.toLowerCase()==b.toLowerCase();if(E){if(i.endElement(x.uri,x.localName,b),M)for(var I in M)Object.prototype.hasOwnProperty.call(M,I)&&i.endPrefixMapping(I);A||n.fatalError("end tag name: "+b+" is not match the current start tagName:"+x.tagName)}else h.push(x);O++;break;case"?":f&&l(m),O=$o(r,m,i);break;case"!":f&&l(m),O=jo(r,m,i,n);break;default:f&&l(m);var C=new En,z=h[h.length-1].currentNSMap,O=Ho(r,m,C,z,a,n),F=C.length;if(!C.closed&&Yo(r,O,C.tagName,d)&&(C.closed=!0,e.nbsp||n.warning("unclosed xml attribute")),f&&F){for(var X=br(f,{}),_=0;_<F;_++){var k=C[_];l(k.offset),k.locator=br(f,{})}i.locator=X,xr(C,i,z)&&h.push(C),i.locator=f}else xr(C,i,z)&&h.push(C);ae.isHTML(C.uri)&&!C.closed?O=Xo(r,O,C.tagName,a,i):O++}}catch(N){if(N instanceof qt)throw N;n.error("element parse error: "+N),O=-1}O>p?p=O:o(Math.max(m,p)+1)}}function br(r,t){return t.lineNumber=r.lineNumber,t.columnNumber=r.columnNumber,t}function Ho(r,t,e,i,n,s){function a(f,h,d){e.attributeNames.hasOwnProperty(f)&&s.fatalError("Attribute "+f+" redefined"),e.addValue(f,h.replace(/[\t\n\r]/g," ").replace(/&#?\w+;/g,n),d)}for(var o,l,c=++t,u=Jt;;){var g=r.charAt(c);switch(g){case"=":if(u===yt)o=r.slice(t,c),u=te;else if(u===Ut)u=te;else throw new Error("attribute equal must after attrName");break;case"'":case'"':if(u===te||u===yt)if(u===yt&&(s.warning('attribute value must after "="'),o=r.slice(t,c)),t=c+1,c=r.indexOf(g,t),c>0)l=r.slice(t,c),a(o,l,t-1),u=Ft;else throw new Error("attribute value no end '"+g+"' match");else if(u==zt)l=r.slice(t,c),a(o,l,t),s.warning('attribute "'+o+'" missed start quot('+g+")!!"),t=c+1,u=Ft;else throw new Error('attribute value must after "="');break;case"/":switch(u){case Jt:e.setTagName(r.slice(t,c));case Ft:case ee:case Me:u=Me,e.closed=!0;case zt:case yt:case Ut:break;default:throw new Error("attribute invalid close char('/')")}break;case"":return s.error("unexpected end of input"),u==Jt&&e.setTagName(r.slice(t,c)),c;case">":switch(u){case Jt:e.setTagName(r.slice(t,c));case Ft:case ee:case Me:break;case zt:case yt:l=r.slice(t,c),l.slice(-1)==="/"&&(e.closed=!0,l=l.slice(0,-1));case Ut:u===Ut&&(l=o),u==zt?(s.warning('attribute "'+l+'" missed quot(")!'),a(o,l,t)):((!ae.isHTML(i[""])||!l.match(/^(?:disabled|checked|selected)$/i))&&s.warning('attribute "'+l+'" missed value!! "'+l+'" instead!!'),a(l,l,t));break;case te:throw new Error("attribute value missed!!")}return c;case"":g=" ";default:if(g<=" ")switch(u){case Jt:e.setTagName(r.slice(t,c)),u=ee;break;case yt:o=r.slice(t,c),u=Ut;break;case zt:var l=r.slice(t,c);s.warning('attribute "'+l+'" missed quot(")!!'),a(o,l,t);case Ft:u=ee;break}else switch(u){case Ut:e.tagName,(!ae.isHTML(i[""])||!o.match(/^(?:disabled|checked|selected)$/i))&&s.warning('attribute "'+o+'" missed value!! "'+o+'" instead2!!'),a(o,o,t),t=c,u=yt;break;case Ft:s.warning('attribute space is required"'+o+'"!!');case ee:u=yt,t=c;break;case te:u=zt,t=c;break;case Me:throw new Error("elements closed character '/' and '>' must be connected to")}}c++}}function xr(r,t,e){for(var i=r.tagName,n=null,g=r.length;g--;){var s=r[g],a=s.qName,o=s.value,f=a.indexOf(":");if(f>0)var l=s.prefix=a.slice(0,f),c=a.slice(f+1),u=l==="xmlns"&&c;else c=a,l=null,u=a==="xmlns"&&"";s.localName=c,u!==!1&&(n==null&&(n={},Tn(e,e={})),e[u]=n[u]=o,s.uri=ae.XMLNS,t.startPrefixMapping(u,o))}for(var g=r.length;g--;){s=r[g];var l=s.prefix;l&&(l==="xml"&&(s.uri=ae.XML),l!=="xmlns"&&(s.uri=e[l||""]))}var f=i.indexOf(":");f>0?(l=r.prefix=i.slice(0,f),c=r.localName=i.slice(f+1)):(l=null,c=r.localName=i);var h=r.uri=e[l||""];if(t.startElement(h,c,i,r),r.closed){if(t.endElement(h,c,i),n)for(l in n)Object.prototype.hasOwnProperty.call(n,l)&&t.endPrefixMapping(l)}else return r.currentNSMap=e,r.localNSMap=n,!0}function Xo(r,t,e,i,n){if(/^(?:script|textarea)$/i.test(e)){var s=r.indexOf("</"+e+">",t),a=r.substring(t+1,s);if(/[&<]/.test(a))return/^script$/i.test(e)?(n.characters(a,0,a.length),s):(a=a.replace(/&#?\w+;/g,i),n.characters(a,0,a.length),s)}return t+1}function Yo(r,t,e,i){var n=i[e];return n==null&&(n=r.lastIndexOf("</"+e+">"),n<t&&(n=r.lastIndexOf("</"+e)),i[e]=n),n<t}function Tn(r,t){for(var e in r)Object.prototype.hasOwnProperty.call(r,e)&&(t[e]=r[e])}function jo(r,t,e,i){var n=r.charAt(t+2);switch(n){case"-":if(r.charAt(t+3)==="-"){var s=r.indexOf("-->",t+4);return s>t?(e.comment(r,t+4,s-t-4),s+3):(i.error("Unclosed comment"),-1)}else return-1;default:if(r.substr(t+3,6)=="CDATA["){var s=r.indexOf("]]>",t+9);return e.startCDATA(),e.characters(r,t+9,s-t-9),e.endCDATA(),s+3}var a=Wo(r,t),o=a.length;if(o>1&&/!doctype/i.test(a[0][0])){var l=a[1][0],c=!1,u=!1;o>3&&(/^public$/i.test(a[2][0])?(c=a[3][0],u=o>4&&a[4][0]):/^system$/i.test(a[2][0])&&(u=a[3][0]));var g=a[o-1];return e.startDTD(l,c,u),e.endDTD(),g.index+g[0].length}}return-1}function $o(r,t,e){var i=r.indexOf("?>",t);if(i){var n=r.substring(t,i).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);return n?(n[0].length,e.processingInstruction(n[1],n[2]),i+2):-1}return-1}function En(){this.attributeNames={}}En.prototype={setTagName:function(r){if(!vr.test(r))throw new Error("invalid tagName:"+r);this.tagName=r},addValue:function(r,t,e){if(!vr.test(r))throw new Error("invalid attribute:"+r);this.attributeNames[r]=this.length,this[this.length++]={qName:r,value:t,offset:e}},length:0,getLocalName:function(r){return this[r].localName},getLocator:function(r){return this[r].locator},getQName:function(r){return this[r].qName},getURI:function(r){return this[r].uri},getValue:function(r){return this[r].value}};function Wo(r,t){var e,i=[],n=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;for(n.lastIndex=t,n.exec(r);e=n.exec(r);)if(i.push(e),e[1])return i}Ii.XMLReader=wn;Ii.ParseError=qt;var Qo=Et,Go=Tt,wr=xn,Sn=Ii,qo=Go.DOMImplementation,Tr=Qo.NAMESPACE,Zo=Sn.ParseError,Ko=Sn.XMLReader;function An(r){return r.replace(/\r[\n\u0085]/g,`
`).replace(/[\r\u0085\u2028]/g,`
`)}function Nn(r){this.options=r||{locator:{}}}Nn.prototype.parseFromString=function(r,t){var e=this.options,i=new Ko,n=e.domBuilder||new ge,s=e.errorHandler,a=e.locator,o=e.xmlns||{},l=/\/x?html?$/.test(t),c=l?wr.HTML_ENTITIES:wr.XML_ENTITIES;a&&n.setDocumentLocator(a),i.errorHandler=Jo(s,n,a),i.domBuilder=e.domBuilder||n,l&&(o[""]=Tr.HTML),o.xml=o.xml||Tr.XML;var u=e.normalizeLineEndings||An;return r&&typeof r=="string"?i.parse(u(r),o,c):i.errorHandler.error("invalid doc source"),n.doc};function Jo(r,t,e){if(!r){if(t instanceof ge)return t;r=t}var i={},n=r instanceof Function;e=e||{};function s(a){var o=r[a];!o&&n&&(o=r.length==2?function(l){r(a,l)}:r),i[a]=o&&function(l){o("[xmldom "+a+"]	"+l+xi(e))}||function(){}}return s("warning"),s("error"),s("fatalError"),i}function ge(){this.cdata=!1}function Bt(r,t){t.lineNumber=r.lineNumber,t.columnNumber=r.columnNumber}ge.prototype={startDocument:function(){this.doc=new qo().createDocument(null,null,null),this.locator&&(this.doc.documentURI=this.locator.systemId)},startElement:function(r,t,e,i){var n=this.doc,s=n.createElementNS(r,e||t),a=i.length;Oe(this,s),this.currentElement=s,this.locator&&Bt(this.locator,s);for(var o=0;o<a;o++){var r=i.getURI(o),l=i.getValue(o),e=i.getQName(o),c=n.createAttributeNS(r,e);this.locator&&Bt(i.getLocator(o),c),c.value=c.nodeValue=l,s.setAttributeNode(c)}},endElement:function(r,t,e){var i=this.currentElement;i.tagName,this.currentElement=i.parentNode},startPrefixMapping:function(r,t){},endPrefixMapping:function(r){},processingInstruction:function(r,t){var e=this.doc.createProcessingInstruction(r,t);this.locator&&Bt(this.locator,e),Oe(this,e)},ignorableWhitespace:function(r,t,e){},characters:function(r,t,e){if(r=Er.apply(this,arguments),r){if(this.cdata)var i=this.doc.createCDATASection(r);else var i=this.doc.createTextNode(r);this.currentElement?this.currentElement.appendChild(i):/^\s*$/.test(r)&&this.doc.appendChild(i),this.locator&&Bt(this.locator,i)}},skippedEntity:function(r){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(r){(this.locator=r)&&(r.lineNumber=0)},comment:function(r,t,e){r=Er.apply(this,arguments);var i=this.doc.createComment(r);this.locator&&Bt(this.locator,i),Oe(this,i)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(r,t,e){var i=this.doc.implementation;if(i&&i.createDocumentType){var n=i.createDocumentType(r,t,e);this.locator&&Bt(this.locator,n),Oe(this,n),this.doc.doctype=n}},warning:function(r){console.warn("[xmldom warning]	"+r,xi(this.locator))},error:function(r){console.error("[xmldom error]	"+r,xi(this.locator))},fatalError:function(r){throw new Zo(r,this.locator)}};function xi(r){if(r)return`
@`+(r.systemId||"")+"#[line:"+r.lineNumber+",col:"+r.columnNumber+"]"}function Er(r,t,e){return typeof r=="string"?r.substr(t,e):r.length>=t+e||t?new java.lang.String(r,t,e)+"":r}"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,function(r){ge.prototype[r]=function(){return null}});function Oe(r,t){r.currentElement?r.currentElement.appendChild(t):r.doc.appendChild(t)}Ye.__DOMHandler=ge;Ye.normalizeLineEndings=An;Ye.DOMParser=Nn;var ta=Ye.DOMParser;async function ea(r){return new Promise(t=>{const i=new OffscreenCanvas(19,19).getContext("2d");Ht.fromString(i,r,{DOMParser:ta}).render({enableRedraw:!0}).then(()=>i.getImageData(0,0,19,19)).then(t)})}async function Cn(r){const[t,...e]=r,i=e.reduce((s,a)=>Re(a)>.8?s:Re(s)>.8?a:fi(s)>=fi(a)?s:a,t),n="M5 3 L15 3 C15 9 14 11 8 11 M8 10 C7 15 7 15 3 16";return`
    <svg width="19" height="19" viewBox="0 0 19 19" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path stroke-width="5" stroke="#${i}" stroke-linecap="round" stroke-linejoin="round" d="${n}"/>
      <path stroke-width="2" stroke="#ffffff" stroke-linecap="round" stroke-linejoin="round" d="${n}"/>
    </svg>
  `}function Mn(r){Cn(r).then(ea).then(t=>chrome.action.setIcon({imageData:t}))}function Sr({url:r,title:t,sessionId:e},i){return{url:r,title:t,lastVisitTime:i,id:e}}function ia({window:r,tab:t,lastModified:e}){const i=e*1e3+999.999;return t?{isSession:!0,...Sr(t,i)}:{id:r.sessionId,isSession:!0,sessionWindow:r.tabs.map(n=>Sr(n)),title:`${r.tabs.length} tabs - ${r.tabs.map(n=>n.title).join(", ")}`,lastVisitTime:i}}function ra([r,t]){const e=t.map(ia).concat(r).sort((n,s)=>s.lastVisitTime-n.lastVisitTime),i=[];for(let n=0,s="";n<e.length;n+=1){const{url:a,...o}=e[n],l={...o,url:a==null?void 0:a.substring(0,1024)},c=new Date(o.lastVisitTime).toLocaleDateString();s===c||!s?i.push(l):i.push({headerDate:!0,lastVisitTime:o.lastVisitTime},l),s=c}return i}function Ie(r=!0){return t=>{var n,s;if(t.url)return r&&t.parentId!=="1"?"":ss(t);const e=((n=t.children)==null?void 0:n.map(Ie(r)).join(""))??"",{length:i}=((s=t.children)==null?void 0:s.filter(kr("url",void 0)))??[];return os({...t,children:e,length:i})}}const Ar=(r=[])=>(t="")=>t.concat(r.join(""));function On(){chrome.bookmarks.getTree(([{children:r}])=>{var s;const t=(r==null?void 0:r.map(Ie(!1)).join(""))||"",e=(s=r==null?void 0:r.find(kr("id","1")))==null?void 0:s.children,i=Ir(Ar(e==null?void 0:e.map(Ie())),Ar(r==null?void 0:r.filter(Hn("id","1")).map(Ie())))();xt({htmlBookmarks:{leafs:t,folders:i}})})}const na=[chrome.bookmarks.onChanged,chrome.bookmarks.onCreated,chrome.bookmarks.onImportEnded,chrome.bookmarks.onMoved,chrome.bookmarks.onRemoved];ie(On)(na);async function ki(){const{options:r}=await Dt("options");if(r.windowMode)return xt({updatedHistory:Date.now()});const t=await Promise.all(Jn()).then(ra).then(i=>i.slice(0,45)),e=Ir(zn(as),i=>i.join(""),ns)(t);return xt({htmlHistory:e})}async function sa(r){if(r!=null&&r.startsWith(chrome.runtime.getURL("")))return chrome.history.deleteUrl({url:r})}let Nr;function Cr(){clearTimeout(Nr),Nr=setTimeout(ki,500)}let Mr;function oa({url:r}){sa(r),clearTimeout(Mr),Mr=setTimeout(ki,1500)}function aa(r){r.onDisconnect.addListener(()=>{rs(),chrome.runtime.sendMessage({type:Pr.tryChangePalette}).catch(()=>{})})}function la(r){var t;(t=r.window)!=null&&t.id&&chrome.windows.update(r.window.id,{focused:!0})}const ca=["settings","clientState","options","lastSearchWord"];async function ua(r){var l;const t=await fetch("./default.css").then(c=>c.text()),{html:e,palettes:i}=await Kn(),n={...Pn,...r.settings,theme:e,palettes:i},s=r.clientState||{},a=r.lastSearchWord||"",o={...kn,...r.options,css:((l=r.options)==null?void 0:l.css)??t};Mn(o.colorPalette),On(),ki(),xt({settings:n,clientState:s,options:o,lastSearchWord:a}).then(()=>{_r(o)}),ie(oa)([chrome.history.onVisited]),ie(Cr)([chrome.history.onVisitRemoved]),ie(Cr)([chrome.sessions.onChanged]),ie(aa)([chrome.runtime.onConnect])}Dt(...ca).then(ua);chrome.action.onClicked.addListener(async r=>{const{settings:t,options:e}=await Dt("settings","options");if(!e.windowMode)return;const i=await Vr();if(i){chrome.windows.update(i.windowId,{focused:!0});return}const n=Rr(e.colorPalette),s=encodeURIComponent(`:root {
${n}
}

${e.css}`);chrome.windows.create({url:`popup.html?css=${s}`,type:"popup",...t.windowSize}).then(a=>{xt({windowModeInfo:{popupWindowId:a.id,currentWindowId:r.windowId}})})});let Or;const ha={[rt.initialize]:({payload:r})=>Promise.resolve(r),[rt.getWindowModeInfo]:async()=>{const{windowModeInfo:r}=await Dt("windowModeInfo");return xt({windowModeInfo:{...r,currentWindowId:chrome.windows.WINDOW_ID_NONE}}),r},[rt.restoreSession]:({payload:r})=>chrome.sessions.restore(r).then(la),[rt.getSvgBrowserFavicon]:({payload:r})=>Cn(r),[rt.updateWindow]:({payload:r})=>{const{windowId:t,updateInfo:e}=r;return t===chrome.windows.WINDOW_ID_NONE?Promise.reject():e.focused?(clearTimeout(Or),Or=setTimeout(()=>chrome.windows.update(t,e),100),Promise.resolve()):chrome.windows.get(t).then(i=>{i&&chrome.windows.update(i.id,e)})},[rt.setThemeColor]:({payload:r})=>(Mn(r),Dt("options").then(({options:t})=>{const{css:e,windowMode:i}=t;return _r({css:e,colorPalette:r,windowMode:i}),xt({options:{...t,colorPalette:r}})})),[rt.moveWindow]:({payload:{sourceWindowId:r,windowId:t,index:e,focused:i}})=>chrome.windows.get(r,{populate:!0}).then(({tabs:n})=>{const s=n.map(a=>a.id);return chrome.tabs.move(s,{windowId:t,index:e})}).then(()=>{i&&chrome.windows.update(t,{focused:i})}).catch(n=>n.message),[rt.moveWindowNew]:({payload:r})=>chrome.windows.update(r.windowId,{state:"normal"}).then(()=>chrome.windows.get(r.windowId,{populate:!0}).then(({tabs:t,incognito:e,left:i,top:n,width:s,height:a})=>{const o=t.findIndex(c=>c.active),[l]=t.splice(o,1);return chrome.windows.create({tabId:l.id,incognito:e,left:i,top:n,width:s,height:a}).then(c=>{const u=t.map(g=>chrome.tabs.move(g.id,{windowId:c.id,index:g.index}));return Promise.all(u).then(()=>{})}).catch(c=>c.message)})),[rt.moveTabsNewWindow]:async({payload:r})=>{const[t,...e]=r,i=e.every(c=>c.incognito===t.incognito),n=i?t.incognito:!1,s=await chrome.windows.create({tabId:t.tabId,incognito:n,focused:i}),[a,o]=e.reduce(([c,u],g)=>g.incognito===t.incognito?[[...c,g.tabId],u]:[c,[...u,g.tabId]],[[],[]]),l=[...a,...o];return chrome.tabs.move(l,{windowId:s.id,index:-1}).then(()=>({windowId:s.id})).catch(c=>({windowId:chrome.windows.WINDOW_ID_NONE,message:c.message}))},[rt.openUrls]:({payload:{urls:r,windowId:t,index:e}})=>{const i=r.reverse().map(n=>chrome.tabs.create({windowId:t,url:n,index:e,active:!0}));return Promise.all(i).then(()=>chrome.windows.update(t,{focused:!0}))},[rt.moveTabs]:({payload:{sourceTabs:r,windowId:t,incognito:e,index:i}})=>chrome.windows.get(t,{populate:!0}).then(async({tabs:n})=>{const s=n.slice(i).concat(r).filter(Bn("pinned"));if(s.length>0){const a=s==null?void 0:s.map(o=>chrome.tabs.update(o.id,{pinned:!1}));return Promise.all(a).then(()=>n)}return n}).then(async n=>{const s=r.map(c=>c.id),[a,o]=[n.slice(0,i),n.slice(i)].map(c=>c.map(u=>u.id).filter(u=>!s.includes(u))),l=a.concat(s,o);return chrome.tabs.move(l,{windowId:t,index:0}).then(()=>r).catch(c=>c.message)}).then(n=>typeof n=="string"?n:n.some(s=>s.active&&s.isCurrentWindow&&s.windowId!==t&&s.incognito===e?(chrome.tabs.update(s.id,{active:!0}),chrome.windows.update(t,{focused:!0}),!0):!1))};Qn(ha);chrome.storage.local.remove("histories");
