const S={histories:100,tabs:325,leafs:200,folders:150},re={postPage:!1,height:500,windowSize:{width:800,height:600,top:void 0,left:void 0},paneWidth:{pane1:S.leafs,pane2:S.tabs,pane3:S.histories},paneLayouts:[],paneLayoutsWindowMode:[],bodyColor:"#222222",tabs:!0,history:!0,historyMax:{rows:30,days:null},includeUrl:!1,theme:{light:"",dark:"",other:""},palettes:{light:[],dark:[],other:[]}},se=["FEFFFE","BFD7EA","0B3954","E0FF4F","FF6663"],ie=["histories","tabs","bookmarks"],ae={panes:ie,bookmarksPanes:["leafs","folders"],newTabPosition:"rs",showCloseTab:!0,showSwitchTabsWin:!1,showDeleteHistory:!0,findTabsFirst:!0,enableExternalUrl:!1,externalUrl:"",findTabsMatches:"domain",css:"",editorTheme:"vs-dark",colorPalette:se,zoomTabs:!1,zoomHistory:!0,zoomRatio:"0.7",fontSize:"0.9em",collapseTabs:!0,exclusiveOpenBmFolderTree:!0,bmAutoFindTabs:!0,bmAutoFindTabsDelay:"500",restoreSearching:!0,favColorPalettes:[],showMinimizeAll:!0,windowMode:!0},g={initialize:"cl-initialize",moveWindow:"cl-move-window",moveWindowNew:"cl-move-window-new",moveTabs:"cl-move-tabs",moveTabsNewWindow:"cl-move-tabs-new-window",openUrls:"cl-open-urls",setThemeColor:"cl-set-theme-color",getWindowModeInfo:"cl-get-window-mode-info",restoreSession:"cl-restore-session",updateWindow:"cl-update-window",getSvgBrowserFavicon:"cl-get-svg-favicon"},V={applyOptions:"bkg-apply-options",applyStyle:"bkg-apply-style",tryChangePalette:"bkg-try-change-palette",terminateWindowMode:"bkg-terminate-window-mode"};function j(e,t){const[n,o,r]=T(e.color),[s,i,a]=T(t.color);return Math.abs(s-n)+Math.abs(i-o)+Math.abs(a-r)}function w([e,t,n,o,r]){return[e,t,n,r,o]}function y([e,t,n,o,r]){return[e,t,o,n,r]}function ce([e,t,n,o,r]){const s=n.chroma*(1-n.whiteness),i=o.chroma*(1-o.whiteness),a=r.chroma*(1-r.whiteness);return s<i&&a<i?[e,t,n,r,o]:i<s&&a<s?[e,t,o,r,n]:[e,t,n,o,r]}function le([e,t,n,o,r]){const s=n.chroma*(1-n.whiteness),i=o.chroma*(1-o.whiteness);return s<i?[e,t,o,n,r]:[e,t,n,o,r]}function de([e,t,n,o,r]){const s=n.chroma*(3-n.whiteness),i=o.chroma*(3-o.whiteness),a=r.chroma*(3-r.whiteness);return s<i&&a<i?[e,t,n,r,o]:i<s&&a<s?[e,t,o,r,n]:[e,t,n,o,r]}function ue([e,t,n,o,r]){const s=n.chroma*n.whiteness,i=o.chroma*o.whiteness;return s<i?[e,t,o,n,r]:[e,t,n,o,r]}function L(e){return e.map(t=>`<div>${t.map(o=>{const r=o.whiteness>f;return`<div data-color="${o.color}" style="background-color: #${o.color}; color: ${r?"black":"white"}"></div>`}).join("")}</div>`).join("")}function z(e){return e.map(t=>({color:t,whiteness:_(t),chroma:Ie(t)})).map(t=>({...t,vivid:t.chroma*(t.whiteness*.1)}))}function Y(e,t){return e.filter(([n,o,r])=>j(n,r)>t&&j(o,r)>t).filter(([n,o,,,r])=>j(n,r)>t&&j(o,r)>t).filter(([n,o],r,s)=>!s.slice(0,r).find(([i,a])=>A({p:n,f:o},{p:i,f:a},!0)))}function $(e,t){const n=e.map(ce).map(le).concat(e.map(y).map(w)).concat(e).concat(e.map(w)).concat(e.map(w).map(y).map(w)).concat(e.map(w).map(y)).concat(e.map(y)).flatMap(([o,r],s,i)=>i.filter(([a,d])=>o.color===a.color&&r.color===d.color));return Y(n,t)}function me(e,t){const n=e.map(de).map(ue).concat(e.map(y).map(w)).concat(e).concat(e.map(w)).concat(e.map(y)).concat(e.map(w).map(y)).concat(e.map(w).map(y).map(w)).flatMap(([o,r],s,i)=>i.filter(([a,d])=>o.color===a.color&&r.color===d.color));return Y(n,t)}function he(e){return t=>t.map(e)}const W=Object.prototype.toString.call.bind(Object.prototype.toString),O=Object.prototype.hasOwnProperty.call.bind(Object.prototype.hasOwnProperty);function A(e,t,n=!1){if(Object.is(e,t))return!0;const o=W(e);if(o!==W(t))return!1;if(o==="[object Array]"){if(e.length!==t.length)return!1;if(n){for(let r=0;r<e.length;r+=1)if(!A(e[r],t[r],!0))return!1}else for(let r=0;r<e.length;r+=1)if(Object.is(e[r],t[r]))return!1;return!0}if(o==="[object Object]"){const r=Object.keys(e),s=Object.keys(t);if(r.length!==s.length)return!1;if(n){for(let i=0;i<r.length;i+=1)if(!O(t,r[i])||!A(e[r[i]],t[r[i]],!0))return!1}else for(let i=0;i<r.length;i+=1)if(!O(t,r[i])||!Object.is(e[r[i]],t[r[i]]))return!1;return!0}return!1}function Z(e,...t){return(...n)=>t.reduce((o,r)=>r(o),e(...n))}async function fe(e){return chrome.runtime.sendMessage(e).catch(console.error)}function pe(e){return t=>t[e]}function G(e,t){return n=>n[e]===t}function ge(e,t){return n=>n[e]!==t}function we(e){return encodeURIComponent(e).replace(/[()']/g,t=>`\\${t}`)}const ye=chrome.runtime.getURL("_favicon/?pageUrl="),Me="PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1MTIgNTEyIj48IS0tISBGb250IEF3ZXNvbWUgUHJvIDYuMi4wIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlIChDb21tZXJjaWFsIExpY2Vuc2UpIENvcHlyaWdodCAyMDIyIEZvbnRpY29ucywgSW5jLiAtLT48cGF0aCBmaWxsPSIjNDA0NDQ3IiBkPSJNMCAyNTZDMCAyMDkuNCAxMi40NyAxNjUuNiAzNC4yNyAxMjcuMUwxNDQuMSAzMTguM0MxNjYgMzU3LjUgMjA3LjkgMzg0IDI1NiAzODRDMjcwLjMgMzg0IDI4My4xIDM4MS43IDI5Ni44IDM3Ny40TDIyMC41IDUwOS42Qzk1LjkgNDkyLjMgMCAzODUuMyAwIDI1NnpNMzY1LjEgMzIxLjZDMzc3LjQgMzAyLjQgMzg0IDI3OS4xIDM4NCAyNTZDMzg0IDIxNy44IDM2Ny4yIDE4My41IDM0MC43IDE2MEg0OTMuNEM1MDUuNCAxODkuNiA1MTIgMjIyLjEgNTEyIDI1NkM1MTIgMzk3LjQgMzk3LjQgNTExLjEgMjU2IDUxMkwzNjUuMSAzMjEuNnpNNDc3LjggMTI4SDI1NkMxOTMuMSAxMjggMTQyLjMgMTcyLjEgMTMwLjUgMjMwLjdMNTQuMTkgOTguNDdDMTAxIDM4LjUzIDE3NCAwIDI1NiAwQzM1MC44IDAgNDMzLjUgNTEuNDggNDc3LjggMTI4VjEyOHpNMTY4IDI1NkMxNjggMjA3LjQgMjA3LjQgMTY4IDI1NiAxNjhDMzA0LjYgMTY4IDM0NCAyMDcuNCAzNDQgMjU2QzM0NCAzMDQuNiAzMDQuNiAzNDQgMjU2IDM0NEMyMDcuNCAzNDQgMTY4IDMwNC42IDE2OCAyNTZ6Ii8+PC9zdmc+";function E(e){if(e==="chrome://newtab/")return`background-image: url(data:image/svg+xml;base64,${Me}); background-size: 15px;`;const t=!e||e.startsWith("data")?"none":we(e);return`background-image: url(${ye}${t});`}function N(e){return t=>t.forEach(n=>n.addListener(e))}async function M(e){return new Promise(t=>{chrome.storage.local.set(e,()=>{chrome.runtime.lastError&&console.log(chrome.runtime.lastError.message),t(e)})})}async function ve(e,...t){return new Promise(n=>{e.get(t,o=>n(o))})}function v(...e){return ve(chrome.storage.local,...e)}function be(...e){return new Promise(t=>{const n=new FileReader;n.onload=()=>{const[,o]=n.result.split(",");t(o)},n.readAsDataURL(new Blob(e))})}function T(e){return[e.substring(0,2),e.substring(2,4),e.substring(4,6)].map(t=>parseInt(t,16))}function Ie(e){const[t,n,o]=T(e),r=Math.max(t,n,o),s=Math.min(t,n,o);return(r-s)/255}const f=.6;function _(e){const[t,n,o]=T(e);return Math.max((t||1)*(n||1)*(o||1)/(255*255*255),n*o/(255*255),t*o/(255*255),t*n/(255*255))}const k=new Map;k.set("&","&amp;");k.set('"',"&quot;");k.set("<","&lt;");k.set(">","&gt;");function b(e){return e.replace(/[&"<>]/g,t=>k.get(t))}function De(e){return e==null?new Date().toLocaleDateString():e<1e3?"Undated":new Date(e).toLocaleDateString()}function Ce(e,t=!1){function n(o,r,s){const i=e[o==null?void 0:o.type];if(typeof i=="function"){const a=i(o),d=a instanceof Promise;return d&&a.then(c=>s(c)),t&&chrome.runtime.onMessage.removeListener(n),d}return!0}chrome.runtime.onMessage.addListener(n)}function Ne(e){return e.split("").map(t=>[t,t.toLowerCase()]).map(([t,n])=>t===n?t:`-${n}`).join("")}function ke(e){const t="#efefef",n="#222222";return e.map(o=>[`#${o}`,_(o)]).map(([o,r])=>[o,r>f]).map(([o,r])=>[o,r?n:t,r])}function q(e){const[[t,n],[o,r],[s,i],[a,d],[c,m]]=ke(e);return Object.entries({paneBg:t,paneColor:n,frameBg:o,frameColor:r,itemHoverBg:s,itemHoverColor:i,searchingBg:a,searchingColor:d,keyBg:c,keyColor:m}).map(([p,l])=>`    --${Ne(p)}: ${l};`).join(`
`)}async function X(){const e=chrome.runtime.getURL("popup.html*"),[t]=await chrome.tabs.query({url:e});return t}function je(e,t,n){const o=q(t),r=`body { height: ${e.height}px; }`;return`:root {
${o}
}

${r}

${n}`}function J({css:e,colorPalette:t,windowMode:n}){if(n){chrome.action.setPopup({popup:""});return}v("settings").then(({settings:o})=>{const r=encodeURIComponent(je(o,t,e));chrome.action.setPopup({popup:`popup.html?css=${r}`}),X().then(s=>{s&&fe({type:V.terminateWindowMode})})})}async function xe(){const t=(await fetch("./color-palette1.json").then(l=>l.json())).map(z).map(l=>[...l].sort((u,h)=>u.vivid-h.vivid)).map(([l,u,h,I,D])=>[l,u,h,I].sort((oe,ne)=>oe.chroma-ne.chroma).concat(D)).map(([l,u,h,I,D])=>u.whiteness<=f?h.whiteness>f?[l,h,u,I,D]:[l,I,u,h,D]:[l,u,h,I,D]),n=t.filter(([l,u])=>l.whiteness<=f&&u.whiteness>f||l.whiteness>f&&u.whiteness<=f),o=$(n,100),r=L(o),s=t.filter(([l,u])=>l.whiteness<=f&&u.whiteness<=f),i=t.concat([...s,...n].map(l=>l.concat().sort((u,h)=>h.whiteness-u.whiteness))).filter(([l])=>l.whiteness>f).filter(([,l])=>l.whiteness>f),a=[...n,...i].map(l=>l.concat().sort((u,h)=>u.whiteness-h.whiteness)).filter(([l,u])=>l.whiteness<=f&&u.whiteness<=f).concat(s),d=me(a,100),c=L(d),m=[z(["FFFFFF","E8E8E9","CCE5FF","F6F6F6","1DA1F2"]),...$(i,80)];return{html:{light:L(m),dark:c,other:r},palettes:{light:m,dark:d,other:o}}}function Te(e=99999){const t=Date.now()-31536e6,n=chrome.history.search({text:"",startTime:t,maxResults:e}),o=chrome.sessions.getRecentlyClosed();return[n,o]}const Se=new Intl.DateTimeFormat([],{timeStyle:"short"});function Le(e){return Se.format(e)}function Ae(e){try{return decodeURIComponent((e||"").substring(0,1024))}catch{return(e||"").substring(0,1024)}}function Ee(){v("lastSearchWord","queries").then(({lastSearchWord:e,...t})=>{if(!e)return;const n=[e,...(t.queries||[]).filter(o=>o.localeCompare(e,void 0,{sensitivity:"accent"})!==0).slice(0,200)];M({queries:n})})}function Ue(e){return`<history-item class="current-date history header-date" style="transform: translateY(-10000px)"></history-item>${e}`}function ze({title:e,url:t,id:n},o=!1){const r=E(t),s=Ae(t);return`
    <bm-leaf class="leaf${o?" search-path":""}" id="${n}" draggable="true" style="${r}">
      <div class="anchor" title="${b(e)}
${b(s)}">${b(e)}</div><button class="leaf-menu-button"><i class="icon-fa-ellipsis-v"></i></button>
      <div class="drop-top"></div><div class="drop-bottom"></div>
    </bm-leaf>
  `}function $e({id:e,title:t,children:n,length:o}){return`
    <div is="bm-folder" class="folder" id="${e}" data-children="${o}">
      <div class="marker" draggable="true" title="${b(t)}">
        <div class="drop-folder"></div><i class="icon-fa-angle-right"></i><div class="title" tabindex="2"><div>${b(t)}</div></div><div class="button-wrapper"><button class="folder-menu-button"><i class="icon-fa-ellipsis-v"></i></button></div><div class="drop-top"></div><div class="drop-bottom"></div>
      </div>
      ${n}
    </div>
  `}function We({url:e,title:t,lastVisitTime:n,headerDate:o,id:r,isSession:s,sessionWindow:i,headerStyle:a=""}){if(o){const h=De(n);return`<history-item class="history header-date" draggable="true" style="${a}">${h}</history-item>`}const{elementId:d,addClassName:c,style:m}=s?{elementId:`session-${r}`,addClassName:i?" session-window":" session-tab",style:i?"":E(e)}:{elementId:`hst-${r}`,addClassName:"",style:E(e)},p=t||e,l=new Date(n),u=Le(l);return`
    <history-item class="history${c}" draggable="true" id="${d}" style="${m}">
      <i class="icon-fa-angle-right"></i>
      <div class="history-title">${b(p)}</div><div class="time">${u}</div><i class="icon-x"></i>
    </history-item>
  `}let C;async function Oe(e){const t=chrome.runtime.getURL(e);(await chrome.runtime.getContexts({contextTypes:[chrome.runtime.ContextType.OFFSCREEN_DOCUMENT],documentUrls:[t]})).length>0||(C?await C:(C=chrome.offscreen.createDocument({url:e,reasons:[chrome.offscreen.Reason.DOM_PARSER],justification:"reason for needing the document"}),await C,C=void 0))}async function Fe(e){const t=await be(e);return new Promise(n=>{const o=new Image;o.onload=()=>{const s=new OffscreenCanvas(o.width,o.height).getContext("2d");s.drawImage(o,0,0);const i=s.getImageData(0,0,o.width,o.width);n(i)},o.setAttribute("src",`data:image/svg+xml;base64,${t}`)})}async function Pe(e){if(typeof Image>"u"){await Oe("offscreen.html");const t=await chrome.runtime.sendMessage({type:"getImageData",svg:e}),n=Uint8ClampedArray.from(Object.values(t.data));return new ImageData(n,t.width)}return Fe(e)}async function K(e){const[,,,,t]=e;return`
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" width="32" height="32" stroke-width="0" fill="whitesmoke">
        <defs>
          <filter id="shadow">
            <feOffset dx="0" dy="-80"></feOffset>
            <feGaussianBlur stdDeviation="30" result="offset-blur"></feGaussianBlur>
            <feComposite operator="out" in="SourceGraphic" in2="offset-blur" result="inverse"></feComposite>
            <feFlood flood-color="#000000" flood-opacity=".4" result="color"></feFlood>
            <feComposite operator="in" in="color" in2="inverse" result="shadow"></feComposite>
            <feComposite operator="over" in="shadow" in2="SourceGraphic"></feComposite>
          </filter>
        </defs>
      <rect x="0" y="0" width="144" height="144" rx="30" style="filter:url(#shadow)"></rect><rect x="184" y="0" width="144" height="144" rx="30" style="filter:url(#shadow)"></rect><rect x="368" y="0" width="144" height="144" rx="30" style="filter:url(#shadow)" fill="#${t}"></rect><rect x="0" y="184" width="144" height="144" rx="30" style="filter:url(#shadow)"></rect><rect x="184" y="184" width="144" height="144" rx="30" style="filter:url(#shadow)"></rect><rect x="368" y="184" width="144" height="144" rx="30" style="filter:url(#shadow)"></rect><rect x="0" y="368" width="144" height="144" rx="30" style="filter:url(#shadow)"></rect><rect x="184" y="368" width="144" height="144" rx="30" style="filter:url(#shadow)"></rect><rect x="368" y="368" width="144" height="144" rx="30" style="filter:url(#shadow)"></rect>
    </svg>`}function ee(e){K(e).then(Pe).then(t=>chrome.action.setIcon({imageData:t}))}function F({url:e,title:t,sessionId:n},o){return{url:e,title:t,lastVisitTime:o,id:n}}function He({window:e,tab:t,lastModified:n}){const o=n*1e3+999.999;return t?{isSession:!0,...F(t,o)}:{id:e.sessionId,isSession:!0,sessionWindow:e.tabs.map(r=>F(r)),title:`${e.tabs.length} tabs - ${e.tabs.map(r=>r.title).join(", ")}`,lastVisitTime:o}}function Be([e,t]){const n=t.map(He).concat(e).sort((r,s)=>s.lastVisitTime-r.lastVisitTime),o=[];for(let r=0,s="";r<n.length;r+=1){const{url:i,...a}=n[r],d={...a,url:i==null?void 0:i.substring(0,1024)},c=new Date(a.lastVisitTime).toLocaleDateString();s===c||!s?o.push(d):o.push({headerDate:!0,lastVisitTime:a.lastVisitTime},d),s=c}return o}function x(e=!0){return t=>{var r,s;if(t.url)return e&&t.parentId!=="1"?"":ze(t);const n=((r=t.children)==null?void 0:r.map(x(e)).join(""))??"",{length:o}=((s=t.children)==null?void 0:s.filter(G("url",void 0)))??[];return $e({...t,children:n,length:o})}}const P=(e=[])=>(t="")=>t.concat(e.join(""));function te(){chrome.bookmarks.getTree(([{children:e}])=>{var s;const t=(e==null?void 0:e.map(x(!1)).join(""))||"",n=(s=e==null?void 0:e.find(G("id","1")))==null?void 0:s.children,o=Z(P(n==null?void 0:n.map(x())),P(e==null?void 0:e.filter(ge("id","1")).map(x())))();M({htmlBookmarks:{leafs:t,folders:o}})})}const Re=[chrome.bookmarks.onChanged,chrome.bookmarks.onCreated,chrome.bookmarks.onImportEnded,chrome.bookmarks.onMoved,chrome.bookmarks.onRemoved];N(te)(Re);async function U(){const{options:e}=await v("options");if(e.windowMode)return M({updatedHistory:Date.now()});const t=await Promise.all(Te()).then(Be).then(o=>o.slice(0,50)),n=Z(he(We),o=>o.join(""),Ue)(t);return M({htmlHistory:n})}async function Qe(e){if(e!=null&&e.startsWith(chrome.runtime.getURL("")))return chrome.history.deleteUrl({url:e})}let H;function B(){clearTimeout(H),H=setTimeout(U,500)}let R;function Ve({url:e}){Qe(e),clearTimeout(R),R=setTimeout(U,1500)}function Ye(e){e.onDisconnect.addListener(()=>{Ee(),chrome.runtime.sendMessage({type:V.tryChangePalette}).catch(()=>{})})}function Ze(e){var t;(t=e.window)!=null&&t.id&&chrome.windows.update(e.window.id,{focused:!0})}const Ge=["settings","clientState","options","lastSearchWord"];async function _e(e){var d;const t=await fetch("./default.css").then(c=>c.text()),{html:n,palettes:o}=await xe(),r={...re,...e.settings,theme:n,palettes:o},s=e.clientState||{},i=e.lastSearchWord||"",a={...ae,...e.options,css:((d=e.options)==null?void 0:d.css)??t};ee(a.colorPalette),te(),await M({settings:r,clientState:s,options:a,lastSearchWord:i}).then(()=>{J(a)}),U(),N(Ve)([chrome.history.onVisited]),N(B)([chrome.history.onVisitRemoved]),N(B)([chrome.sessions.onChanged]),N(Ye)([chrome.runtime.onConnect])}v(...Ge).then(_e);chrome.action.onClicked.addListener(async e=>{const{settings:t,options:n}=await v("settings","options");if(!n.windowMode)return;const o=await X();if(o){chrome.windows.update(o.windowId,{focused:!0});return}const r=q(n.colorPalette),s=encodeURIComponent(`:root {
${r}
}

${n.css}`);chrome.windows.create({url:`popup.html?css=${s}`,type:"popup",...t.windowSize}).then(i=>{M({windowModeInfo:{popupWindowId:i.id,currentWindowId:e.windowId}})})});let Q;const qe={[g.initialize]:({payload:e})=>Promise.resolve(e),[g.getWindowModeInfo]:async()=>{const{windowModeInfo:e}=await v("windowModeInfo");return M({windowModeInfo:{...e,currentWindowId:chrome.windows.WINDOW_ID_NONE}}),e},[g.restoreSession]:({payload:e})=>chrome.sessions.restore(e).then(Ze),[g.getSvgBrowserFavicon]:({payload:e})=>K(e),[g.updateWindow]:({payload:e})=>{const{windowId:t,updateInfo:n}=e;return t===chrome.windows.WINDOW_ID_NONE?Promise.reject():n.focused?(clearTimeout(Q),Q=setTimeout(()=>chrome.windows.update(t,n),100),Promise.resolve()):chrome.windows.get(t).then(o=>{o&&chrome.windows.update(o.id,n)})},[g.setThemeColor]:({payload:e})=>(ee(e),v("options").then(({options:t})=>{const{css:n,windowMode:o}=t;return J({css:n,colorPalette:e,windowMode:o}),M({options:{...t,colorPalette:e}})})),[g.moveWindow]:({payload:{sourceWindowId:e,windowId:t,index:n,focused:o}})=>chrome.windows.get(e,{populate:!0}).then(({tabs:r})=>{const s=r.map(i=>i.id);return chrome.tabs.move(s,{windowId:t,index:n})}).then(()=>{o&&chrome.windows.update(t,{focused:o})}).catch(r=>r.message),[g.moveWindowNew]:({payload:e})=>chrome.windows.update(e.windowId,{state:"normal"}).then(()=>chrome.windows.get(e.windowId,{populate:!0}).then(({tabs:t,incognito:n,left:o,top:r,width:s,height:i})=>{const a=t.findIndex(c=>c.active),[d]=t.splice(a,1);return chrome.windows.create({tabId:d.id,incognito:n,left:o,top:r,width:s,height:i}).then(c=>{const m=t.map(p=>chrome.tabs.move(p.id,{windowId:c.id,index:p.index}));return Promise.all(m).then(()=>{})}).catch(c=>c.message)})),[g.moveTabsNewWindow]:async({payload:e})=>{const[t,...n]=e,o=n.every(c=>c.incognito===t.incognito),r=o?t.incognito:!1,s=await chrome.windows.create({tabId:t.tabId,incognito:r,focused:o}),[i,a]=n.reduce(([c,m],p)=>p.incognito===t.incognito?[[...c,p.tabId],m]:[c,[...m,p.tabId]],[[],[]]),d=[...i,...a];return chrome.tabs.move(d,{windowId:s.id,index:-1}).then(()=>({windowId:s.id})).catch(c=>({windowId:chrome.windows.WINDOW_ID_NONE,message:c.message}))},[g.openUrls]:({payload:{urls:e,windowId:t,index:n}})=>{const o=e.reverse().map(r=>chrome.tabs.create({windowId:t,url:r,index:n,active:!0}));return Promise.all(o).then(()=>chrome.windows.update(t,{focused:!0}))},[g.moveTabs]:({payload:{sourceTabs:e,windowId:t,incognito:n,index:o}})=>chrome.windows.get(t,{populate:!0}).then(async({tabs:r})=>{const s=r.slice(o).concat(e).filter(pe("pinned"));if(s.length>0){const i=s==null?void 0:s.map(a=>chrome.tabs.update(a.id,{pinned:!1}));return Promise.all(i).then(()=>r)}return r}).then(async r=>{const s=e.map(c=>c.id),[i,a]=[r.slice(0,o),r.slice(o)].map(c=>c.map(m=>m.id).filter(m=>!s.includes(m))),d=i.concat(s,a);return chrome.tabs.move(d,{windowId:t,index:0}).then(()=>e).catch(c=>c.message)}).then(r=>typeof r=="string"?r:r.some(s=>s.active&&s.isCurrentWindow&&s.windowId!==t&&s.incognito===n?(chrome.tabs.update(s.id,{active:!0}),chrome.windows.update(t,{focused:!0}),!0):!1))};Ce(qe);
